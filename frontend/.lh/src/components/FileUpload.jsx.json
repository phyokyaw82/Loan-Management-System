{
    "sourceFile": "src/components/FileUpload.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 11,
            "patches": [
                {
                    "date": 1770572681811,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1770573109572,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,81 +1,61 @@\n-import { useEffect, useState } from \"react\";\r\n-import { Link } from \"react-router-dom\";\r\n-import { getContracts, deleteContract } from \"../../api/contractApi\";\r\n+import { useState } from \"react\";\r\n \r\n-const ContractList = () => {\r\n-    const [contracts, setContracts] = useState([]);\r\n+const FileUpload = ({ onFileSelect, existingFileUrl }) => {\r\n+    const [selectedFile, setSelectedFile] = useState(null);\r\n \r\n-    const fetchContracts = async () => {\r\n-        const data = await getContracts();\r\n-        setContracts(data);\r\n+    const handleChange = (e) => {\r\n+        const file = e.target.files[0];\r\n+        setSelectedFile(file);\r\n+        if (onFileSelect) onFileSelect(file);\r\n     };\r\n \r\n-    const handleDelete = async (id) => {\r\n-        if (!window.confirm(\"Are you sure you want to delete this contract?\")) return;\r\n-        await deleteContract(id);\r\n-        fetchContracts();\r\n+    const handleRemove = () => {\r\n+        setSelectedFile(null);\r\n+        if (onFileSelect) onFileSelect(null);\r\n     };\r\n \r\n-    useEffect(() => {\r\n-        fetchContracts();\r\n-    }, []);\r\n-\r\n     return (\r\n-        <div>\r\n-            <h1 className=\"text-2xl font-bold mb-4\">Contracts</h1>\r\n-            <Link\r\n-                to=\"/contracts/new\"\r\n-                className=\"bg-gray-500 text-white px-4 py-2 rounded mb-4 inline-block\"\r\n-            >\r\n-                Add Contract\r\n-            </Link>\r\n+        <div className=\"flex flex-col space-y-2\">\r\n+            {existingFileUrl && !selectedFile ? (\r\n+                <div className=\"flex items-center space-x-4\">\r\n+                    <a\r\n+                        href={`http://localhost:5000/${existingFileUrl.replace(\"\\\\\", \"/\")}`}\r\n+                        target=\"_blank\"\r\n+                        rel=\"noopener noreferrer\"\r\n+                        className=\"text-blue-500 underline\"\r\n+                    >\r\n+                        View Current File\r\n+                    </a>\r\n+                    <button\r\n+                        type=\"button\"\r\n+                        onClick={handleRemove}\r\n+                        className=\"text-red-500 px-2 py-1 border rounded\"\r\n+                    >\r\n+                        Remove\r\n+                    </button>\r\n+                </div>\r\n+            ) : (\r\n+                <input\r\n+                    type=\"file\"\r\n+                    onChange={handleChange}\r\n+                    className=\"border p-2 rounded\"\r\n+                />\r\n+            )}\r\n \r\n-            <table className=\"min-w-full bg-white border\">\r\n-                <thead>\r\n-                    <tr>\r\n-                        <th className=\"py-2 px-4 border\">Borrower-Loan</th>\r\n-                        <th className=\"py-2 px-4 border\">Signing Date</th>\r\n-                        <th className=\"py-2 px-4 border\">Document</th>\r\n-                        <th className=\"py-2 px-4 border\">Actions</th>\r\n-                    </tr>\r\n-                </thead>\r\n-                <tbody>\r\n-                    {contracts.map((c) => (\r\n-                        <tr key={c._id}>\r\n-                            <td className=\"py-2 px-4 border\">\r\n-                                {c.loan?.borrower?.fullName}-{c.loan?.amount}\r\n-                            </td>\r\n-                            <td className=\"py-2 px-4 border\">\r\n-                                {new Date(c.signingDate).toLocaleDateString()}\r\n-                            </td>\r\n-                            <td className=\"py-2 px-4 border\">\r\n-                                {c.documentUrl ? (\r\n-                                    <a\r\n-                                        href={`http://localhost:5000/${c.documentUrl.replace(\"\\\\\", \"/\")}`}\r\n-                                        target=\"_blank\"\r\n-                                        rel=\"noopener noreferrer\"\r\n-                                        className=\"text-blue-500 underline\"\r\n-                                    >\r\n-                                        Download\r\n-                                    </a>\r\n-                                ) : (\r\n-                                    \"No file\"\r\n-                                )}\r\n-                            </td>\r\n-                            <td className=\"py-2 px-4 border\">\r\n-                                <Link to={`/contracts/edit/${c._id}`} className=\"text-blue-500 mr-2\">\r\n-                                    Edit\r\n-                                </Link>\r\n-                                <button onClick={() => handleDelete(c._id)} className=\"text-red-500\">\r\n-                                    Delete\r\n-                                </button>\r\n-                            </td>\r\n-                        </tr>\r\n-                    ))}\r\n-                </tbody>\r\n-            </table>\r\n+            {selectedFile && (\r\n+                <div className=\"flex items-center space-x-4\">\r\n+                    <span>{selectedFile.name}</span>\r\n+                    <button\r\n+                        type=\"button\"\r\n+                        onClick={handleRemove}\r\n+                        className=\"text-red-500 px-2 py-1 border rounded\"\r\n+                    >\r\n+                        Remove\r\n+                    </button>\r\n+                </div>\r\n+            )}\r\n         </div>\r\n     );\r\n };\r\n \r\n-export default ContractList;\r\n+export default FileUpload;\r\n"
                },
                {
                    "date": 1770573495235,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,58 +1,68 @@\n-import { useState } from \"react\";\r\n+import { useState, useEffect } from \"react\";\r\n \r\n const FileUpload = ({ onFileSelect, existingFileUrl }) => {\r\n-    const [selectedFile, setSelectedFile] = useState(null);\r\n+    const [file, setFile] = useState(null);\r\n+    const [showInput, setShowInput] = useState(true);\r\n+    const [fileUrl, setFileUrl] = useState(\"\");\r\n \r\n-    const handleChange = (e) => {\r\n-        const file = e.target.files[0];\r\n-        setSelectedFile(file);\r\n-        if (onFileSelect) onFileSelect(file);\r\n+    useEffect(() => {\r\n+        if (existingFileUrl) {\r\n+            setFileUrl(existingFileUrl);\r\n+            setShowInput(false); // hide input if existing file exists\r\n+        } else {\r\n+            setFileUrl(\"\");\r\n+            setShowInput(true);\r\n+        }\r\n+    }, [existingFileUrl]);\r\n+\r\n+    const handleFileChange = (e) => {\r\n+        const selectedFile = e.target.files[0];\r\n+        if (selectedFile) {\r\n+            setFile(selectedFile);\r\n+            setShowInput(false); // hide input when file selected\r\n+            setFileUrl(\"\"); // hide existing file link\r\n+            onFileSelect(selectedFile);\r\n+        }\r\n     };\r\n \r\n     const handleRemove = () => {\r\n-        setSelectedFile(null);\r\n-        if (onFileSelect) onFileSelect(null);\r\n+        setFile(null);\r\n+        setFileUrl(\"\");\r\n+        setShowInput(true); // show input again\r\n+        onFileSelect(null); // notify parent that file was removed\r\n     };\r\n \r\n     return (\r\n-        <div className=\"flex flex-col space-y-2\">\r\n-            {existingFileUrl && !selectedFile ? (\r\n-                <div className=\"flex items-center space-x-4\">\r\n-                    <a\r\n-                        href={`http://localhost:5000/${existingFileUrl.replace(\"\\\\\", \"/\")}`}\r\n-                        target=\"_blank\"\r\n-                        rel=\"noopener noreferrer\"\r\n-                        className=\"text-blue-500 underline\"\r\n-                    >\r\n-                        View Current File\r\n-                    </a>\r\n-                    <button\r\n-                        type=\"button\"\r\n-                        onClick={handleRemove}\r\n-                        className=\"text-red-500 px-2 py-1 border rounded\"\r\n-                    >\r\n-                        Remove\r\n-                    </button>\r\n-                </div>\r\n-            ) : (\r\n+        <div>\r\n+            {showInput ? (\r\n                 <input\r\n                     type=\"file\"\r\n-                    onChange={handleChange}\r\n-                    className=\"border p-2 rounded\"\r\n+                    onChange={handleFileChange}\r\n+                    className=\"border p-2 rounded w-full\"\r\n                 />\r\n-            )}\r\n-\r\n-            {selectedFile && (\r\n-                <div className=\"flex items-center space-x-4\">\r\n-                    <span>{selectedFile.name}</span>\r\n+            ) : (\r\n+                <div className=\"flex items-center space-x-2\">\r\n+                    <span className=\"text-gray-700\">\r\n+                        {file ? file.name : fileUrl.split(\"/\").pop().replace(\"\\\\\", \"/\")}\r\n+                    </span>\r\n                     <button\r\n                         type=\"button\"\r\n                         onClick={handleRemove}\r\n-                        className=\"text-red-500 px-2 py-1 border rounded\"\r\n+                        className=\"bg-red-500 text-white px-2 py-1 rounded\"\r\n                     >\r\n                         Remove\r\n                     </button>\r\n+                    {!file && fileUrl && (\r\n+                        <a\r\n+                            href={`http://localhost:5000/${fileUrl.replace(\"\\\\\", \"/\")}`}\r\n+                            target=\"_blank\"\r\n+                            rel=\"noopener noreferrer\"\r\n+                            className=\"text-blue-500 underline ml-2\"\r\n+                        >\r\n+                            View\r\n+                        </a>\r\n+                    )}\r\n                 </div>\r\n             )}\r\n         </div>\r\n     );\r\n"
                },
                {
                    "date": 1770573625331,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,64 +1,68 @@\n-import { useState, useEffect } from \"react\";\r\n+import { useEffect, useState } from \"react\";\r\n \r\n const FileUpload = ({ onFileSelect, existingFileUrl }) => {\r\n     const [file, setFile] = useState(null);\r\n     const [showInput, setShowInput] = useState(true);\r\n-    const [fileUrl, setFileUrl] = useState(\"\");\r\n+    const [existingFileName, setExistingFileName] = useState(\"\");\r\n \r\n     useEffect(() => {\r\n         if (existingFileUrl) {\r\n-            setFileUrl(existingFileUrl);\r\n-            setShowInput(false); // hide input if existing file exists\r\n+            // Extract filename only (no path)\r\n+            const name = existingFileUrl.split(/[/\\\\]/).pop();\r\n+            setExistingFileName(name);\r\n+            setShowInput(false);\r\n         } else {\r\n-            setFileUrl(\"\");\r\n+            setExistingFileName(\"\");\r\n             setShowInput(true);\r\n         }\r\n     }, [existingFileUrl]);\r\n \r\n     const handleFileChange = (e) => {\r\n-        const selectedFile = e.target.files[0];\r\n-        if (selectedFile) {\r\n-            setFile(selectedFile);\r\n-            setShowInput(false); // hide input when file selected\r\n-            setFileUrl(\"\"); // hide existing file link\r\n-            onFileSelect(selectedFile);\r\n+        const selected = e.target.files[0];\r\n+        if (selected) {\r\n+            setFile(selected);\r\n+            setExistingFileName(\"\");\r\n+            setShowInput(false);\r\n+            onFileSelect(selected);\r\n         }\r\n     };\r\n \r\n     const handleRemove = () => {\r\n         setFile(null);\r\n-        setFileUrl(\"\");\r\n-        setShowInput(true); // show input again\r\n-        onFileSelect(null); // notify parent that file was removed\r\n+        setExistingFileName(\"\");\r\n+        setShowInput(true);\r\n+        onFileSelect(null);\r\n     };\r\n \r\n     return (\r\n-        <div>\r\n+        <div className=\"flex flex-col space-y-2\">\r\n             {showInput ? (\r\n                 <input\r\n                     type=\"file\"\r\n                     onChange={handleFileChange}\r\n-                    className=\"border p-2 rounded w-full\"\r\n+                    className=\"border p-2 rounded\"\r\n                 />\r\n             ) : (\r\n-                <div className=\"flex items-center space-x-2\">\r\n+                <div className=\"flex items-center gap-3\">\r\n                     <span className=\"text-gray-700\">\r\n-                        {file ? file.name : fileUrl.split(\"/\").pop().replace(\"\\\\\", \"/\")}\r\n+                        {file ? file.name : existingFileName}\r\n                     </span>\r\n+\r\n                     <button\r\n                         type=\"button\"\r\n                         onClick={handleRemove}\r\n-                        className=\"bg-red-500 text-white px-2 py-1 rounded\"\r\n+                        className=\"text-red-500\"\r\n                     >\r\n                         Remove\r\n                     </button>\r\n-                    {!file && fileUrl && (\r\n+\r\n+                    {!file && existingFileUrl && (\r\n                         <a\r\n-                            href={`http://localhost:5000/${fileUrl.replace(\"\\\\\", \"/\")}`}\r\n+                            href={`http://localhost:5000/${existingFileUrl.replace(\"\\\\\", \"/\")}`}\r\n                             target=\"_blank\"\r\n                             rel=\"noopener noreferrer\"\r\n-                            className=\"text-blue-500 underline ml-2\"\r\n+                            className=\"text-blue-500 underline\"\r\n                         >\r\n                             View\r\n                         </a>\r\n                     )}\r\n"
                },
                {
                    "date": 1770573803980,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,35 +2,41 @@\n \r\n const FileUpload = ({ onFileSelect, existingFileUrl }) => {\r\n     const [file, setFile] = useState(null);\r\n     const [showInput, setShowInput] = useState(true);\r\n-    const [existingFileName, setExistingFileName] = useState(\"\");\r\n+    const [displayName, setDisplayName] = useState(\"\");\r\n \r\n     useEffect(() => {\r\n         if (existingFileUrl) {\r\n-            // Extract filename only (no path)\r\n-            const name = existingFileUrl.split(/[/\\\\]/).pop();\r\n-            setExistingFileName(name);\r\n+            // Get filename from path\r\n+            const fullName = existingFileUrl.split(/[/\\\\]/).pop();\r\n+\r\n+            // Remove system prefix (everything before first \"-\")\r\n+            const cleanName = fullName.includes(\"-\")\r\n+                ? fullName.substring(fullName.indexOf(\"-\") + 1)\r\n+                : fullName;\r\n+\r\n+            setDisplayName(cleanName);\r\n             setShowInput(false);\r\n         } else {\r\n-            setExistingFileName(\"\");\r\n+            setDisplayName(\"\");\r\n             setShowInput(true);\r\n         }\r\n     }, [existingFileUrl]);\r\n \r\n     const handleFileChange = (e) => {\r\n         const selected = e.target.files[0];\r\n-        if (selected) {\r\n-            setFile(selected);\r\n-            setExistingFileName(\"\");\r\n-            setShowInput(false);\r\n-            onFileSelect(selected);\r\n-        }\r\n+        if (!selected) return;\r\n+\r\n+        setFile(selected);\r\n+        setDisplayName(selected.name);\r\n+        setShowInput(false);\r\n+        onFileSelect(selected);\r\n     };\r\n \r\n     const handleRemove = () => {\r\n         setFile(null);\r\n-        setExistingFileName(\"\");\r\n+        setDisplayName(\"\");\r\n         setShowInput(true);\r\n         onFileSelect(null);\r\n     };\r\n \r\n@@ -44,9 +50,9 @@\n                 />\r\n             ) : (\r\n                 <div className=\"flex items-center gap-3\">\r\n                     <span className=\"text-gray-700\">\r\n-                        {file ? file.name : existingFileName}\r\n+                        {displayName}\r\n                     </span>\r\n \r\n                     <button\r\n                         type=\"button\"\r\n"
                },
                {
                    "date": 1770574354279,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,17 @@\n import { useEffect, useState } from \"react\";\r\n \r\n+export const getOriginalFileName = (documentUrl = \"\") => {\r\n+    const fileName = documentUrl.split(/[\\\\/]/).pop(); // remove path\r\n+    if (!fileName) return \"\";\r\n+\r\n+    const parts = fileName.split(\"-\");\r\n+    return parts.length > 2\r\n+        ? parts.slice(2).join(\"-\")\r\n+        : fileName;\r\n+};\r\n+\r\n+\r\n const FileUpload = ({ onFileSelect, existingFileUrl }) => {\r\n     const [file, setFile] = useState(null);\r\n     const [showInput, setShowInput] = useState(true);\r\n     const [displayName, setDisplayName] = useState(\"\");\r\n@@ -63,9 +74,9 @@\n                     </button>\r\n \r\n                     {!file && existingFileUrl && (\r\n                         <a\r\n-                            href={`http://localhost:5000/${existingFileUrl.replace(\"\\\\\", \"/\")}`}\r\n+                            href={`http://localhost:5000/${getOriginalFileName(existingFileUrl)}`}\r\n                             target=\"_blank\"\r\n                             rel=\"noopener noreferrer\"\r\n                             className=\"text-blue-500 underline\"\r\n                         >\r\n"
                },
                {
                    "date": 1770574479037,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,33 +1,29 @@\n import { useEffect, useState } from \"react\";\r\n \r\n+/**\r\n+ * Extract original filename by removing all system prefixes\r\n+ * Example:\r\n+ * 1770549265925-119596985-myfile.pdf → myfile.pdf\r\n+ */\r\n export const getOriginalFileName = (documentUrl = \"\") => {\r\n-    const fileName = documentUrl.split(/[\\\\/]/).pop(); // remove path\r\n+    const fileName = documentUrl.split(/[\\\\/]/).pop();\r\n     if (!fileName) return \"\";\r\n \r\n     const parts = fileName.split(\"-\");\r\n     return parts.length > 2\r\n         ? parts.slice(2).join(\"-\")\r\n         : fileName;\r\n };\r\n \r\n-\r\n const FileUpload = ({ onFileSelect, existingFileUrl }) => {\r\n     const [file, setFile] = useState(null);\r\n     const [showInput, setShowInput] = useState(true);\r\n     const [displayName, setDisplayName] = useState(\"\");\r\n \r\n     useEffect(() => {\r\n         if (existingFileUrl) {\r\n-            // Get filename from path\r\n-            const fullName = existingFileUrl.split(/[/\\\\]/).pop();\r\n-\r\n-            // Remove system prefix (everything before first \"-\")\r\n-            const cleanName = fullName.includes(\"-\")\r\n-                ? fullName.substring(fullName.indexOf(\"-\") + 1)\r\n-                : fullName;\r\n-\r\n-            setDisplayName(cleanName);\r\n+            setDisplayName(getOriginalFileName(existingFileUrl));\r\n             setShowInput(false);\r\n         } else {\r\n             setDisplayName(\"\");\r\n             setShowInput(true);\r\n@@ -74,9 +70,9 @@\n                     </button>\r\n \r\n                     {!file && existingFileUrl && (\r\n                         <a\r\n-                            href={`http://localhost:5000/${getOriginalFileName(existingFileUrl)}`}\r\n+                            href={`http://localhost:5000/${existingFileUrl.replace(/\\\\/g, \"/\")}`}\r\n                             target=\"_blank\"\r\n                             rel=\"noopener noreferrer\"\r\n                             className=\"text-blue-500 underline\"\r\n                         >\r\n"
                },
                {
                    "date": 1770574676471,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -21,9 +21,9 @@\n     const [displayName, setDisplayName] = useState(\"\");\r\n \r\n     useEffect(() => {\r\n         if (existingFileUrl) {\r\n-            setDisplayName(getOriginalFileName(existingFileUrl));\r\n+            setDisplayName(existingFileUrl);\r\n             setShowInput(false);\r\n         } else {\r\n             setDisplayName(\"\");\r\n             setShowInput(true);\r\n"
                },
                {
                    "date": 1770574695243,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,20 +1,20 @@\n import { useEffect, useState } from \"react\";\r\n \r\n-/**\r\n- * Extract original filename by removing all system prefixes\r\n- * Example:\r\n- * 1770549265925-119596985-myfile.pdf → myfile.pdf\r\n- */\r\n-export const getOriginalFileName = (documentUrl = \"\") => {\r\n-    const fileName = documentUrl.split(/[\\\\/]/).pop();\r\n-    if (!fileName) return \"\";\r\n+// /**\r\n+//  * Extract original filename by removing all system prefixes\r\n+//  * Example:\r\n+//  * 1770549265925-119596985-myfile.pdf → myfile.pdf\r\n+//  */\r\n+// export const getOriginalFileName = (documentUrl = \"\") => {\r\n+//     const fileName = documentUrl.split(/[\\\\/]/).pop();\r\n+//     if (!fileName) return \"\";\r\n \r\n-    const parts = fileName.split(\"-\");\r\n-    return parts.length > 2\r\n-        ? parts.slice(2).join(\"-\")\r\n-        : fileName;\r\n-};\r\n+//     const parts = fileName.split(\"-\");\r\n+//     return parts.length > 2\r\n+//         ? parts.slice(2).join(\"-\")\r\n+//         : fileName;\r\n+// };\r\n \r\n const FileUpload = ({ onFileSelect, existingFileUrl }) => {\r\n     const [file, setFile] = useState(null);\r\n     const [showInput, setShowInput] = useState(true);\r\n"
                },
                {
                    "date": 1770574711804,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,29 +1,23 @@\n import { useEffect, useState } from \"react\";\r\n \r\n-// /**\r\n-//  * Extract original filename by removing all system prefixes\r\n-//  * Example:\r\n-//  * 1770549265925-119596985-myfile.pdf → myfile.pdf\r\n-//  */\r\n-// export const getOriginalFileName = (documentUrl = \"\") => {\r\n-//     const fileName = documentUrl.split(/[\\\\/]/).pop();\r\n-//     if (!fileName) return \"\";\r\n \r\n-//     const parts = fileName.split(\"-\");\r\n-//     return parts.length > 2\r\n-//         ? parts.slice(2).join(\"-\")\r\n-//         : fileName;\r\n-// };\r\n-\r\n const FileUpload = ({ onFileSelect, existingFileUrl }) => {\r\n     const [file, setFile] = useState(null);\r\n     const [showInput, setShowInput] = useState(true);\r\n     const [displayName, setDisplayName] = useState(\"\");\r\n \r\n     useEffect(() => {\r\n         if (existingFileUrl) {\r\n-            setDisplayName(existingFileUrl);\r\n+            // Get filename from path\r\n+            const fullName = existingFileUrl.split(/[/\\\\]/).pop();\r\n+\r\n+            // Remove system prefix (everything before first \"-\")\r\n+            const cleanName = fullName.includes(\"-\")\r\n+                ? fullName.substring(fullName.indexOf(\"-\") + 1)\r\n+                : fullName;\r\n+\r\n+            setDisplayName(cleanName);\r\n             setShowInput(false);\r\n         } else {\r\n             setDisplayName(\"\");\r\n             setShowInput(true);\r\n@@ -70,9 +64,9 @@\n                     </button>\r\n \r\n                     {!file && existingFileUrl && (\r\n                         <a\r\n-                            href={`http://localhost:5000/${existingFileUrl.replace(/\\\\/g, \"/\")}`}\r\n+                            href={`http://localhost:5000/${existingFileUrl.replace(\"\\\\\", \"/\")}`}\r\n                             target=\"_blank\"\r\n                             rel=\"noopener noreferrer\"\r\n                             className=\"text-blue-500 underline\"\r\n                         >\r\n"
                },
                {
                    "date": 1770574865653,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,23 +1,29 @@\n import { useEffect, useState } from \"react\";\r\n \r\n+/**\r\n+ * Extract original filename by removing all system prefixes\r\n+ * Example:\r\n+ * 1770549265925-119596985-myfile.pdf → myfile.pdf\r\n+ */\r\n+export const getOriginalFileName = (documentUrl = \"\") => {\r\n+    const fileName = documentUrl.split(/[\\\\/]/).pop();\r\n+    if (!fileName) return \"\";\r\n \r\n+    const parts = fileName.split(\"-\");\r\n+    return parts.length > 2\r\n+        ? parts.slice(2).join(\"-\")\r\n+        : fileName;\r\n+};\r\n+\r\n const FileUpload = ({ onFileSelect, existingFileUrl }) => {\r\n     const [file, setFile] = useState(null);\r\n     const [showInput, setShowInput] = useState(true);\r\n     const [displayName, setDisplayName] = useState(\"\");\r\n \r\n     useEffect(() => {\r\n         if (existingFileUrl) {\r\n-            // Get filename from path\r\n-            const fullName = existingFileUrl.split(/[/\\\\]/).pop();\r\n-\r\n-            // Remove system prefix (everything before first \"-\")\r\n-            const cleanName = fullName.includes(\"-\")\r\n-                ? fullName.substring(fullName.indexOf(\"-\") + 1)\r\n-                : fullName;\r\n-\r\n-            setDisplayName(cleanName);\r\n+            setDisplayName(getOriginalFileName(existingFileUrl));\r\n             setShowInput(false);\r\n         } else {\r\n             setDisplayName(\"\");\r\n             setShowInput(true);\r\n@@ -64,9 +70,9 @@\n                     </button>\r\n \r\n                     {!file && existingFileUrl && (\r\n                         <a\r\n-                            href={`http://localhost:5000/${existingFileUrl.replace(\"\\\\\", \"/\")}`}\r\n+                            href={`http://localhost:5000/${existingFileUrl.replace(/\\\\/g, \"/\")}`}\r\n                             target=\"_blank\"\r\n                             rel=\"noopener noreferrer\"\r\n                             className=\"text-blue-500 underline\"\r\n                         >\r\n"
                },
                {
                    "date": 1770575049866,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,14 +8,13 @@\n export const getOriginalFileName = (documentUrl = \"\") => {\r\n     const fileName = documentUrl.split(/[\\\\/]/).pop();\r\n     if (!fileName) return \"\";\r\n \r\n-    const parts = fileName.split(\"-\");\r\n-    return parts.length > 2\r\n-        ? parts.slice(2).join(\"-\")\r\n-        : fileName;\r\n+    // remove all leading \"number-\" prefixes\r\n+    return fileName.replace(/^(\\d+-)+/, \"\");\r\n };\r\n \r\n+\r\n const FileUpload = ({ onFileSelect, existingFileUrl }) => {\r\n     const [file, setFile] = useState(null);\r\n     const [showInput, setShowInput] = useState(true);\r\n     const [displayName, setDisplayName] = useState(\"\");\r\n"
                }
            ],
            "date": 1770572681811,
            "name": "Commit-0",
            "content": "import { useEffect, useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { getContracts, deleteContract } from \"../../api/contractApi\";\r\n\r\nconst ContractList = () => {\r\n    const [contracts, setContracts] = useState([]);\r\n\r\n    const fetchContracts = async () => {\r\n        const data = await getContracts();\r\n        setContracts(data);\r\n    };\r\n\r\n    const handleDelete = async (id) => {\r\n        if (!window.confirm(\"Are you sure you want to delete this contract?\")) return;\r\n        await deleteContract(id);\r\n        fetchContracts();\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchContracts();\r\n    }, []);\r\n\r\n    return (\r\n        <div>\r\n            <h1 className=\"text-2xl font-bold mb-4\">Contracts</h1>\r\n            <Link\r\n                to=\"/contracts/new\"\r\n                className=\"bg-gray-500 text-white px-4 py-2 rounded mb-4 inline-block\"\r\n            >\r\n                Add Contract\r\n            </Link>\r\n\r\n            <table className=\"min-w-full bg-white border\">\r\n                <thead>\r\n                    <tr>\r\n                        <th className=\"py-2 px-4 border\">Borrower-Loan</th>\r\n                        <th className=\"py-2 px-4 border\">Signing Date</th>\r\n                        <th className=\"py-2 px-4 border\">Document</th>\r\n                        <th className=\"py-2 px-4 border\">Actions</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    {contracts.map((c) => (\r\n                        <tr key={c._id}>\r\n                            <td className=\"py-2 px-4 border\">\r\n                                {c.loan?.borrower?.fullName}-{c.loan?.amount}\r\n                            </td>\r\n                            <td className=\"py-2 px-4 border\">\r\n                                {new Date(c.signingDate).toLocaleDateString()}\r\n                            </td>\r\n                            <td className=\"py-2 px-4 border\">\r\n                                {c.documentUrl ? (\r\n                                    <a\r\n                                        href={`http://localhost:5000/${c.documentUrl.replace(\"\\\\\", \"/\")}`}\r\n                                        target=\"_blank\"\r\n                                        rel=\"noopener noreferrer\"\r\n                                        className=\"text-blue-500 underline\"\r\n                                    >\r\n                                        Download\r\n                                    </a>\r\n                                ) : (\r\n                                    \"No file\"\r\n                                )}\r\n                            </td>\r\n                            <td className=\"py-2 px-4 border\">\r\n                                <Link to={`/contracts/edit/${c._id}`} className=\"text-blue-500 mr-2\">\r\n                                    Edit\r\n                                </Link>\r\n                                <button onClick={() => handleDelete(c._id)} className=\"text-red-500\">\r\n                                    Delete\r\n                                </button>\r\n                            </td>\r\n                        </tr>\r\n                    ))}\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ContractList;\r\n"
        }
    ]
}