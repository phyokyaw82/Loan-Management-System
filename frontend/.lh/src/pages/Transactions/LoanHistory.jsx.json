{
    "sourceFile": "src/pages/Transactions/LoanHistory.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 7,
            "patches": [
                {
                    "date": 1770567338171,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1770567724419,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,8 +2,9 @@\n import { getRepaymentsByLoan } from \"../../api/repaymentApi\";\r\n import { getTransactionsByLoan } from \"../../api/transactionApi\";\r\n \r\n const LoanHistory = ({ loanId }) => {\r\n+    alert(loanId);\r\n     const [history, setHistory] = useState([]);\r\n \r\n     useEffect(() => {\r\n         if (!loanId) return;\r\n"
                },
                {
                    "date": 1770567898581,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,9 +2,9 @@\n import { getRepaymentsByLoan } from \"../../api/repaymentApi\";\r\n import { getTransactionsByLoan } from \"../../api/transactionApi\";\r\n \r\n const LoanHistory = ({ loanId }) => {\r\n-    alert(loanId);\r\n+\r\n     const [history, setHistory] = useState([]);\r\n \r\n     useEffect(() => {\r\n         if (!loanId) return;\r\n"
                },
                {
                    "date": 1770568020497,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,9 +28,9 @@\n             ];\r\n \r\n             // Sort by date descending\r\n             combined.sort((a, b) => new Date(b.date) - new Date(a.date));\r\n-\r\n+            alert(JSON.stringify(combined));\r\n             setHistory(combined);\r\n         };\r\n \r\n         fetchHistory();\r\n"
                },
                {
                    "date": 1770568059241,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,8 +12,11 @@\n         const fetchHistory = async () => {\r\n             const repayments = await getRepaymentsByLoan(loanId);\r\n             const transactions = await getTransactionsByLoan(loanId);\r\n \r\n+            alert(repayments.length)\r\n+            alert(transactions.length)\r\n+\r\n             // Tag each record for type\r\n             const combined = [\r\n                 ...repayments.map((r) => ({\r\n                     ...r,\r\n@@ -28,9 +31,8 @@\n             ];\r\n \r\n             // Sort by date descending\r\n             combined.sort((a, b) => new Date(b.date) - new Date(a.date));\r\n-            alert(JSON.stringify(combined));\r\n             setHistory(combined);\r\n         };\r\n \r\n         fetchHistory();\r\n"
                },
                {
                    "date": 1770568135787,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,39 +1,43 @@\n import { useEffect, useState } from \"react\";\r\n-import { getRepaymentsByLoan } from \"../../api/repaymentApi\";\r\n-import { getTransactionsByLoan } from \"../../api/transactionApi\";\r\n+import { getRepaymentsByLoan } from \"../api/repaymentApi\";\r\n+import { getTransactionsByLoan } from \"../api/transactionApi\";\r\n \r\n const LoanHistory = ({ loanId }) => {\r\n-\r\n     const [history, setHistory] = useState([]);\r\n \r\n     useEffect(() => {\r\n         if (!loanId) return;\r\n \r\n         const fetchHistory = async () => {\r\n-            const repayments = await getRepaymentsByLoan(loanId);\r\n-            const transactions = await getTransactionsByLoan(loanId);\r\n+            try {\r\n+                const repayments = await getRepaymentsByLoan(loanId);\r\n+                const transactions = await getTransactionsByLoan(loanId);\r\n \r\n-            alert(repayments.length)\r\n-            alert(transactions.length)\r\n+                const combined = [\r\n+                    ...repayments.map((r) => ({\r\n+                        _id: r._id,\r\n+                        recordType: \"Repayment\",\r\n+                        date: r.paymentDate,\r\n+                        amount: r.amountPaid,\r\n+                        description: r.description || \"-\",\r\n+                    })),\r\n+                    ...transactions.map((t) => ({\r\n+                        _id: t._id,\r\n+                        recordType: t.type,\r\n+                        date: t.transactionDate,\r\n+                        amount: t.amount,\r\n+                        description: t.description || \"-\",\r\n+                    })),\r\n+                ];\r\n \r\n-            // Tag each record for type\r\n-            const combined = [\r\n-                ...repayments.map((r) => ({\r\n-                    ...r,\r\n-                    recordType: \"Repayment\",\r\n-                    date: r.paymentDate,\r\n-                })),\r\n-                ...transactions.map((t) => ({\r\n-                    ...t,\r\n-                    recordType: t.type,\r\n-                    date: t.transactionDate,\r\n-                })),\r\n-            ];\r\n+                // Sort by date descending\r\n+                combined.sort((a, b) => new Date(b.date) - new Date(a.date));\r\n \r\n-            // Sort by date descending\r\n-            combined.sort((a, b) => new Date(b.date) - new Date(a.date));\r\n-            setHistory(combined);\r\n+                setHistory(combined);\r\n+            } catch (err) {\r\n+                console.error(\"Error fetching loan history:\", err);\r\n+            }\r\n         };\r\n \r\n         fetchHistory();\r\n     }, [loanId]);\r\n@@ -63,10 +67,10 @@\n                         history.map((h) => (\r\n                             <tr key={h._id}>\r\n                                 <td className=\"py-2 px-4 border\">{new Date(h.date).toLocaleDateString()}</td>\r\n                                 <td className=\"py-2 px-4 border\">{h.recordType}</td>\r\n-                                <td className=\"py-2 px-4 border\">{h.amountPaid || h.amount}</td>\r\n-                                <td className=\"py-2 px-4 border\">{h.description || \"-\"}</td>\r\n+                                <td className=\"py-2 px-4 border\">{h.amount}</td>\r\n+                                <td className=\"py-2 px-4 border\">{h.description}</td>\r\n                             </tr>\r\n                         ))\r\n                     )}\r\n                 </tbody>\r\n"
                },
                {
                    "date": 1770568239449,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,7 @@\n import { useEffect, useState } from \"react\";\r\n-import { getRepaymentsByLoan } from \"../api/repaymentApi\";\r\n-import { getTransactionsByLoan } from \"../api/transactionApi\";\r\n+import { getRepaymentsByLoan } from \"../../api/repaymentApi\";\r\n+import { getTransactionsByLoan } from \"../../api/transactionApi\";\r\n \r\n const LoanHistory = ({ loanId }) => {\r\n     const [history, setHistory] = useState([]);\r\n \r\n"
                },
                {
                    "date": 1770577172359,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,81 +1,56 @@\n import { useEffect, useState } from \"react\";\r\n import { getRepaymentsByLoan } from \"../../api/repaymentApi\";\r\n import { getTransactionsByLoan } from \"../../api/transactionApi\";\r\n+import DataTable from \"../../components/DataTable\";\r\n \r\n const LoanHistory = ({ loanId }) => {\r\n     const [history, setHistory] = useState([]);\r\n \r\n     useEffect(() => {\r\n         if (!loanId) return;\r\n \r\n         const fetchHistory = async () => {\r\n-            try {\r\n-                const repayments = await getRepaymentsByLoan(loanId);\r\n-                const transactions = await getTransactionsByLoan(loanId);\r\n+            const repayments = await getRepaymentsByLoan(loanId);\r\n+            const transactions = await getTransactionsByLoan(loanId);\r\n \r\n-                const combined = [\r\n-                    ...repayments.map((r) => ({\r\n-                        _id: r._id,\r\n-                        recordType: \"Repayment\",\r\n-                        date: r.paymentDate,\r\n-                        amount: r.amountPaid,\r\n-                        description: r.description || \"-\",\r\n-                    })),\r\n-                    ...transactions.map((t) => ({\r\n-                        _id: t._id,\r\n-                        recordType: t.type,\r\n-                        date: t.transactionDate,\r\n-                        amount: t.amount,\r\n-                        description: t.description || \"-\",\r\n-                    })),\r\n-                ];\r\n+            const combined = [\r\n+                ...repayments.map((r) => ({\r\n+                    _id: r._id,\r\n+                    type: \"Repayment\",\r\n+                    date: r.paymentDate,\r\n+                    amount: r.amountPaid,\r\n+                    description: r.description || \"-\",\r\n+                })),\r\n+                ...transactions.map((t) => ({\r\n+                    _id: t._id,\r\n+                    type: t.type,\r\n+                    date: t.transactionDate,\r\n+                    amount: t.amount,\r\n+                    description: t.description || \"-\",\r\n+                })),\r\n+            ];\r\n \r\n-                // Sort by date descending\r\n-                combined.sort((a, b) => new Date(b.date) - new Date(a.date));\r\n-\r\n-                setHistory(combined);\r\n-            } catch (err) {\r\n-                console.error(\"Error fetching loan history:\", err);\r\n-            }\r\n+            combined.sort((a, b) => new Date(b.date) - new Date(a.date));\r\n+            setHistory(combined);\r\n         };\r\n \r\n         fetchHistory();\r\n     }, [loanId]);\r\n \r\n     if (!loanId) return null;\r\n \r\n+    const columns = [\r\n+        { label: \"Date\", key: \"date\", render: (row) => new Date(row.date).toLocaleDateString() },\r\n+        { label: \"Type\", key: \"type\" },\r\n+        { label: \"Amount\", key: \"amount\" },\r\n+        { label: \"Description\", key: \"description\" },\r\n+    ];\r\n+\r\n     return (\r\n         <div className=\"mt-6\">\r\n             <h2 className=\"text-xl font-semibold mb-2\">Loan History</h2>\r\n-            <table className=\"min-w-full bg-white border\">\r\n-                <thead>\r\n-                    <tr>\r\n-                        <th className=\"py-2 px-4 border\">Date</th>\r\n-                        <th className=\"py-2 px-4 border\">Type</th>\r\n-                        <th className=\"py-2 px-4 border\">Amount</th>\r\n-                        <th className=\"py-2 px-4 border\">Description</th>\r\n-                    </tr>\r\n-                </thead>\r\n-                <tbody>\r\n-                    {history.length === 0 ? (\r\n-                        <tr>\r\n-                            <td colSpan=\"4\" className=\"py-2 px-4 text-center text-gray-500\">\r\n-                                No history found.\r\n-                            </td>\r\n-                        </tr>\r\n-                    ) : (\r\n-                        history.map((h) => (\r\n-                            <tr key={h._id}>\r\n-                                <td className=\"py-2 px-4 border\">{new Date(h.date).toLocaleDateString()}</td>\r\n-                                <td className=\"py-2 px-4 border\">{h.recordType}</td>\r\n-                                <td className=\"py-2 px-4 border\">{h.amount}</td>\r\n-                                <td className=\"py-2 px-4 border\">{h.description}</td>\r\n-                            </tr>\r\n-                        ))\r\n-                    )}\r\n-                </tbody>\r\n-            </table>\r\n+            <DataTable columns={columns} data={history} />\r\n         </div>\r\n     );\r\n };\r\n \r\n"
                }
            ],
            "date": 1770567338171,
            "name": "Commit-0",
            "content": "import { useEffect, useState } from \"react\";\r\nimport { getRepaymentsByLoan } from \"../../api/repaymentApi\";\r\nimport { getTransactionsByLoan } from \"../../api/transactionApi\";\r\n\r\nconst LoanHistory = ({ loanId }) => {\r\n    const [history, setHistory] = useState([]);\r\n\r\n    useEffect(() => {\r\n        if (!loanId) return;\r\n\r\n        const fetchHistory = async () => {\r\n            const repayments = await getRepaymentsByLoan(loanId);\r\n            const transactions = await getTransactionsByLoan(loanId);\r\n\r\n            // Tag each record for type\r\n            const combined = [\r\n                ...repayments.map((r) => ({\r\n                    ...r,\r\n                    recordType: \"Repayment\",\r\n                    date: r.paymentDate,\r\n                })),\r\n                ...transactions.map((t) => ({\r\n                    ...t,\r\n                    recordType: t.type,\r\n                    date: t.transactionDate,\r\n                })),\r\n            ];\r\n\r\n            // Sort by date descending\r\n            combined.sort((a, b) => new Date(b.date) - new Date(a.date));\r\n\r\n            setHistory(combined);\r\n        };\r\n\r\n        fetchHistory();\r\n    }, [loanId]);\r\n\r\n    if (!loanId) return null;\r\n\r\n    return (\r\n        <div className=\"mt-6\">\r\n            <h2 className=\"text-xl font-semibold mb-2\">Loan History</h2>\r\n            <table className=\"min-w-full bg-white border\">\r\n                <thead>\r\n                    <tr>\r\n                        <th className=\"py-2 px-4 border\">Date</th>\r\n                        <th className=\"py-2 px-4 border\">Type</th>\r\n                        <th className=\"py-2 px-4 border\">Amount</th>\r\n                        <th className=\"py-2 px-4 border\">Description</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    {history.length === 0 ? (\r\n                        <tr>\r\n                            <td colSpan=\"4\" className=\"py-2 px-4 text-center text-gray-500\">\r\n                                No history found.\r\n                            </td>\r\n                        </tr>\r\n                    ) : (\r\n                        history.map((h) => (\r\n                            <tr key={h._id}>\r\n                                <td className=\"py-2 px-4 border\">{new Date(h.date).toLocaleDateString()}</td>\r\n                                <td className=\"py-2 px-4 border\">{h.recordType}</td>\r\n                                <td className=\"py-2 px-4 border\">{h.amountPaid || h.amount}</td>\r\n                                <td className=\"py-2 px-4 border\">{h.description || \"-\"}</td>\r\n                            </tr>\r\n                        ))\r\n                    )}\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default LoanHistory;\r\n"
        }
    ]
}