{
    "sourceFile": "src/pages/Contracts/ContractForm.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 27,
            "patches": [
                {
                    "date": 1770568590585,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1770568892580,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,9 +5,9 @@\n \r\n const ContractForm = () => {\r\n     const [contract, setContract] = useState({\r\n         loan: \"\",\r\n-        document: null,\r\n+        documentUrl: null,\r\n         signingDate: \"\",\r\n     });\r\n     const [loans, setLoans] = useState([]);\r\n     const navigate = useNavigate();\r\n@@ -19,27 +19,27 @@\n         if (id) {\r\n             getContractById(id).then((data) => {\r\n                 setContract({\r\n                     loan: data.loan?._id || \"\",\r\n-                    document: null, // file input can't be prefilled\r\n+                    documentUrl: null, // file input can't be prefilled\r\n                     signingDate: data.signingDate ? data.signingDate.slice(0, 10) : \"\",\r\n                 });\r\n             });\r\n         }\r\n     }, [id]);\r\n \r\n     const handleChange = (e) => {\r\n         const { name, value, files } = e.target;\r\n-        if (name === \"document\") setContract({ ...contract, document: files[0] });\r\n+        if (name === \"documentUrl\") setContract({ ...contract, documentUrl: files[0] });\r\n         else setContract({ ...contract, [name]: value });\r\n     };\r\n \r\n     const handleSubmit = async (e) => {\r\n         e.preventDefault();\r\n         const formData = new FormData();\r\n         formData.append(\"loan\", contract.loan);\r\n         formData.append(\"signingDate\", contract.signingDate);\r\n-        if (contract.document) formData.append(\"document\", contract.document);\r\n+        if (contract.documentUrl) formData.append(\"documentUrl\", contract.documentUrl);\r\n \r\n         try {\r\n             if (id) await updateContract(id, formData);\r\n             else await createContract(formData);\r\n@@ -81,9 +81,9 @@\n \r\n                 {/* Document */}\r\n                 <div className=\"flex flex-col\">\r\n                     <label className=\"mb-1 font-medium\">Contract Document (PDF)</label>\r\n-                    <input type=\"file\" name=\"document\" onChange={handleChange} className=\"border p-2 rounded\" />\r\n+                    <input type=\"file\" name=\"documentUrl\" onChange={handleChange} className=\"border p-2 rounded\" />\r\n                 </div>\r\n \r\n                 {/* Submit */}\r\n                 <div className=\"flex justify-end\">\r\n"
                },
                {
                    "date": 1770569092138,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,9 +5,9 @@\n \r\n const ContractForm = () => {\r\n     const [contract, setContract] = useState({\r\n         loan: \"\",\r\n-        documentUrl: null,\r\n+        documentUrl: null, // File\r\n         signingDate: \"\",\r\n     });\r\n     const [loans, setLoans] = useState([]);\r\n     const navigate = useNavigate();\r\n@@ -19,9 +19,9 @@\n         if (id) {\r\n             getContractById(id).then((data) => {\r\n                 setContract({\r\n                     loan: data.loan?._id || \"\",\r\n-                    documentUrl: null, // file input can't be prefilled\r\n+                    documentUrl: null, // Cannot prefill file input\r\n                     signingDate: data.signingDate ? data.signingDate.slice(0, 10) : \"\",\r\n                 });\r\n             });\r\n         }\r\n@@ -34,12 +34,14 @@\n     };\r\n \r\n     const handleSubmit = async (e) => {\r\n         e.preventDefault();\r\n+\r\n+        // Build FormData for file upload\r\n         const formData = new FormData();\r\n         formData.append(\"loan\", contract.loan);\r\n         formData.append(\"signingDate\", contract.signingDate);\r\n-        if (contract.documentUrl) formData.append(\"documentUrl\", contract.documentUrl);\r\n+        if (contract.documentUrl) formData.append(\"documentUrl\", contract.documentUrl); // Only if a new file is selected\r\n \r\n         try {\r\n             if (id) await updateContract(id, formData);\r\n             else await createContract(formData);\r\n@@ -69,18 +71,12 @@\n \r\n                 {/* Signing Date */}\r\n                 <div className=\"flex flex-col\">\r\n                     <label className=\"mb-1 font-medium\">Signing Date</label>\r\n-                    <input\r\n-                        type=\"date\"\r\n-                        name=\"signingDate\"\r\n-                        value={contract.signingDate}\r\n-                        onChange={handleChange}\r\n-                        className=\"border p-2 rounded\"\r\n-                    />\r\n+                    <input type=\"date\" name=\"signingDate\" value={contract.signingDate} onChange={handleChange} className=\"border p-2 rounded\" />\r\n                 </div>\r\n \r\n-                {/* Document */}\r\n+                {/* File Upload */}\r\n                 <div className=\"flex flex-col\">\r\n                     <label className=\"mb-1 font-medium\">Contract Document (PDF)</label>\r\n                     <input type=\"file\" name=\"documentUrl\" onChange={handleChange} className=\"border p-2 rounded\" />\r\n                 </div>\r\n"
                },
                {
                    "date": 1770569206091,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,9 +5,9 @@\n \r\n const ContractForm = () => {\r\n     const [contract, setContract] = useState({\r\n         loan: \"\",\r\n-        documentUrl: null, // File\r\n+        documentUrl: null, // renamed field\r\n         signingDate: \"\",\r\n     });\r\n     const [loans, setLoans] = useState([]);\r\n     const navigate = useNavigate();\r\n@@ -19,9 +19,9 @@\n         if (id) {\r\n             getContractById(id).then((data) => {\r\n                 setContract({\r\n                     loan: data.loan?._id || \"\",\r\n-                    documentUrl: null, // Cannot prefill file input\r\n+                    documentUrl: null, // cannot prefill file input\r\n                     signingDate: data.signingDate ? data.signingDate.slice(0, 10) : \"\",\r\n                 });\r\n             });\r\n         }\r\n@@ -35,13 +35,12 @@\n \r\n     const handleSubmit = async (e) => {\r\n         e.preventDefault();\r\n \r\n-        // Build FormData for file upload\r\n         const formData = new FormData();\r\n         formData.append(\"loan\", contract.loan);\r\n         formData.append(\"signingDate\", contract.signingDate);\r\n-        if (contract.documentUrl) formData.append(\"documentUrl\", contract.documentUrl); // Only if a new file is selected\r\n+        if (contract.documentUrl) formData.append(\"documentUrl\", contract.documentUrl);\r\n \r\n         try {\r\n             if (id) await updateContract(id, formData);\r\n             else await createContract(formData);\r\n"
                },
                {
                    "date": 1770569252289,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,9 +5,9 @@\n \r\n const ContractForm = () => {\r\n     const [contract, setContract] = useState({\r\n         loan: \"\",\r\n-        documentUrl: null, // renamed field\r\n+        document: null, // File\r\n         signingDate: \"\",\r\n     });\r\n     const [loans, setLoans] = useState([]);\r\n     const navigate = useNavigate();\r\n@@ -19,28 +19,29 @@\n         if (id) {\r\n             getContractById(id).then((data) => {\r\n                 setContract({\r\n                     loan: data.loan?._id || \"\",\r\n-                    documentUrl: null, // cannot prefill file input\r\n+                    document: null, // Cannot prefill file input\r\n                     signingDate: data.signingDate ? data.signingDate.slice(0, 10) : \"\",\r\n                 });\r\n             });\r\n         }\r\n     }, [id]);\r\n \r\n     const handleChange = (e) => {\r\n         const { name, value, files } = e.target;\r\n-        if (name === \"documentUrl\") setContract({ ...contract, documentUrl: files[0] });\r\n+        if (name === \"document\") setContract({ ...contract, document: files[0] });\r\n         else setContract({ ...contract, [name]: value });\r\n     };\r\n \r\n     const handleSubmit = async (e) => {\r\n         e.preventDefault();\r\n \r\n+        // Build FormData for file upload\r\n         const formData = new FormData();\r\n         formData.append(\"loan\", contract.loan);\r\n         formData.append(\"signingDate\", contract.signingDate);\r\n-        if (contract.documentUrl) formData.append(\"documentUrl\", contract.documentUrl);\r\n+        if (contract.document) formData.append(\"document\", contract.document); // Only if a new file is selected\r\n \r\n         try {\r\n             if (id) await updateContract(id, formData);\r\n             else await createContract(formData);\r\n@@ -76,9 +77,9 @@\n \r\n                 {/* File Upload */}\r\n                 <div className=\"flex flex-col\">\r\n                     <label className=\"mb-1 font-medium\">Contract Document (PDF)</label>\r\n-                    <input type=\"file\" name=\"documentUrl\" onChange={handleChange} className=\"border p-2 rounded\" />\r\n+                    <input type=\"file\" name=\"document\" onChange={handleChange} className=\"border p-2 rounded\" />\r\n                 </div>\r\n \r\n                 {/* Submit */}\r\n                 <div className=\"flex justify-end\">\r\n"
                },
                {
                    "date": 1770569394834,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,9 +28,9 @@\n     }, [id]);\r\n \r\n     const handleChange = (e) => {\r\n         const { name, value, files } = e.target;\r\n-        if (name === \"document\") setContract({ ...contract, document: files[0] });\r\n+        if (name === \"document\") setContract({ ...contract, documentUrl: files[0] });\r\n         else setContract({ ...contract, [name]: value });\r\n     };\r\n \r\n     const handleSubmit = async (e) => {\r\n@@ -77,9 +77,9 @@\n \r\n                 {/* File Upload */}\r\n                 <div className=\"flex flex-col\">\r\n                     <label className=\"mb-1 font-medium\">Contract Document (PDF)</label>\r\n-                    <input type=\"file\" name=\"document\" onChange={handleChange} className=\"border p-2 rounded\" />\r\n+                    <input type=\"file\" name=\"documentUrl\" onChange={handleChange} className=\"border p-2 rounded\" />\r\n                 </div>\r\n \r\n                 {/* Submit */}\r\n                 <div className=\"flex justify-end\">\r\n"
                },
                {
                    "date": 1770569440692,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,9 +5,9 @@\n \r\n const ContractForm = () => {\r\n     const [contract, setContract] = useState({\r\n         loan: \"\",\r\n-        document: null, // File\r\n+        documentUrl: null, // File\r\n         signingDate: \"\",\r\n     });\r\n     const [loans, setLoans] = useState([]);\r\n     const navigate = useNavigate();\r\n@@ -28,9 +28,9 @@\n     }, [id]);\r\n \r\n     const handleChange = (e) => {\r\n         const { name, value, files } = e.target;\r\n-        if (name === \"document\") setContract({ ...contract, documentUrl: files[0] });\r\n+        if (name === \"document\") setContract({ ...contract, document: files[0] });\r\n         else setContract({ ...contract, [name]: value });\r\n     };\r\n \r\n     const handleSubmit = async (e) => {\r\n"
                },
                {
                    "date": 1770569494498,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -19,18 +19,18 @@\n         if (id) {\r\n             getContractById(id).then((data) => {\r\n                 setContract({\r\n                     loan: data.loan?._id || \"\",\r\n-                    document: null, // Cannot prefill file input\r\n+                    documentUrl: null, // Cannot prefill file input\r\n                     signingDate: data.signingDate ? data.signingDate.slice(0, 10) : \"\",\r\n                 });\r\n             });\r\n         }\r\n     }, [id]);\r\n \r\n     const handleChange = (e) => {\r\n         const { name, value, files } = e.target;\r\n-        if (name === \"document\") setContract({ ...contract, document: files[0] });\r\n+        if (name === \"document\") setContract({ ...contract, documentUrl: files[0] });\r\n         else setContract({ ...contract, [name]: value });\r\n     };\r\n \r\n     const handleSubmit = async (e) => {\r\n@@ -39,9 +39,9 @@\n         // Build FormData for file upload\r\n         const formData = new FormData();\r\n         formData.append(\"loan\", contract.loan);\r\n         formData.append(\"signingDate\", contract.signingDate);\r\n-        if (contract.document) formData.append(\"document\", contract.document); // Only if a new file is selected\r\n+        if (contract.documentUrl) formData.append(\"document\", contract.documentUrl); // Only if a new file is selected\r\n \r\n         try {\r\n             if (id) await updateContract(id, formData);\r\n             else await createContract(formData);\r\n"
                },
                {
                    "date": 1770570037449,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,47 +1,63 @@\n+import axios from \"axios\";\r\n+\r\n+const API_URL = \"http://localhost:5000/contracts\";\r\n+\r\n+// Get all\r\n+export const getContracts = async () => (await axios.get(API_URL)).data;\r\n+\r\n+// Get by ID\r\n+export const getContractById = async (id) => (await axios.get(`${API_URL}/${id}`)).data;\r\n+\r\n+// Get by Loan\r\n+export const getContractsByLoan = async (loanId) => (await axios.get(`${API_URL}/loan/${loanId}`)).data;\r\n+\r\n+// Create\r\n+export const createContract = async (formData) =>\r\n+    (await axios.post(API_URL, formData, { headers: { \"Content-Type\": \"multipart/form-data\" } })).data;\r\n+\r\n+// Update\r\n+export const updateContract = async (id, formData) =>\r\n+    (await axios.put(`${API_URL}/${id}`, formData, { headers: { \"Content-Type\": \"multipart/form-data\" } })).data;\r\n+\r\n+// Delete\r\n+export const deleteContract = async (id) => (await axios.delete(`${API_URL}/${id}`)).data;\r\n import { useState, useEffect } from \"react\";\r\n import { useNavigate, useParams } from \"react-router-dom\";\r\n import { createContract, getContractById, updateContract } from \"../../api/contractApi\";\r\n import { getLoans } from \"../../api/loanApi\";\r\n \r\n const ContractForm = () => {\r\n-    const [contract, setContract] = useState({\r\n-        loan: \"\",\r\n-        documentUrl: null, // File\r\n-        signingDate: \"\",\r\n-    });\r\n+    const [contract, setContract] = useState({ loan: \"\", documentUrl: null, signingDate: \"\" });\r\n     const [loans, setLoans] = useState([]);\r\n     const navigate = useNavigate();\r\n     const { id } = useParams();\r\n \r\n     useEffect(() => {\r\n         getLoans().then(setLoans);\r\n-\r\n         if (id) {\r\n-            getContractById(id).then((data) => {\r\n+            getContractById(id).then((data) =>\r\n                 setContract({\r\n                     loan: data.loan?._id || \"\",\r\n-                    documentUrl: null, // Cannot prefill file input\r\n+                    documentUrl: null,\r\n                     signingDate: data.signingDate ? data.signingDate.slice(0, 10) : \"\",\r\n-                });\r\n-            });\r\n+                })\r\n+            );\r\n         }\r\n     }, [id]);\r\n \r\n     const handleChange = (e) => {\r\n         const { name, value, files } = e.target;\r\n-        if (name === \"document\") setContract({ ...contract, documentUrl: files[0] });\r\n+        if (name === \"documentUrl\") setContract({ ...contract, documentUrl: files[0] });\r\n         else setContract({ ...contract, [name]: value });\r\n     };\r\n \r\n     const handleSubmit = async (e) => {\r\n         e.preventDefault();\r\n-\r\n-        // Build FormData for file upload\r\n         const formData = new FormData();\r\n         formData.append(\"loan\", contract.loan);\r\n         formData.append(\"signingDate\", contract.signingDate);\r\n-        if (contract.documentUrl) formData.append(\"document\", contract.documentUrl); // Only if a new file is selected\r\n+        if (contract.documentUrl) formData.append(\"documentUrl\", contract.documentUrl);\r\n \r\n         try {\r\n             if (id) await updateContract(id, formData);\r\n             else await createContract(formData);\r\n@@ -55,9 +71,8 @@\n     return (\r\n         <div className=\"max-w-md mx-auto\">\r\n             <h1 className=\"text-2xl font-bold mb-6\">{id ? \"Edit\" : \"Add\"} Contract</h1>\r\n             <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n-                {/* Loan */}\r\n                 <div className=\"flex flex-col\">\r\n                     <label className=\"mb-1 font-medium\">Loan</label>\r\n                     <select name=\"loan\" value={contract.loan} onChange={handleChange} className=\"border p-2 rounded\">\r\n                         <option value=\"\">Select Loan</option>\r\n@@ -68,21 +83,18 @@\n                         ))}\r\n                     </select>\r\n                 </div>\r\n \r\n-                {/* Signing Date */}\r\n                 <div className=\"flex flex-col\">\r\n                     <label className=\"mb-1 font-medium\">Signing Date</label>\r\n                     <input type=\"date\" name=\"signingDate\" value={contract.signingDate} onChange={handleChange} className=\"border p-2 rounded\" />\r\n                 </div>\r\n \r\n-                {/* File Upload */}\r\n                 <div className=\"flex flex-col\">\r\n                     <label className=\"mb-1 font-medium\">Contract Document (PDF)</label>\r\n                     <input type=\"file\" name=\"documentUrl\" onChange={handleChange} className=\"border p-2 rounded\" />\r\n                 </div>\r\n \r\n-                {/* Submit */}\r\n                 <div className=\"flex justify-end\">\r\n                     <button type=\"submit\" className=\"bg-gray-500 text-white px-6 py-2 rounded\">\r\n                         {id ? \"Update\" : \"Create\"}\r\n                     </button>\r\n"
                },
                {
                    "date": 1770570237226,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,27 +1,4 @@\n-import axios from \"axios\";\r\n-\r\n-const API_URL = \"http://localhost:5000/contracts\";\r\n-\r\n-// Get all\r\n-export const getContracts = async () => (await axios.get(API_URL)).data;\r\n-\r\n-// Get by ID\r\n-export const getContractById = async (id) => (await axios.get(`${API_URL}/${id}`)).data;\r\n-\r\n-// Get by Loan\r\n-export const getContractsByLoan = async (loanId) => (await axios.get(`${API_URL}/loan/${loanId}`)).data;\r\n-\r\n-// Create\r\n-export const createContract = async (formData) =>\r\n-    (await axios.post(API_URL, formData, { headers: { \"Content-Type\": \"multipart/form-data\" } })).data;\r\n-\r\n-// Update\r\n-export const updateContract = async (id, formData) =>\r\n-    (await axios.put(`${API_URL}/${id}`, formData, { headers: { \"Content-Type\": \"multipart/form-data\" } })).data;\r\n-\r\n-// Delete\r\n-export const deleteContract = async (id) => (await axios.delete(`${API_URL}/${id}`)).data;\r\n import { useState, useEffect } from \"react\";\r\n import { useNavigate, useParams } from \"react-router-dom\";\r\n import { createContract, getContractById, updateContract } from \"../../api/contractApi\";\r\n import { getLoans } from \"../../api/loanApi\";\r\n"
                },
                {
                    "date": 1770571292094,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,26 +10,24 @@\n     const { id } = useParams();\r\n \r\n     useEffect(() => {\r\n         getLoans().then(setLoans);\r\n-        if (id) {\r\n-            getContractById(id).then((data) =>\r\n-                setContract({\r\n-                    loan: data.loan?._id || \"\",\r\n-                    documentUrl: null,\r\n-                    signingDate: data.signingDate ? data.signingDate.slice(0, 10) : \"\",\r\n-                })\r\n-            );\r\n-        }\r\n+        if (id) getContractById(id).then(data => {\r\n+            setContract({\r\n+                loan: data.loan?._id || \"\",\r\n+                documentUrl: null,\r\n+                signingDate: data.signingDate?.slice(0, 10) || \"\",\r\n+            });\r\n+        });\r\n     }, [id]);\r\n \r\n-    const handleChange = (e) => {\r\n+    const handleChange = e => {\r\n         const { name, value, files } = e.target;\r\n         if (name === \"documentUrl\") setContract({ ...contract, documentUrl: files[0] });\r\n         else setContract({ ...contract, [name]: value });\r\n     };\r\n \r\n-    const handleSubmit = async (e) => {\r\n+    const handleSubmit = async e => {\r\n         e.preventDefault();\r\n         const formData = new FormData();\r\n         formData.append(\"loan\", contract.loan);\r\n         formData.append(\"signingDate\", contract.signingDate);\r\n@@ -49,33 +47,26 @@\n         <div className=\"max-w-md mx-auto\">\r\n             <h1 className=\"text-2xl font-bold mb-6\">{id ? \"Edit\" : \"Add\"} Contract</h1>\r\n             <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n                 <div className=\"flex flex-col\">\r\n-                    <label className=\"mb-1 font-medium\">Loan</label>\r\n+                    <label>Loan</label>\r\n                     <select name=\"loan\" value={contract.loan} onChange={handleChange} className=\"border p-2 rounded\">\r\n                         <option value=\"\">Select Loan</option>\r\n-                        {loans.map((l) => (\r\n-                            <option key={l._id} value={l._id}>\r\n-                                {l.borrower?.fullName}-{l.amount}\r\n-                            </option>\r\n+                        {loans.map(l => (\r\n+                            <option key={l._id} value={l._id}>{l.borrower?.fullName}-{l.amount}</option>\r\n                         ))}\r\n                     </select>\r\n                 </div>\r\n-\r\n                 <div className=\"flex flex-col\">\r\n-                    <label className=\"mb-1 font-medium\">Signing Date</label>\r\n+                    <label>Signing Date</label>\r\n                     <input type=\"date\" name=\"signingDate\" value={contract.signingDate} onChange={handleChange} className=\"border p-2 rounded\" />\r\n                 </div>\r\n-\r\n                 <div className=\"flex flex-col\">\r\n-                    <label className=\"mb-1 font-medium\">Contract Document (PDF)</label>\r\n+                    <label>Contract Document</label>\r\n                     <input type=\"file\" name=\"documentUrl\" onChange={handleChange} className=\"border p-2 rounded\" />\r\n                 </div>\r\n-\r\n                 <div className=\"flex justify-end\">\r\n-                    <button type=\"submit\" className=\"bg-gray-500 text-white px-6 py-2 rounded\">\r\n-                        {id ? \"Update\" : \"Create\"}\r\n-                    </button>\r\n+                    <button type=\"submit\" className=\"bg-gray-500 text-white px-6 py-2 rounded\">{id ? \"Update\" : \"Create\"}</button>\r\n                 </div>\r\n             </form>\r\n         </div>\r\n     );\r\n"
                },
                {
                    "date": 1770571657642,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -21,8 +21,9 @@\n     }, [id]);\r\n \r\n     const handleChange = e => {\r\n         const { name, value, files } = e.target;\r\n+        alert(files[0])\r\n         if (name === \"documentUrl\") setContract({ ...contract, documentUrl: files[0] });\r\n         else setContract({ ...contract, [name]: value });\r\n     };\r\n \r\n"
                },
                {
                    "date": 1770571803356,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -21,9 +21,8 @@\n     }, [id]);\r\n \r\n     const handleChange = e => {\r\n         const { name, value, files } = e.target;\r\n-        alert(files[0])\r\n         if (name === \"documentUrl\") setContract({ ...contract, documentUrl: files[0] });\r\n         else setContract({ ...contract, [name]: value });\r\n     };\r\n \r\n@@ -31,8 +30,9 @@\n         e.preventDefault();\r\n         const formData = new FormData();\r\n         formData.append(\"loan\", contract.loan);\r\n         formData.append(\"signingDate\", contract.signingDate);\r\n+        alert(contract.documentUrl);\r\n         if (contract.documentUrl) formData.append(\"documentUrl\", contract.documentUrl);\r\n \r\n         try {\r\n             if (id) await updateContract(id, formData);\r\n"
                },
                {
                    "date": 1770571875314,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,10 +30,10 @@\n         e.preventDefault();\r\n         const formData = new FormData();\r\n         formData.append(\"loan\", contract.loan);\r\n         formData.append(\"signingDate\", contract.signingDate);\r\n-        alert(contract.documentUrl);\r\n-        if (contract.documentUrl) formData.append(\"documentUrl\", contract.documentUrl);\r\n+        \r\n+        if (contract.documentUrl) formData.append(\"document\", contract.documentUrl);\r\n \r\n         try {\r\n             if (id) await updateContract(id, formData);\r\n             else await createContract(formData);\r\n"
                },
                {
                    "date": 1770571915826,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,9 +30,9 @@\n         e.preventDefault();\r\n         const formData = new FormData();\r\n         formData.append(\"loan\", contract.loan);\r\n         formData.append(\"signingDate\", contract.signingDate);\r\n-        \r\n+        alert(contract.documentUrl);\r\n         if (contract.documentUrl) formData.append(\"document\", contract.documentUrl);\r\n \r\n         try {\r\n             if (id) await updateContract(id, formData);\r\n"
                },
                {
                    "date": 1770572012540,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,9 +30,9 @@\n         e.preventDefault();\r\n         const formData = new FormData();\r\n         formData.append(\"loan\", contract.loan);\r\n         formData.append(\"signingDate\", contract.signingDate);\r\n-        alert(contract.documentUrl);\r\n+        alert(contract.documentUrl)\r\n         if (contract.documentUrl) formData.append(\"document\", contract.documentUrl);\r\n \r\n         try {\r\n             if (id) await updateContract(id, formData);\r\n"
                },
                {
                    "date": 1770572386487,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,41 +3,57 @@\n import { createContract, getContractById, updateContract } from \"../../api/contractApi\";\r\n import { getLoans } from \"../../api/loanApi\";\r\n \r\n const ContractForm = () => {\r\n-    const [contract, setContract] = useState({ loan: \"\", documentUrl: null, signingDate: \"\" });\r\n+    const [contract, setContract] = useState({\r\n+        loan: \"\",\r\n+        documentUrl: null, // This is the File object\r\n+        signingDate: \"\",\r\n+    });\r\n     const [loans, setLoans] = useState([]);\r\n     const navigate = useNavigate();\r\n     const { id } = useParams();\r\n \r\n     useEffect(() => {\r\n         getLoans().then(setLoans);\r\n-        if (id) getContractById(id).then(data => {\r\n-            setContract({\r\n-                loan: data.loan?._id || \"\",\r\n-                documentUrl: null,\r\n-                signingDate: data.signingDate?.slice(0, 10) || \"\",\r\n+\r\n+        if (id) {\r\n+            getContractById(id).then((data) => {\r\n+                setContract({\r\n+                    loan: data.loan?._id || \"\",\r\n+                    documentUrl: null, // cannot prefill file input\r\n+                    signingDate: data.signingDate ? data.signingDate.slice(0, 10) : \"\",\r\n+                });\r\n             });\r\n-        });\r\n+        }\r\n     }, [id]);\r\n \r\n-    const handleChange = e => {\r\n+    const handleChange = (e) => {\r\n         const { name, value, files } = e.target;\r\n-        if (name === \"documentUrl\") setContract({ ...contract, documentUrl: files[0] });\r\n-        else setContract({ ...contract, [name]: value });\r\n+        if (name === \"documentUrl\") {\r\n+            setContract({ ...contract, documentUrl: files[0] }); // File object\r\n+        } else {\r\n+            setContract({ ...contract, [name]: value });\r\n+        }\r\n     };\r\n \r\n-    const handleSubmit = async e => {\r\n+    const handleSubmit = async (e) => {\r\n         e.preventDefault();\r\n+\r\n+        if (!contract.loan || !contract.signingDate) {\r\n+            alert(\"Loan and signing date are required!\");\r\n+            return;\r\n+        }\r\n+\r\n         const formData = new FormData();\r\n         formData.append(\"loan\", contract.loan);\r\n         formData.append(\"signingDate\", contract.signingDate);\r\n-        alert(contract.documentUrl)\r\n-        if (contract.documentUrl) formData.append(\"document\", contract.documentUrl);\r\n+        if (contract.documentUrl) formData.append(\"document\", contract.documentUrl); // key = 'document'\r\n \r\n         try {\r\n             if (id) await updateContract(id, formData);\r\n             else await createContract(formData);\r\n+\r\n             navigate(\"/contracts\");\r\n         } catch (err) {\r\n             console.error(err);\r\n             alert(\"Error saving contract\");\r\n@@ -47,27 +63,38 @@\n     return (\r\n         <div className=\"max-w-md mx-auto\">\r\n             <h1 className=\"text-2xl font-bold mb-6\">{id ? \"Edit\" : \"Add\"} Contract</h1>\r\n             <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n+                {/* Loan */}\r\n                 <div className=\"flex flex-col\">\r\n-                    <label>Loan</label>\r\n+                    <label className=\"mb-1 font-medium\">Loan</label>\r\n                     <select name=\"loan\" value={contract.loan} onChange={handleChange} className=\"border p-2 rounded\">\r\n                         <option value=\"\">Select Loan</option>\r\n-                        {loans.map(l => (\r\n-                            <option key={l._id} value={l._id}>{l.borrower?.fullName}-{l.amount}</option>\r\n+                        {loans.map((l) => (\r\n+                            <option key={l._id} value={l._id}>\r\n+                                {l.borrower?.fullName}-{l.amount}\r\n+                            </option>\r\n                         ))}\r\n                     </select>\r\n                 </div>\r\n+\r\n+                {/* Signing Date */}\r\n                 <div className=\"flex flex-col\">\r\n-                    <label>Signing Date</label>\r\n+                    <label className=\"mb-1 font-medium\">Signing Date</label>\r\n                     <input type=\"date\" name=\"signingDate\" value={contract.signingDate} onChange={handleChange} className=\"border p-2 rounded\" />\r\n                 </div>\r\n+\r\n+                {/* File Upload */}\r\n                 <div className=\"flex flex-col\">\r\n-                    <label>Contract Document</label>\r\n+                    <label className=\"mb-1 font-medium\">Contract Document (PDF)</label>\r\n                     <input type=\"file\" name=\"documentUrl\" onChange={handleChange} className=\"border p-2 rounded\" />\r\n                 </div>\r\n+\r\n+                {/* Submit */}\r\n                 <div className=\"flex justify-end\">\r\n-                    <button type=\"submit\" className=\"bg-gray-500 text-white px-6 py-2 rounded\">{id ? \"Update\" : \"Create\"}</button>\r\n+                    <button type=\"submit\" className=\"bg-gray-500 text-white px-6 py-2 rounded\">\r\n+                        {id ? \"Update\" : \"Create\"}\r\n+                    </button>\r\n                 </div>\r\n             </form>\r\n         </div>\r\n     );\r\n"
                },
                {
                    "date": 1770573109238,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,13 +1,15 @@\n-import { useState, useEffect } from \"react\";\r\n+import { useEffect, useState } from \"react\";\r\n import { useNavigate, useParams } from \"react-router-dom\";\r\n import { createContract, getContractById, updateContract } from \"../../api/contractApi\";\r\n import { getLoans } from \"../../api/loanApi\";\r\n+import FileUpload from \"../../components/FileUpload\";\r\n \r\n const ContractForm = () => {\r\n     const [contract, setContract] = useState({\r\n         loan: \"\",\r\n-        documentUrl: null, // This is the File object\r\n+        document: null, // File to upload\r\n+        documentUrl: \"\", // Existing file URL\r\n         signingDate: \"\",\r\n     });\r\n     const [loans, setLoans] = useState([]);\r\n     const navigate = useNavigate();\r\n@@ -19,41 +21,38 @@\n         if (id) {\r\n             getContractById(id).then((data) => {\r\n                 setContract({\r\n                     loan: data.loan?._id || \"\",\r\n-                    documentUrl: null, // cannot prefill file input\r\n+                    document: null, // Cannot prefill file input\r\n+                    documentUrl: data.documentUrl || \"\",\r\n                     signingDate: data.signingDate ? data.signingDate.slice(0, 10) : \"\",\r\n                 });\r\n             });\r\n         }\r\n     }, [id]);\r\n \r\n     const handleChange = (e) => {\r\n-        const { name, value, files } = e.target;\r\n-        if (name === \"documentUrl\") {\r\n-            setContract({ ...contract, documentUrl: files[0] }); // File object\r\n-        } else {\r\n-            setContract({ ...contract, [name]: value });\r\n-        }\r\n+        const { name, value } = e.target;\r\n+        setContract({ ...contract, [name]: value });\r\n     };\r\n \r\n+    const handleFileSelect = (file) => {\r\n+        setContract({ ...contract, document: file });\r\n+    };\r\n+\r\n     const handleSubmit = async (e) => {\r\n         e.preventDefault();\r\n \r\n-        if (!contract.loan || !contract.signingDate) {\r\n-            alert(\"Loan and signing date are required!\");\r\n-            return;\r\n-        }\r\n-\r\n         const formData = new FormData();\r\n         formData.append(\"loan\", contract.loan);\r\n         formData.append(\"signingDate\", contract.signingDate);\r\n-        if (contract.documentUrl) formData.append(\"document\", contract.documentUrl); // key = 'document'\r\n \r\n+        // Append file only if selected\r\n+        if (contract.document) formData.append(\"document\", contract.document);\r\n+\r\n         try {\r\n             if (id) await updateContract(id, formData);\r\n             else await createContract(formData);\r\n-\r\n             navigate(\"/contracts\");\r\n         } catch (err) {\r\n             console.error(err);\r\n             alert(\"Error saving contract\");\r\n@@ -62,13 +61,19 @@\n \r\n     return (\r\n         <div className=\"max-w-md mx-auto\">\r\n             <h1 className=\"text-2xl font-bold mb-6\">{id ? \"Edit\" : \"Add\"} Contract</h1>\r\n+\r\n             <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n                 {/* Loan */}\r\n                 <div className=\"flex flex-col\">\r\n                     <label className=\"mb-1 font-medium\">Loan</label>\r\n-                    <select name=\"loan\" value={contract.loan} onChange={handleChange} className=\"border p-2 rounded\">\r\n+                    <select\r\n+                        name=\"loan\"\r\n+                        value={contract.loan}\r\n+                        onChange={handleChange}\r\n+                        className=\"border p-2 rounded\"\r\n+                    >\r\n                         <option value=\"\">Select Loan</option>\r\n                         {loans.map((l) => (\r\n                             <option key={l._id} value={l._id}>\r\n                                 {l.borrower?.fullName}-{l.amount}\r\n@@ -79,15 +84,24 @@\n \r\n                 {/* Signing Date */}\r\n                 <div className=\"flex flex-col\">\r\n                     <label className=\"mb-1 font-medium\">Signing Date</label>\r\n-                    <input type=\"date\" name=\"signingDate\" value={contract.signingDate} onChange={handleChange} className=\"border p-2 rounded\" />\r\n+                    <input\r\n+                        type=\"date\"\r\n+                        name=\"signingDate\"\r\n+                        value={contract.signingDate}\r\n+                        onChange={handleChange}\r\n+                        className=\"border p-2 rounded\"\r\n+                    />\r\n                 </div>\r\n \r\n                 {/* File Upload */}\r\n                 <div className=\"flex flex-col\">\r\n-                    <label className=\"mb-1 font-medium\">Contract Document (PDF)</label>\r\n-                    <input type=\"file\" name=\"documentUrl\" onChange={handleChange} className=\"border p-2 rounded\" />\r\n+                    <label className=\"mb-1 font-medium\">Contract Document</label>\r\n+                    <FileUpload\r\n+                        onFileSelect={handleFileSelect}\r\n+                        existingFileUrl={contract.documentUrl}\r\n+                    />\r\n                 </div>\r\n \r\n                 {/* Submit */}\r\n                 <div className=\"flex justify-end\">\r\n"
                },
                {
                    "date": 1770573348432,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,117 +1,64 @@\n-import { useEffect, useState } from \"react\";\r\n-import { useNavigate, useParams } from \"react-router-dom\";\r\n-import { createContract, getContractById, updateContract } from \"../../api/contractApi\";\r\n-import { getLoans } from \"../../api/loanApi\";\r\n-import FileUpload from \"../../components/FileUpload\";\r\n+import { useState, useEffect } from \"react\";\r\n \r\n-const ContractForm = () => {\r\n-    const [contract, setContract] = useState({\r\n-        loan: \"\",\r\n-        document: null, // File to upload\r\n-        documentUrl: \"\", // Existing file URL\r\n-        signingDate: \"\",\r\n-    });\r\n-    const [loans, setLoans] = useState([]);\r\n-    const navigate = useNavigate();\r\n-    const { id } = useParams();\r\n+const FileUpload = ({ onFileSelect, existingFileUrl }) => {\r\n+    const [file, setFile] = useState(null);\r\n+    const [fileUrl, setFileUrl] = useState(existingFileUrl || \"\");\r\n \r\n     useEffect(() => {\r\n-        getLoans().then(setLoans);\r\n+        setFileUrl(existingFileUrl || \"\");\r\n+    }, [existingFileUrl]);\r\n \r\n-        if (id) {\r\n-            getContractById(id).then((data) => {\r\n-                setContract({\r\n-                    loan: data.loan?._id || \"\",\r\n-                    document: null, // Cannot prefill file input\r\n-                    documentUrl: data.documentUrl || \"\",\r\n-                    signingDate: data.signingDate ? data.signingDate.slice(0, 10) : \"\",\r\n-                });\r\n-            });\r\n+    const handleFileChange = (e) => {\r\n+        const selectedFile = e.target.files[0];\r\n+        if (selectedFile) {\r\n+            setFile(selectedFile);\r\n+            onFileSelect(selectedFile);\r\n+            setFileUrl(\"\"); // hide existing file when new file is selected\r\n         }\r\n-    }, [id]);\r\n-\r\n-    const handleChange = (e) => {\r\n-        const { name, value } = e.target;\r\n-        setContract({ ...contract, [name]: value });\r\n     };\r\n \r\n-    const handleFileSelect = (file) => {\r\n-        setContract({ ...contract, document: file });\r\n+    const handleRemove = () => {\r\n+        setFile(null);\r\n+        setFileUrl(\"\");\r\n+        onFileSelect(null); // inform parent the file was removed\r\n     };\r\n \r\n-    const handleSubmit = async (e) => {\r\n-        e.preventDefault();\r\n-\r\n-        const formData = new FormData();\r\n-        formData.append(\"loan\", contract.loan);\r\n-        formData.append(\"signingDate\", contract.signingDate);\r\n-\r\n-        // Append file only if selected\r\n-        if (contract.document) formData.append(\"document\", contract.document);\r\n-\r\n-        try {\r\n-            if (id) await updateContract(id, formData);\r\n-            else await createContract(formData);\r\n-            navigate(\"/contracts\");\r\n-        } catch (err) {\r\n-            console.error(err);\r\n-            alert(\"Error saving contract\");\r\n-        }\r\n-    };\r\n-\r\n     return (\r\n-        <div className=\"max-w-md mx-auto\">\r\n-            <h1 className=\"text-2xl font-bold mb-6\">{id ? \"Edit\" : \"Add\"} Contract</h1>\r\n-\r\n-            <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n-                {/* Loan */}\r\n-                <div className=\"flex flex-col\">\r\n-                    <label className=\"mb-1 font-medium\">Loan</label>\r\n-                    <select\r\n-                        name=\"loan\"\r\n-                        value={contract.loan}\r\n-                        onChange={handleChange}\r\n-                        className=\"border p-2 rounded\"\r\n+        <div>\r\n+            {file || fileUrl ? (\r\n+                <div className=\"flex items-center space-x-2\">\r\n+                    <span className=\"text-gray-700\">\r\n+                        {file ? file.name : fileUrl.split(\"/\").pop().replace(\"\\\\\", \"/\")}\r\n+                    </span>\r\n+                    <button\r\n+                        type=\"button\"\r\n+                        onClick={handleRemove}\r\n+                        className=\"bg-red-500 text-white px-2 py-1 rounded\"\r\n                     >\r\n-                        <option value=\"\">Select Loan</option>\r\n-                        {loans.map((l) => (\r\n-                            <option key={l._id} value={l._id}>\r\n-                                {l.borrower?.fullName}-{l.amount}\r\n-                            </option>\r\n-                        ))}\r\n-                    </select>\r\n+                        Remove\r\n+                    </button>\r\n                 </div>\r\n-\r\n-                {/* Signing Date */}\r\n-                <div className=\"flex flex-col\">\r\n-                    <label className=\"mb-1 font-medium\">Signing Date</label>\r\n-                    <input\r\n-                        type=\"date\"\r\n-                        name=\"signingDate\"\r\n-                        value={contract.signingDate}\r\n-                        onChange={handleChange}\r\n-                        className=\"border p-2 rounded\"\r\n-                    />\r\n+            ) : (\r\n+                <input\r\n+                    type=\"file\"\r\n+                    onChange={handleFileChange}\r\n+                    className=\"border p-2 rounded w-full\"\r\n+                />\r\n+            )}\r\n+            {fileUrl && !file && (\r\n+                <div className=\"mt-1\">\r\n+                    <a\r\n+                        href={`http://localhost:5000/${fileUrl.replace(\"\\\\\", \"/\")}`}\r\n+                        target=\"_blank\"\r\n+                        rel=\"noopener noreferrer\"\r\n+                        className=\"text-blue-500 underline\"\r\n+                    >\r\n+                        View existing file\r\n+                    </a>\r\n                 </div>\r\n-\r\n-                {/* File Upload */}\r\n-                <div className=\"flex flex-col\">\r\n-                    <label className=\"mb-1 font-medium\">Contract Document</label>\r\n-                    <FileUpload\r\n-                        onFileSelect={handleFileSelect}\r\n-                        existingFileUrl={contract.documentUrl}\r\n-                    />\r\n-                </div>\r\n-\r\n-                {/* Submit */}\r\n-                <div className=\"flex justify-end\">\r\n-                    <button type=\"submit\" className=\"bg-gray-500 text-white px-6 py-2 rounded\">\r\n-                        {id ? \"Update\" : \"Create\"}\r\n-                    </button>\r\n-                </div>\r\n-            </form>\r\n+            )}\r\n         </div>\r\n     );\r\n };\r\n \r\n-export default ContractForm;\r\n+export default FileUpload;\r\n"
                },
                {
                    "date": 1770574618183,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,64 +1,49 @@\n-import { useState, useEffect } from \"react\";\r\n+import { useState } from \"react\";\r\n+import FileUpload from \"../../components/FileUpload\";\r\n \r\n-const FileUpload = ({ onFileSelect, existingFileUrl }) => {\r\n+const ContractForm = ({ existingContract }) => {\r\n     const [file, setFile] = useState(null);\r\n-    const [fileUrl, setFileUrl] = useState(existingFileUrl || \"\");\r\n+    const [form, setForm] = useState({\r\n+        loan: existingContract?.loan?._id || \"\",\r\n+        signingDate: existingContract?.signingDate || \"\",\r\n+    });\r\n \r\n-    useEffect(() => {\r\n-        setFileUrl(existingFileUrl || \"\");\r\n-    }, [existingFileUrl]);\r\n+    // ðŸ”‘ THIS is what FileUpload needs\r\n+    const handleFileSelect = (selectedFile) => {\r\n+        setFile(selectedFile); // can be null when removed\r\n+    };\r\n \r\n-    const handleFileChange = (e) => {\r\n-        const selectedFile = e.target.files[0];\r\n-        if (selectedFile) {\r\n-            setFile(selectedFile);\r\n-            onFileSelect(selectedFile);\r\n-            setFileUrl(\"\"); // hide existing file when new file is selected\r\n+    const handleSubmit = async (e) => {\r\n+        e.preventDefault();\r\n+\r\n+        const formData = new FormData();\r\n+        formData.append(\"loan\", form.loan);\r\n+        formData.append(\"signingDate\", form.signingDate);\r\n+\r\n+        if (file) {\r\n+            formData.append(\"document\", file);\r\n         }\r\n-    };\r\n \r\n-    const handleRemove = () => {\r\n-        setFile(null);\r\n-        setFileUrl(\"\");\r\n-        onFileSelect(null); // inform parent the file was removed\r\n+        // submit formData to backend\r\n     };\r\n \r\n     return (\r\n-        <div>\r\n-            {file || fileUrl ? (\r\n-                <div className=\"flex items-center space-x-2\">\r\n-                    <span className=\"text-gray-700\">\r\n-                        {file ? file.name : fileUrl.split(\"/\").pop().replace(\"\\\\\", \"/\")}\r\n-                    </span>\r\n-                    <button\r\n-                        type=\"button\"\r\n-                        onClick={handleRemove}\r\n-                        className=\"bg-red-500 text-white px-2 py-1 rounded\"\r\n-                    >\r\n-                        Remove\r\n-                    </button>\r\n-                </div>\r\n-            ) : (\r\n-                <input\r\n-                    type=\"file\"\r\n-                    onChange={handleFileChange}\r\n-                    className=\"border p-2 rounded w-full\"\r\n-                />\r\n-            )}\r\n-            {fileUrl && !file && (\r\n-                <div className=\"mt-1\">\r\n-                    <a\r\n-                        href={`http://localhost:5000/${fileUrl.replace(\"\\\\\", \"/\")}`}\r\n-                        target=\"_blank\"\r\n-                        rel=\"noopener noreferrer\"\r\n-                        className=\"text-blue-500 underline\"\r\n-                    >\r\n-                        View existing file\r\n-                    </a>\r\n-                </div>\r\n-            )}\r\n-        </div>\r\n+        <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n+            {/* other fields */}\r\n+\r\n+            <FileUpload\r\n+                onFileSelect={handleFileSelect}\r\n+                existingFileUrl={existingContract?.documentUrl}\r\n+            />\r\n+\r\n+            <button\r\n+                type=\"submit\"\r\n+                className=\"bg-blue-600 text-white px-4 py-2 rounded\"\r\n+            >\r\n+                Save\r\n+            </button>\r\n+        </form>\r\n     );\r\n };\r\n \r\n-export default FileUpload;\r\n+export default ContractForm;\r\n"
                },
                {
                    "date": 1770574634067,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,49 +1,64 @@\n-import { useState } from \"react\";\r\n-import FileUpload from \"../../components/FileUpload\";\r\n+import { useState, useEffect } from \"react\";\r\n \r\n-const ContractForm = ({ existingContract }) => {\r\n+const FileUpload = ({ onFileSelect, existingFileUrl }) => {\r\n     const [file, setFile] = useState(null);\r\n-    const [form, setForm] = useState({\r\n-        loan: existingContract?.loan?._id || \"\",\r\n-        signingDate: existingContract?.signingDate || \"\",\r\n-    });\r\n+    const [fileUrl, setFileUrl] = useState(existingFileUrl || \"\");\r\n \r\n-    // ðŸ”‘ THIS is what FileUpload needs\r\n-    const handleFileSelect = (selectedFile) => {\r\n-        setFile(selectedFile); // can be null when removed\r\n-    };\r\n+    useEffect(() => {\r\n+        setFileUrl(existingFileUrl || \"\");\r\n+    }, [existingFileUrl]);\r\n \r\n-    const handleSubmit = async (e) => {\r\n-        e.preventDefault();\r\n-\r\n-        const formData = new FormData();\r\n-        formData.append(\"loan\", form.loan);\r\n-        formData.append(\"signingDate\", form.signingDate);\r\n-\r\n-        if (file) {\r\n-            formData.append(\"document\", file);\r\n+    const handleFileChange = (e) => {\r\n+        const selectedFile = e.target.files[0];\r\n+        if (selectedFile) {\r\n+            setFile(selectedFile);\r\n+            onFileSelect(selectedFile);\r\n+            setFileUrl(\"\"); // hide existing file when new file is selected\r\n         }\r\n+    };\r\n \r\n-        // submit formData to backend\r\n+    const handleRemove = () => {\r\n+        setFile(null);\r\n+        setFileUrl(\"\");\r\n+        onFileSelect(null); // inform parent the file was removed\r\n     };\r\n \r\n     return (\r\n-        <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n-            {/* other fields */}\r\n-\r\n-            <FileUpload\r\n-                onFileSelect={handleFileSelect}\r\n-                existingFileUrl={existingContract?.documentUrl}\r\n-            />\r\n-\r\n-            <button\r\n-                type=\"submit\"\r\n-                className=\"bg-blue-600 text-white px-4 py-2 rounded\"\r\n-            >\r\n-                Save\r\n-            </button>\r\n-        </form>\r\n+        <div>\r\n+            {file || fileUrl ? (\r\n+                <div className=\"flex items-center space-x-2\">\r\n+                    <span className=\"text-gray-700\">\r\n+                        {file ? file.name : fileUrl.split(\"/\").pop().replace(\"\\\\\", \"/\")}\r\n+                    </span>\r\n+                    <button\r\n+                        type=\"button\"\r\n+                        onClick={handleRemove}\r\n+                        className=\"bg-red-500 text-white px-2 py-1 rounded\"\r\n+                    >\r\n+                        Remove\r\n+                    </button>\r\n+                </div>\r\n+            ) : (\r\n+                <input\r\n+                    type=\"file\"\r\n+                    onChange={handleFileChange}\r\n+                    className=\"border p-2 rounded w-full\"\r\n+                />\r\n+            )}\r\n+            {fileUrl && !file && (\r\n+                <div className=\"mt-1\">\r\n+                    <a\r\n+                        href={`http://localhost:5000/${fileUrl.replace(\"\\\\\", \"/\")}`}\r\n+                        target=\"_blank\"\r\n+                        rel=\"noopener noreferrer\"\r\n+                        className=\"text-blue-500 underline\"\r\n+                    >\r\n+                        View existing file\r\n+                    </a>\r\n+                </div>\r\n+            )}\r\n+        </div>\r\n     );\r\n };\r\n \r\n-export default ContractForm;\r\n+export default FileUpload;\r\n"
                },
                {
                    "date": 1770574733640,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,64 +1,117 @@\n-import { useState, useEffect } from \"react\";\r\n+import { useEffect, useState } from \"react\";\r\n+import { useNavigate, useParams } from \"react-router-dom\";\r\n+import { createContract, getContractById, updateContract } from \"../../api/contractApi\";\r\n+import { getLoans } from \"../../api/loanApi\";\r\n+import FileUpload from \"../../components/FileUpload\";\r\n \r\n-const FileUpload = ({ onFileSelect, existingFileUrl }) => {\r\n-    const [file, setFile] = useState(null);\r\n-    const [fileUrl, setFileUrl] = useState(existingFileUrl || \"\");\r\n+const ContractForm = () => {\r\n+    const [contract, setContract] = useState({\r\n+        loan: \"\",\r\n+        document: null, // File to upload\r\n+        documentUrl: \"\", // Existing file URL\r\n+        signingDate: \"\",\r\n+    });\r\n+    const [loans, setLoans] = useState([]);\r\n+    const navigate = useNavigate();\r\n+    const { id } = useParams();\r\n \r\n     useEffect(() => {\r\n-        setFileUrl(existingFileUrl || \"\");\r\n-    }, [existingFileUrl]);\r\n+        getLoans().then(setLoans);\r\n \r\n-    const handleFileChange = (e) => {\r\n-        const selectedFile = e.target.files[0];\r\n-        if (selectedFile) {\r\n-            setFile(selectedFile);\r\n-            onFileSelect(selectedFile);\r\n-            setFileUrl(\"\"); // hide existing file when new file is selected\r\n+        if (id) {\r\n+            getContractById(id).then((data) => {\r\n+                setContract({\r\n+                    loan: data.loan?._id || \"\",\r\n+                    document: null, // Cannot prefill file input\r\n+                    documentUrl: data.documentUrl || \"\",\r\n+                    signingDate: data.signingDate ? data.signingDate.slice(0, 10) : \"\",\r\n+                });\r\n+            });\r\n         }\r\n+    }, [id]);\r\n+\r\n+    const handleChange = (e) => {\r\n+        const { name, value } = e.target;\r\n+        setContract({ ...contract, [name]: value });\r\n     };\r\n \r\n-    const handleRemove = () => {\r\n-        setFile(null);\r\n-        setFileUrl(\"\");\r\n-        onFileSelect(null); // inform parent the file was removed\r\n+    const handleFileSelect = (file) => {\r\n+        setContract({ ...contract, document: file });\r\n     };\r\n \r\n+    const handleSubmit = async (e) => {\r\n+        e.preventDefault();\r\n+\r\n+        const formData = new FormData();\r\n+        formData.append(\"loan\", contract.loan);\r\n+        formData.append(\"signingDate\", contract.signingDate);\r\n+\r\n+        // Append file only if selected\r\n+        if (contract.document) formData.append(\"document\", contract.document);\r\n+\r\n+        try {\r\n+            if (id) await updateContract(id, formData);\r\n+            else await createContract(formData);\r\n+            navigate(\"/contracts\");\r\n+        } catch (err) {\r\n+            console.error(err);\r\n+            alert(\"Error saving contract\");\r\n+        }\r\n+    };\r\n+\r\n     return (\r\n-        <div>\r\n-            {file || fileUrl ? (\r\n-                <div className=\"flex items-center space-x-2\">\r\n-                    <span className=\"text-gray-700\">\r\n-                        {file ? file.name : fileUrl.split(\"/\").pop().replace(\"\\\\\", \"/\")}\r\n-                    </span>\r\n-                    <button\r\n-                        type=\"button\"\r\n-                        onClick={handleRemove}\r\n-                        className=\"bg-red-500 text-white px-2 py-1 rounded\"\r\n+        <div className=\"max-w-md mx-auto\">\r\n+            <h1 className=\"text-2xl font-bold mb-6\">{id ? \"Edit\" : \"Add\"} Contract</h1>\r\n+\r\n+            <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n+                {/* Loan */}\r\n+                <div className=\"flex flex-col\">\r\n+                    <label className=\"mb-1 font-medium\">Loan</label>\r\n+                    <select\r\n+                        name=\"loan\"\r\n+                        value={contract.loan}\r\n+                        onChange={handleChange}\r\n+                        className=\"border p-2 rounded\"\r\n                     >\r\n-                        Remove\r\n+                        <option value=\"\">Select Loan</option>\r\n+                        {loans.map((l) => (\r\n+                            <option key={l._id} value={l._id}>\r\n+                                {l.borrower?.fullName}-{l.amount}\r\n+                            </option>\r\n+                        ))}\r\n+                    </select>\r\n+                </div>\r\n+\r\n+                {/* Signing Date */}\r\n+                <div className=\"flex flex-col\">\r\n+                    <label className=\"mb-1 font-medium\">Signing Date</label>\r\n+                    <input\r\n+                        type=\"date\"\r\n+                        name=\"signingDate\"\r\n+                        value={contract.signingDate}\r\n+                        onChange={handleChange}\r\n+                        className=\"border p-2 rounded\"\r\n+                    />\r\n+                </div>\r\n+\r\n+                {/* File Upload */}\r\n+                <div className=\"flex flex-col\">\r\n+                    <label className=\"mb-1 font-medium\">Contract Document</label>\r\n+                    <FileUpload\r\n+                        onFileSelect={handleFileSelect}\r\n+                        existingFileUrl={contract.documentUrl}\r\n+                    />\r\n+                </div>\r\n+\r\n+                {/* Submit */}\r\n+                <div className=\"flex justify-end\">\r\n+                    <button type=\"submit\" className=\"bg-gray-500 text-white px-6 py-2 rounded\">\r\n+                        {id ? \"Update\" : \"Create\"}\r\n                     </button>\r\n                 </div>\r\n-            ) : (\r\n-                <input\r\n-                    type=\"file\"\r\n-                    onChange={handleFileChange}\r\n-                    className=\"border p-2 rounded w-full\"\r\n-                />\r\n-            )}\r\n-            {fileUrl && !file && (\r\n-                <div className=\"mt-1\">\r\n-                    <a\r\n-                        href={`http://localhost:5000/${fileUrl.replace(\"\\\\\", \"/\")}`}\r\n-                        target=\"_blank\"\r\n-                        rel=\"noopener noreferrer\"\r\n-                        className=\"text-blue-500 underline\"\r\n-                    >\r\n-                        View existing file\r\n-                    </a>\r\n-                </div>\r\n-            )}\r\n+            </form>\r\n         </div>\r\n     );\r\n };\r\n \r\n-export default FileUpload;\r\n+export default ContractForm;\r\n"
                },
                {
                    "date": 1770574747433,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,15 +1,13 @@\n-import { useEffect, useState } from \"react\";\r\n+import { useState, useEffect } from \"react\";\r\n import { useNavigate, useParams } from \"react-router-dom\";\r\n import { createContract, getContractById, updateContract } from \"../../api/contractApi\";\r\n import { getLoans } from \"../../api/loanApi\";\r\n-import FileUpload from \"../../components/FileUpload\";\r\n \r\n const ContractForm = () => {\r\n     const [contract, setContract] = useState({\r\n         loan: \"\",\r\n-        document: null, // File to upload\r\n-        documentUrl: \"\", // Existing file URL\r\n+        documentUrl: null, // This is the File object\r\n         signingDate: \"\",\r\n     });\r\n     const [loans, setLoans] = useState([]);\r\n     const navigate = useNavigate();\r\n@@ -21,38 +19,41 @@\n         if (id) {\r\n             getContractById(id).then((data) => {\r\n                 setContract({\r\n                     loan: data.loan?._id || \"\",\r\n-                    document: null, // Cannot prefill file input\r\n-                    documentUrl: data.documentUrl || \"\",\r\n+                    documentUrl: null, // cannot prefill file input\r\n                     signingDate: data.signingDate ? data.signingDate.slice(0, 10) : \"\",\r\n                 });\r\n             });\r\n         }\r\n     }, [id]);\r\n \r\n     const handleChange = (e) => {\r\n-        const { name, value } = e.target;\r\n-        setContract({ ...contract, [name]: value });\r\n+        const { name, value, files } = e.target;\r\n+        if (name === \"documentUrl\") {\r\n+            setContract({ ...contract, documentUrl: files[0] }); // File object\r\n+        } else {\r\n+            setContract({ ...contract, [name]: value });\r\n+        }\r\n     };\r\n \r\n-    const handleFileSelect = (file) => {\r\n-        setContract({ ...contract, document: file });\r\n-    };\r\n-\r\n     const handleSubmit = async (e) => {\r\n         e.preventDefault();\r\n \r\n+        if (!contract.loan || !contract.signingDate) {\r\n+            alert(\"Loan and signing date are required!\");\r\n+            return;\r\n+        }\r\n+\r\n         const formData = new FormData();\r\n         formData.append(\"loan\", contract.loan);\r\n         formData.append(\"signingDate\", contract.signingDate);\r\n+        if (contract.documentUrl) formData.append(\"document\", contract.documentUrl); // key = 'document'\r\n \r\n-        // Append file only if selected\r\n-        if (contract.document) formData.append(\"document\", contract.document);\r\n-\r\n         try {\r\n             if (id) await updateContract(id, formData);\r\n             else await createContract(formData);\r\n+\r\n             navigate(\"/contracts\");\r\n         } catch (err) {\r\n             console.error(err);\r\n             alert(\"Error saving contract\");\r\n@@ -61,19 +62,13 @@\n \r\n     return (\r\n         <div className=\"max-w-md mx-auto\">\r\n             <h1 className=\"text-2xl font-bold mb-6\">{id ? \"Edit\" : \"Add\"} Contract</h1>\r\n-\r\n             <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n                 {/* Loan */}\r\n                 <div className=\"flex flex-col\">\r\n                     <label className=\"mb-1 font-medium\">Loan</label>\r\n-                    <select\r\n-                        name=\"loan\"\r\n-                        value={contract.loan}\r\n-                        onChange={handleChange}\r\n-                        className=\"border p-2 rounded\"\r\n-                    >\r\n+                    <select name=\"loan\" value={contract.loan} onChange={handleChange} className=\"border p-2 rounded\">\r\n                         <option value=\"\">Select Loan</option>\r\n                         {loans.map((l) => (\r\n                             <option key={l._id} value={l._id}>\r\n                                 {l.borrower?.fullName}-{l.amount}\r\n@@ -84,24 +79,15 @@\n \r\n                 {/* Signing Date */}\r\n                 <div className=\"flex flex-col\">\r\n                     <label className=\"mb-1 font-medium\">Signing Date</label>\r\n-                    <input\r\n-                        type=\"date\"\r\n-                        name=\"signingDate\"\r\n-                        value={contract.signingDate}\r\n-                        onChange={handleChange}\r\n-                        className=\"border p-2 rounded\"\r\n-                    />\r\n+                    <input type=\"date\" name=\"signingDate\" value={contract.signingDate} onChange={handleChange} className=\"border p-2 rounded\" />\r\n                 </div>\r\n \r\n                 {/* File Upload */}\r\n                 <div className=\"flex flex-col\">\r\n-                    <label className=\"mb-1 font-medium\">Contract Document</label>\r\n-                    <FileUpload\r\n-                        onFileSelect={handleFileSelect}\r\n-                        existingFileUrl={contract.documentUrl}\r\n-                    />\r\n+                    <label className=\"mb-1 font-medium\">Contract Document (PDF)</label>\r\n+                    <input type=\"file\" name=\"documentUrl\" onChange={handleChange} className=\"border p-2 rounded\" />\r\n                 </div>\r\n \r\n                 {/* Submit */}\r\n                 <div className=\"flex justify-end\">\r\n"
                },
                {
                    "date": 1770574795598,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,13 +1,15 @@\n-import { useState, useEffect } from \"react\";\r\n+import { useEffect, useState } from \"react\";\r\n import { useNavigate, useParams } from \"react-router-dom\";\r\n import { createContract, getContractById, updateContract } from \"../../api/contractApi\";\r\n import { getLoans } from \"../../api/loanApi\";\r\n+import FileUpload from \"../../components/FileUpload\";\r\n \r\n const ContractForm = () => {\r\n     const [contract, setContract] = useState({\r\n         loan: \"\",\r\n-        documentUrl: null, // This is the File object\r\n+        document: null, // File to upload\r\n+        documentUrl: \"\", // Existing file URL\r\n         signingDate: \"\",\r\n     });\r\n     const [loans, setLoans] = useState([]);\r\n     const navigate = useNavigate();\r\n@@ -19,41 +21,38 @@\n         if (id) {\r\n             getContractById(id).then((data) => {\r\n                 setContract({\r\n                     loan: data.loan?._id || \"\",\r\n-                    documentUrl: null, // cannot prefill file input\r\n+                    document: null, // Cannot prefill file input\r\n+                    documentUrl: data.documentUrl || \"\",\r\n                     signingDate: data.signingDate ? data.signingDate.slice(0, 10) : \"\",\r\n                 });\r\n             });\r\n         }\r\n     }, [id]);\r\n \r\n     const handleChange = (e) => {\r\n-        const { name, value, files } = e.target;\r\n-        if (name === \"documentUrl\") {\r\n-            setContract({ ...contract, documentUrl: files[0] }); // File object\r\n-        } else {\r\n-            setContract({ ...contract, [name]: value });\r\n-        }\r\n+        const { name, value } = e.target;\r\n+        setContract({ ...contract, [name]: value });\r\n     };\r\n \r\n+    const handleFileSelect = (file) => {\r\n+        setContract({ ...contract, document: file });\r\n+    };\r\n+\r\n     const handleSubmit = async (e) => {\r\n         e.preventDefault();\r\n \r\n-        if (!contract.loan || !contract.signingDate) {\r\n-            alert(\"Loan and signing date are required!\");\r\n-            return;\r\n-        }\r\n-\r\n         const formData = new FormData();\r\n         formData.append(\"loan\", contract.loan);\r\n         formData.append(\"signingDate\", contract.signingDate);\r\n-        if (contract.documentUrl) formData.append(\"document\", contract.documentUrl); // key = 'document'\r\n \r\n+        // Append file only if selected\r\n+        if (contract.document) formData.append(\"document\", contract.document);\r\n+\r\n         try {\r\n             if (id) await updateContract(id, formData);\r\n             else await createContract(formData);\r\n-\r\n             navigate(\"/contracts\");\r\n         } catch (err) {\r\n             console.error(err);\r\n             alert(\"Error saving contract\");\r\n@@ -62,13 +61,19 @@\n \r\n     return (\r\n         <div className=\"max-w-md mx-auto\">\r\n             <h1 className=\"text-2xl font-bold mb-6\">{id ? \"Edit\" : \"Add\"} Contract</h1>\r\n+\r\n             <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n                 {/* Loan */}\r\n                 <div className=\"flex flex-col\">\r\n                     <label className=\"mb-1 font-medium\">Loan</label>\r\n-                    <select name=\"loan\" value={contract.loan} onChange={handleChange} className=\"border p-2 rounded\">\r\n+                    <select\r\n+                        name=\"loan\"\r\n+                        value={contract.loan}\r\n+                        onChange={handleChange}\r\n+                        className=\"border p-2 rounded\"\r\n+                    >\r\n                         <option value=\"\">Select Loan</option>\r\n                         {loans.map((l) => (\r\n                             <option key={l._id} value={l._id}>\r\n                                 {l.borrower?.fullName}-{l.amount}\r\n@@ -79,15 +84,24 @@\n \r\n                 {/* Signing Date */}\r\n                 <div className=\"flex flex-col\">\r\n                     <label className=\"mb-1 font-medium\">Signing Date</label>\r\n-                    <input type=\"date\" name=\"signingDate\" value={contract.signingDate} onChange={handleChange} className=\"border p-2 rounded\" />\r\n+                    <input\r\n+                        type=\"date\"\r\n+                        name=\"signingDate\"\r\n+                        value={contract.signingDate}\r\n+                        onChange={handleChange}\r\n+                        className=\"border p-2 rounded\"\r\n+                    />\r\n                 </div>\r\n \r\n                 {/* File Upload */}\r\n                 <div className=\"flex flex-col\">\r\n-                    <label className=\"mb-1 font-medium\">Contract Document (PDF)</label>\r\n-                    <input type=\"file\" name=\"documentUrl\" onChange={handleChange} className=\"border p-2 rounded\" />\r\n+                    <label className=\"mb-1 font-medium\">Contract Document</label>\r\n+                    <FileUpload\r\n+                        onFileSelect={handleFileSelect}\r\n+                        existingFileUrl={contract.documentUrl}\r\n+                    />\r\n                 </div>\r\n \r\n                 {/* Submit */}\r\n                 <div className=\"flex justify-end\">\r\n"
                },
                {
                    "date": 1770576051666,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,8 +2,9 @@\n import { useNavigate, useParams } from \"react-router-dom\";\r\n import { createContract, getContractById, updateContract } from \"../../api/contractApi\";\r\n import { getLoans } from \"../../api/loanApi\";\r\n import FileUpload from \"../../components/FileUpload\";\r\n+import PageToolbar from \"../../components/PageToolbar\";\r\n \r\n const ContractForm = () => {\r\n     const [contract, setContract] = useState({\r\n         loan: \"\",\r\n@@ -60,10 +61,9 @@\n     };\r\n \r\n     return (\r\n         <div className=\"max-w-md mx-auto\">\r\n-            <h1 className=\"text-2xl font-bold mb-6\">{id ? \"Edit\" : \"Add\"} Contract</h1>\r\n-\r\n+            <PageToolbar title={id ? \"Edit Contract\" : \"Add Contract\"} />\r\n             <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n                 {/* Loan */}\r\n                 <div className=\"flex flex-col\">\r\n                     <label className=\"mb-1 font-medium\">Loan</label>\r\n"
                },
                {
                    "date": 1770577730556,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -60,58 +60,60 @@\n         }\r\n     };\r\n \r\n     return (\r\n-        <div className=\"max-w-md mx-auto\">\r\n+        <>\r\n             <PageToolbar title={id ? \"Edit Contract\" : \"Add Contract\"} />\r\n-            <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n-                {/* Loan */}\r\n-                <div className=\"flex flex-col\">\r\n-                    <label className=\"mb-1 font-medium\">Loan</label>\r\n-                    <select\r\n-                        name=\"loan\"\r\n-                        value={contract.loan}\r\n-                        onChange={handleChange}\r\n-                        className=\"border p-2 rounded\"\r\n-                    >\r\n-                        <option value=\"\">Select Loan</option>\r\n-                        {loans.map((l) => (\r\n-                            <option key={l._id} value={l._id}>\r\n-                                {l.borrower?.fullName}-{l.amount}\r\n-                            </option>\r\n-                        ))}\r\n-                    </select>\r\n-                </div>\r\n+            <div className=\"max-w-md mx-auto\">\r\n+                <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n+                    {/* Loan */}\r\n+                    <div className=\"flex flex-col\">\r\n+                        <label className=\"mb-1 font-medium\">Loan</label>\r\n+                        <select\r\n+                            name=\"loan\"\r\n+                            value={contract.loan}\r\n+                            onChange={handleChange}\r\n+                            className=\"border p-2 rounded\"\r\n+                        >\r\n+                            <option value=\"\">Select Loan</option>\r\n+                            {loans.map((l) => (\r\n+                                <option key={l._id} value={l._id}>\r\n+                                    {l.borrower?.fullName}-{l.amount}\r\n+                                </option>\r\n+                            ))}\r\n+                        </select>\r\n+                    </div>\r\n \r\n-                {/* Signing Date */}\r\n-                <div className=\"flex flex-col\">\r\n-                    <label className=\"mb-1 font-medium\">Signing Date</label>\r\n-                    <input\r\n-                        type=\"date\"\r\n-                        name=\"signingDate\"\r\n-                        value={contract.signingDate}\r\n-                        onChange={handleChange}\r\n-                        className=\"border p-2 rounded\"\r\n-                    />\r\n-                </div>\r\n+                    {/* Signing Date */}\r\n+                    <div className=\"flex flex-col\">\r\n+                        <label className=\"mb-1 font-medium\">Signing Date</label>\r\n+                        <input\r\n+                            type=\"date\"\r\n+                            name=\"signingDate\"\r\n+                            value={contract.signingDate}\r\n+                            onChange={handleChange}\r\n+                            className=\"border p-2 rounded\"\r\n+                        />\r\n+                    </div>\r\n \r\n-                {/* File Upload */}\r\n-                <div className=\"flex flex-col\">\r\n-                    <label className=\"mb-1 font-medium\">Contract Document</label>\r\n-                    <FileUpload\r\n-                        onFileSelect={handleFileSelect}\r\n-                        existingFileUrl={contract.documentUrl}\r\n-                    />\r\n-                </div>\r\n+                    {/* File Upload */}\r\n+                    <div className=\"flex flex-col\">\r\n+                        <label className=\"mb-1 font-medium\">Contract Document</label>\r\n+                        <FileUpload\r\n+                            onFileSelect={handleFileSelect}\r\n+                            existingFileUrl={contract.documentUrl}\r\n+                        />\r\n+                    </div>\r\n \r\n-                {/* Submit */}\r\n-                <div className=\"flex justify-end\">\r\n-                    <button type=\"submit\" className=\"bg-gray-500 text-white px-6 py-2 rounded\">\r\n-                        {id ? \"Update\" : \"Create\"}\r\n-                    </button>\r\n-                </div>\r\n-            </form>\r\n-        </div>\r\n+                    {/* Submit */}\r\n+                    <div className=\"flex justify-end\">\r\n+                        <button type=\"submit\" className=\"bg-gray-500 text-white px-6 py-2 rounded\">\r\n+                            {id ? \"Update\" : \"Create\"}\r\n+                        </button>\r\n+                    </div>\r\n+                </form>\r\n+            </div>\r\n+        </>\r\n     );\r\n };\r\n \r\n export default ContractForm;\r\n"
                },
                {
                    "date": 1770577889124,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -102,12 +102,12 @@\n                             onFileSelect={handleFileSelect}\r\n                             existingFileUrl={contract.documentUrl}\r\n                         />\r\n                     </div>\r\n-\r\n+      \r\n                     {/* Submit */}\r\n                     <div className=\"flex justify-end\">\r\n-                        <button type=\"submit\" className=\"bg-gray-500 text-white px-6 py-2 rounded\">\r\n+                        <button type=\"submit\" className=\"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600\">\r\n                             {id ? \"Update\" : \"Create\"}\r\n                         </button>\r\n                     </div>\r\n                 </form>\r\n"
                },
                {
                    "date": 1770581848892,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,8 +3,9 @@\n import { createContract, getContractById, updateContract } from \"../../api/contractApi\";\r\n import { getLoans } from \"../../api/loanApi\";\r\n import FileUpload from \"../../components/FileUpload\";\r\n import PageToolbar from \"../../components/PageToolbar\";\r\n+import FormRow from \"../../components/FormRow\"; // <- import FormRow\r\n \r\n const ContractForm = () => {\r\n     const [contract, setContract] = useState({\r\n         loan: \"\",\r\n@@ -22,9 +23,9 @@\n         if (id) {\r\n             getContractById(id).then((data) => {\r\n                 setContract({\r\n                     loan: data.loan?._id || \"\",\r\n-                    document: null, // Cannot prefill file input\r\n+                    document: null,\r\n                     documentUrl: data.documentUrl || \"\",\r\n                     signingDate: data.signingDate ? data.signingDate.slice(0, 10) : \"\",\r\n                 });\r\n             });\r\n@@ -45,10 +46,8 @@\n \r\n         const formData = new FormData();\r\n         formData.append(\"loan\", contract.loan);\r\n         formData.append(\"signingDate\", contract.signingDate);\r\n-\r\n-        // Append file only if selected\r\n         if (contract.document) formData.append(\"document\", contract.document);\r\n \r\n         try {\r\n             if (id) await updateContract(id, formData);\r\n@@ -64,53 +63,55 @@\n         <>\r\n             <PageToolbar title={id ? \"Edit Contract\" : \"Add Contract\"} />\r\n             <div className=\"max-w-md mx-auto\">\r\n                 <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n-                    {/* Loan */}\r\n-                    <div className=\"flex flex-col\">\r\n-                        <label className=\"mb-1 font-medium\">Loan</label>\r\n+\r\n+                    {/* Loan Select */}\r\n+                    <FormRow label=\"Loan\">\r\n                         <select\r\n                             name=\"loan\"\r\n                             value={contract.loan}\r\n                             onChange={handleChange}\r\n-                            className=\"border p-2 rounded\"\r\n+                            className=\"border p-2 rounded w-full\"\r\n                         >\r\n                             <option value=\"\">Select Loan</option>\r\n                             {loans.map((l) => (\r\n                                 <option key={l._id} value={l._id}>\r\n                                     {l.borrower?.fullName}-{l.amount}\r\n                                 </option>\r\n                             ))}\r\n                         </select>\r\n-                    </div>\r\n+                    </FormRow>\r\n \r\n                     {/* Signing Date */}\r\n-                    <div className=\"flex flex-col\">\r\n-                        <label className=\"mb-1 font-medium\">Signing Date</label>\r\n+                    <FormRow label=\"Signing Date\">\r\n                         <input\r\n                             type=\"date\"\r\n                             name=\"signingDate\"\r\n                             value={contract.signingDate}\r\n                             onChange={handleChange}\r\n-                            className=\"border p-2 rounded\"\r\n+                            className=\"border p-2 rounded w-full\"\r\n                         />\r\n-                    </div>\r\n+                    </FormRow>\r\n \r\n-                    {/* File Upload */}\r\n-                    <div className=\"flex flex-col\">\r\n-                        <label className=\"mb-1 font-medium\">Contract Document</label>\r\n+                    {/* Contract Document */}\r\n+                    <FormRow label=\"Contract Document\">\r\n                         <FileUpload\r\n                             onFileSelect={handleFileSelect}\r\n                             existingFileUrl={contract.documentUrl}\r\n                         />\r\n-                    </div>\r\n-      \r\n-                    {/* Submit */}\r\n+                    </FormRow>\r\n+\r\n+                    {/* Submit Button */}\r\n                     <div className=\"flex justify-end\">\r\n-                        <button type=\"submit\" className=\"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600\">\r\n+                        <button\r\n+                            type=\"submit\"\r\n+                            className=\"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600\"\r\n+                        >\r\n                             {id ? \"Update\" : \"Create\"}\r\n                         </button>\r\n                     </div>\r\n+\r\n                 </form>\r\n             </div>\r\n         </>\r\n     );\r\n"
                }
            ],
            "date": 1770568590585,
            "name": "Commit-0",
            "content": "import { useState, useEffect } from \"react\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport { createContract, getContractById, updateContract } from \"../../api/contractApi\";\r\nimport { getLoans } from \"../../api/loanApi\";\r\n\r\nconst ContractForm = () => {\r\n    const [contract, setContract] = useState({\r\n        loan: \"\",\r\n        document: null,\r\n        signingDate: \"\",\r\n    });\r\n    const [loans, setLoans] = useState([]);\r\n    const navigate = useNavigate();\r\n    const { id } = useParams();\r\n\r\n    useEffect(() => {\r\n        getLoans().then(setLoans);\r\n\r\n        if (id) {\r\n            getContractById(id).then((data) => {\r\n                setContract({\r\n                    loan: data.loan?._id || \"\",\r\n                    document: null, // file input can't be prefilled\r\n                    signingDate: data.signingDate ? data.signingDate.slice(0, 10) : \"\",\r\n                });\r\n            });\r\n        }\r\n    }, [id]);\r\n\r\n    const handleChange = (e) => {\r\n        const { name, value, files } = e.target;\r\n        if (name === \"document\") setContract({ ...contract, document: files[0] });\r\n        else setContract({ ...contract, [name]: value });\r\n    };\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        const formData = new FormData();\r\n        formData.append(\"loan\", contract.loan);\r\n        formData.append(\"signingDate\", contract.signingDate);\r\n        if (contract.document) formData.append(\"document\", contract.document);\r\n\r\n        try {\r\n            if (id) await updateContract(id, formData);\r\n            else await createContract(formData);\r\n            navigate(\"/contracts\");\r\n        } catch (err) {\r\n            console.error(err);\r\n            alert(\"Error saving contract\");\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"max-w-md mx-auto\">\r\n            <h1 className=\"text-2xl font-bold mb-6\">{id ? \"Edit\" : \"Add\"} Contract</h1>\r\n            <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n                {/* Loan */}\r\n                <div className=\"flex flex-col\">\r\n                    <label className=\"mb-1 font-medium\">Loan</label>\r\n                    <select name=\"loan\" value={contract.loan} onChange={handleChange} className=\"border p-2 rounded\">\r\n                        <option value=\"\">Select Loan</option>\r\n                        {loans.map((l) => (\r\n                            <option key={l._id} value={l._id}>\r\n                                {l.borrower?.fullName}-{l.amount}\r\n                            </option>\r\n                        ))}\r\n                    </select>\r\n                </div>\r\n\r\n                {/* Signing Date */}\r\n                <div className=\"flex flex-col\">\r\n                    <label className=\"mb-1 font-medium\">Signing Date</label>\r\n                    <input\r\n                        type=\"date\"\r\n                        name=\"signingDate\"\r\n                        value={contract.signingDate}\r\n                        onChange={handleChange}\r\n                        className=\"border p-2 rounded\"\r\n                    />\r\n                </div>\r\n\r\n                {/* Document */}\r\n                <div className=\"flex flex-col\">\r\n                    <label className=\"mb-1 font-medium\">Contract Document (PDF)</label>\r\n                    <input type=\"file\" name=\"document\" onChange={handleChange} className=\"border p-2 rounded\" />\r\n                </div>\r\n\r\n                {/* Submit */}\r\n                <div className=\"flex justify-end\">\r\n                    <button type=\"submit\" className=\"bg-gray-500 text-white px-6 py-2 rounded\">\r\n                        {id ? \"Update\" : \"Create\"}\r\n                    </button>\r\n                </div>\r\n            </form>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ContractForm;\r\n"
        }
    ]
}