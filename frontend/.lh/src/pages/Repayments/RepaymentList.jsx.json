{
    "sourceFile": "src/pages/Repayments/RepaymentList.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 9,
            "patches": [
                {
                    "date": 1770563271670,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1770564087399,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,44 +1,77 @@\n-import { useEffect, useState } from \"react\";\r\n+import { useState, useEffect } from \"react\";\r\n+import { Link } from \"react-router-dom\";\r\n import { getRepayments, deleteRepayment } from \"../../api/repaymentApi\";\r\n-import { Link } from \"react-router-dom\";\r\n \r\n const RepaymentList = () => {\r\n     const [repayments, setRepayments] = useState([]);\r\n \r\n-    const fetchRepayments = async () => setRepayments(await getRepayments());\r\n-    const handleDelete = async (id) => { await deleteRepayment(id); fetchRepayments(); };\r\n+    const fetchRepayments = async () => {\r\n+        const data = await getRepayments();\r\n+        setRepayments(data);\r\n+    };\r\n \r\n-    useEffect(() => { fetchRepayments(); }, []);\r\n+    useEffect(() => {\r\n+        fetchRepayments();\r\n+    }, []);\r\n \r\n+    const handleDelete = async (id) => {\r\n+        if (window.confirm(\"Are you sure you want to delete this repayment?\")) {\r\n+            await deleteRepayment(id);\r\n+            fetchRepayments();\r\n+        }\r\n+    };\r\n+\r\n     return (\r\n-        <div>\r\n+        <div className=\"max-w-4xl mx-auto\">\r\n             <h1 className=\"text-2xl font-bold mb-4\">Repayments</h1>\r\n-            <Link to=\"/repayments/new\" className=\"bg-gray-500 text-white px-4 py-2 rounded mb-4 inline-block\">Add Repayment</Link>\r\n-            <table className=\"min-w-full bg-white border\">\r\n+            <Link\r\n+                to=\"/repayments/new\"\r\n+                className=\"inline-block mb-4 bg-blue-500 text-white px-4 py-2 rounded\"\r\n+            >\r\n+                Add Repayment\r\n+            </Link>\r\n+\r\n+            <table className=\"w-full border border-gray-300\">\r\n                 <thead>\r\n-                    <tr>\r\n-                        <th className=\"py-2 px-4 border\">Payment ID</th>\r\n-                        <th className=\"py-2 px-4 border\">Loan</th>\r\n-                        <th className=\"py-2 px-4 border\">Payment Date</th>\r\n-                        <th className=\"py-2 px-4 border\">Amount Paid</th>\r\n-                        <th className=\"py-2 px-4 border\">Remaining Balance</th>\r\n-                        <th className=\"py-2 px-4 border\">Actions</th>\r\n+                    <tr className=\"bg-gray-100 border-b border-gray-300\">\r\n+                        <th className=\"p-2 text-left\">Loan ID</th>\r\n+                        <th className=\"p-2 text-left\">Payment Date</th>\r\n+                        <th className=\"p-2 text-left\">Amount</th>\r\n+                        <th className=\"p-2 text-left\">Term</th>\r\n+                        <th className=\"p-2 text-left\">Actions</th>\r\n                     </tr>\r\n                 </thead>\r\n                 <tbody>\r\n-                    {repayments.map(r => (\r\n-                        <tr key={r._id}>\r\n-                            <td className=\"py-2 px-4 border\">{r._id}</td>\r\n-                            <td className=\"py-2 px-4 border\">{r.loan?.amount || r.loan}</td>\r\n-                            <td className=\"py-2 px-4 border\">{new Date(r.paymentDate).toLocaleDateString()}</td>\r\n-                            <td className=\"py-2 px-4 border\">{r.amountPaid}</td>\r\n-                            <td className=\"py-2 px-4 border\">{r.remainingBalance}</td>\r\n-                            <td className=\"py-2 px-4 border\">\r\n-                                <button onClick={() => handleDelete(r._id)} className=\"text-red-500\">Delete</button>\r\n+                    {repayments.map((r) => (\r\n+                        <tr key={r._id} className=\"border-b border-gray-300 hover:bg-gray-50\">\r\n+                            <td className=\"p-2\">{r.loan?._id}</td>\r\n+                            <td className=\"p-2\">{r.paymentDate ? r.paymentDate.slice(0, 10) : \"\"}</td>\r\n+                            <td className=\"p-2\">{r.amount}</td>\r\n+                            <td className=\"p-2\">{r.term}</td>\r\n+                            <td className=\"p-2 space-x-2\">\r\n+                                <Link\r\n+                                    to={`/repayments/edit/${r._id}`}\r\n+                                    className=\"text-blue-500 hover:underline\"\r\n+                                >\r\n+                                    Edit\r\n+                                </Link>\r\n+                                <button\r\n+                                    onClick={() => handleDelete(r._id)}\r\n+                                    className=\"text-red-500 hover:underline\"\r\n+                                >\r\n+                                    Delete\r\n+                                </button>\r\n                             </td>\r\n                         </tr>\r\n                     ))}\r\n+                    {repayments.length === 0 && (\r\n+                        <tr>\r\n+                            <td colSpan=\"5\" className=\"p-2 text-center text-gray-500\">\r\n+                                No repayments found.\r\n+                            </td>\r\n+                        </tr>\r\n+                    )}\r\n                 </tbody>\r\n             </table>\r\n         </div>\r\n     );\r\n"
                },
                {
                    "date": 1770564189181,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,77 +1,51 @@\n-import { useState, useEffect } from \"react\";\r\n+import { useEffect, useState } from \"react\";\r\n+import { getRepayments, deleteRepayment } from \"../../api/repaymentApi\";\r\n import { Link } from \"react-router-dom\";\r\n-import { getRepayments, deleteRepayment } from \"../../api/repaymentApi\";\r\n \r\n const RepaymentList = () => {\r\n     const [repayments, setRepayments] = useState([]);\r\n \r\n-    const fetchRepayments = async () => {\r\n-        const data = await getRepayments();\r\n-        setRepayments(data);\r\n-    };\r\n+    const fetchRepayments = async () => setRepayments(await getRepayments());\r\n \r\n-    useEffect(() => {\r\n-        fetchRepayments();\r\n-    }, []);\r\n-\r\n     const handleDelete = async (id) => {\r\n         if (window.confirm(\"Are you sure you want to delete this repayment?\")) {\r\n             await deleteRepayment(id);\r\n             fetchRepayments();\r\n         }\r\n     };\r\n \r\n+    useEffect(() => { fetchRepayments(); }, []);\r\n+\r\n     return (\r\n-        <div className=\"max-w-4xl mx-auto\">\r\n+        <div>\r\n             <h1 className=\"text-2xl font-bold mb-4\">Repayments</h1>\r\n-            <Link\r\n-                to=\"/repayments/new\"\r\n-                className=\"inline-block mb-4 bg-blue-500 text-white px-4 py-2 rounded\"\r\n-            >\r\n-                Add Repayment\r\n-            </Link>\r\n-\r\n-            <table className=\"w-full border border-gray-300\">\r\n+            <Link to=\"/repayments/new\" className=\"bg-gray-500 text-white px-4 py-2 rounded mb-4 inline-block\">Add Repayment</Link>\r\n+            <table className=\"min-w-full bg-white border\">\r\n                 <thead>\r\n-                    <tr className=\"bg-gray-100 border-b border-gray-300\">\r\n-                        <th className=\"p-2 text-left\">Loan ID</th>\r\n-                        <th className=\"p-2 text-left\">Payment Date</th>\r\n-                        <th className=\"p-2 text-left\">Amount</th>\r\n-                        <th className=\"p-2 text-left\">Term</th>\r\n-                        <th className=\"p-2 text-left\">Actions</th>\r\n+                    <tr>\r\n+                        <th className=\"py-2 px-4 border\">Repayment ID</th>\r\n+                        <th className=\"py-2 px-4 border\">Loan ID</th>\r\n+                        <th className=\"py-2 px-4 border\">Payment Date</th>\r\n+                        <th className=\"py-2 px-4 border\">Amount</th>\r\n+                        <th className=\"py-2 px-4 border\">Term</th>\r\n+                        <th className=\"py-2 px-4 border\">Actions</th>\r\n                     </tr>\r\n                 </thead>\r\n                 <tbody>\r\n-                    {repayments.map((r) => (\r\n-                        <tr key={r._id} className=\"border-b border-gray-300 hover:bg-gray-50\">\r\n-                            <td className=\"p-2\">{r.loan?._id}</td>\r\n-                            <td className=\"p-2\">{r.paymentDate ? r.paymentDate.slice(0, 10) : \"\"}</td>\r\n-                            <td className=\"p-2\">{r.amount}</td>\r\n-                            <td className=\"p-2\">{r.term}</td>\r\n-                            <td className=\"p-2 space-x-2\">\r\n-                                <Link\r\n-                                    to={`/repayments/edit/${r._id}`}\r\n-                                    className=\"text-blue-500 hover:underline\"\r\n-                                >\r\n-                                    Edit\r\n-                                </Link>\r\n-                                <button\r\n-                                    onClick={() => handleDelete(r._id)}\r\n-                                    className=\"text-red-500 hover:underline\"\r\n-                                >\r\n-                                    Delete\r\n-                                </button>\r\n+                    {repayments.map(r => (\r\n+                        <tr key={r._id}>\r\n+                            <td className=\"py-2 px-4 border\">{r._id}</td>\r\n+                            <td className=\"py-2 px-4 border\">{r.loan?._id || r.loan}</td>\r\n+                            <td className=\"py-2 px-4 border\">{r.paymentDate ? r.paymentDate.slice(0, 10) : \"\"}</td>\r\n+                            <td className=\"py-2 px-4 border\">{r.amount}</td>\r\n+                            <td className=\"py-2 px-4 border\">{r.term}</td>\r\n+                            <td className=\"py-2 px-4 border\">\r\n+                                <Link to={`/repayments/edit/${r._id}`} className=\"text-blue-500 mr-2\">Edit</Link>\r\n+                                <button onClick={() => handleDelete(r._id)} className=\"text-red-500\">Delete</button>\r\n                             </td>\r\n                         </tr>\r\n                     ))}\r\n-                    {repayments.length === 0 && (\r\n-                        <tr>\r\n-                            <td colSpan=\"5\" className=\"p-2 text-center text-gray-500\">\r\n-                                No repayments found.\r\n-                            </td>\r\n-                        </tr>\r\n-                    )}\r\n                 </tbody>\r\n             </table>\r\n         </div>\r\n     );\r\n"
                },
                {
                    "date": 1770564946562,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,39 +13,64 @@\n             fetchRepayments();\r\n         }\r\n     };\r\n \r\n-    useEffect(() => { fetchRepayments(); }, []);\r\n+    useEffect(() => {\r\n+        fetchRepayments();\r\n+    }, []);\r\n \r\n     return (\r\n         <div>\r\n             <h1 className=\"text-2xl font-bold mb-4\">Repayments</h1>\r\n-            <Link to=\"/repayments/new\" className=\"bg-gray-500 text-white px-4 py-2 rounded mb-4 inline-block\">Add Repayment</Link>\r\n+            <Link\r\n+                to=\"/repayments/new\"\r\n+                className=\"bg-gray-500 text-white px-4 py-2 rounded mb-4 inline-block\"\r\n+            >\r\n+                Add Repayment\r\n+            </Link>\r\n             <table className=\"min-w-full bg-white border\">\r\n                 <thead>\r\n                     <tr>\r\n-                        <th className=\"py-2 px-4 border\">Repayment ID</th>\r\n-                        <th className=\"py-2 px-4 border\">Loan ID</th>\r\n+                        <th className=\"py-2 px-4 border\">Borrower</th>\r\n                         <th className=\"py-2 px-4 border\">Payment Date</th>\r\n-                        <th className=\"py-2 px-4 border\">Amount</th>\r\n-                        <th className=\"py-2 px-4 border\">Term</th>\r\n+                        <th className=\"py-2 px-4 border\">Amount Paid</th>\r\n+                        <th className=\"py-2 px-4 border\">Payment Term</th>\r\n+                        <th className=\"py-2 px-4 border\">Description</th>\r\n                         <th className=\"py-2 px-4 border\">Actions</th>\r\n                     </tr>\r\n                 </thead>\r\n                 <tbody>\r\n-                    {repayments.map(r => (\r\n-                        <tr key={r._id}>\r\n-                            <td className=\"py-2 px-4 border\">{r._id}</td>\r\n-                            <td className=\"py-2 px-4 border\">{r.loan?._id || r.loan}</td>\r\n-                            <td className=\"py-2 px-4 border\">{r.paymentDate ? r.paymentDate.slice(0, 10) : \"\"}</td>\r\n-                            <td className=\"py-2 px-4 border\">{r.amount}</td>\r\n-                            <td className=\"py-2 px-4 border\">{r.term}</td>\r\n-                            <td className=\"py-2 px-4 border\">\r\n-                                <Link to={`/repayments/edit/${r._id}`} className=\"text-blue-500 mr-2\">Edit</Link>\r\n-                                <button onClick={() => handleDelete(r._id)} className=\"text-red-500\">Delete</button>\r\n+                    {repayments.length > 0 ? (\r\n+                        repayments.map((r) => (\r\n+                            <tr key={r._id}>\r\n+                                <td className=\"py-2 px-4 border\">{r.loan?.borrower?.fullName || \"Unknown\"}</td>\r\n+                                <td className=\"py-2 px-4 border\">{r.paymentDate ? r.paymentDate.slice(0, 10) : \"\"}</td>\r\n+                                <td className=\"py-2 px-4 border\">{r.amountPaid}</td>\r\n+                                <td className=\"py-2 px-4 border\">{r.paymentTerm} months</td>\r\n+                                <td className=\"py-2 px-4 border\">{r.description || \"-\"}</td>\r\n+                                <td className=\"py-2 px-4 border\">\r\n+                                    <Link\r\n+                                        to={`/repayments/edit/${r._id}`}\r\n+                                        className=\"text-blue-500 mr-2\"\r\n+                                    >\r\n+                                        Edit\r\n+                                    </Link>\r\n+                                    <button\r\n+                                        onClick={() => handleDelete(r._id)}\r\n+                                        className=\"text-red-500\"\r\n+                                    >\r\n+                                        Delete\r\n+                                    </button>\r\n+                                </td>\r\n+                            </tr>\r\n+                        ))\r\n+                    ) : (\r\n+                        <tr>\r\n+                            <td colSpan=\"6\" className=\"py-2 px-4 text-center text-gray-500\">\r\n+                                No repayments found.\r\n                             </td>\r\n                         </tr>\r\n-                    ))}\r\n+                    )}\r\n                 </tbody>\r\n             </table>\r\n         </div>\r\n     );\r\n"
                },
                {
                    "date": 1770565082392,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,8 +34,9 @@\n                         <th className=\"py-2 px-4 border\">Payment Date</th>\r\n                         <th className=\"py-2 px-4 border\">Amount Paid</th>\r\n                         <th className=\"py-2 px-4 border\">Payment Term</th>\r\n                         <th className=\"py-2 px-4 border\">Description</th>\r\n+                        <th className=\"py-2 px-4 border\">Remaining Balance</th>\r\n                         <th className=\"py-2 px-4 border\">Actions</th>\r\n                     </tr>\r\n                 </thead>\r\n                 <tbody>\r\n@@ -45,8 +46,9 @@\n                                 <td className=\"py-2 px-4 border\">{r.loan?.borrower?.fullName || \"Unknown\"}</td>\r\n                                 <td className=\"py-2 px-4 border\">{r.paymentDate ? r.paymentDate.slice(0, 10) : \"\"}</td>\r\n                                 <td className=\"py-2 px-4 border\">{r.amountPaid}</td>\r\n                                 <td className=\"py-2 px-4 border\">{r.paymentTerm} months</td>\r\n+                                <td className=\"py-2 px-4 border\">{r.remainingBalance} </td>\r\n                                 <td className=\"py-2 px-4 border\">{r.description || \"-\"}</td>\r\n                                 <td className=\"py-2 px-4 border\">\r\n                                     <Link\r\n                                         to={`/repayments/edit/${r._id}`}\r\n"
                },
                {
                    "date": 1770565103473,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,10 +33,10 @@\n                         <th className=\"py-2 px-4 border\">Borrower</th>\r\n                         <th className=\"py-2 px-4 border\">Payment Date</th>\r\n                         <th className=\"py-2 px-4 border\">Amount Paid</th>\r\n                         <th className=\"py-2 px-4 border\">Payment Term</th>\r\n+                        <th className=\"py-2 px-4 border\">Remaining Balance</th>\r\n                         <th className=\"py-2 px-4 border\">Description</th>\r\n-                        <th className=\"py-2 px-4 border\">Remaining Balance</th>\r\n                         <th className=\"py-2 px-4 border\">Actions</th>\r\n                     </tr>\r\n                 </thead>\r\n                 <tbody>\r\n"
                },
                {
                    "date": 1770565752466,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,13 +1,29 @@\n import { useEffect, useState } from \"react\";\r\n import { getRepayments, deleteRepayment } from \"../../api/repaymentApi\";\r\n+import { getLoans } from \"../../api/loanApi\";\r\n import { Link } from \"react-router-dom\";\r\n \r\n const RepaymentList = () => {\r\n     const [repayments, setRepayments] = useState([]);\r\n+    const [loans, setLoans] = useState({}); // map loanId => loan data\r\n \r\n-    const fetchRepayments = async () => setRepayments(await getRepayments());\r\n+    // Fetch all repayments\r\n+    const fetchRepayments = async () => {\r\n+        const data = await getRepayments();\r\n+        setRepayments(data);\r\n+    };\r\n \r\n+    // Fetch all loans (to map loanId → borrower)\r\n+    const fetchLoans = async () => {\r\n+        const loanList = await getLoans();\r\n+        const loanMap = {};\r\n+        loanList.forEach((l) => {\r\n+            loanMap[l._id] = l;\r\n+        });\r\n+        setLoans(loanMap);\r\n+    };\r\n+\r\n     const handleDelete = async (id) => {\r\n         if (window.confirm(\"Are you sure you want to delete this repayment?\")) {\r\n             await deleteRepayment(id);\r\n             fetchRepayments();\r\n@@ -15,10 +31,28 @@\n     };\r\n \r\n     useEffect(() => {\r\n         fetchRepayments();\r\n+        fetchLoans();\r\n     }, []);\r\n \r\n+    // Compute remaining balance dynamically (loan amount minus sum of repayments)\r\n+    const computeRemainingBalance = (repayment) => {\r\n+        const loan = loans[repayment.loan?._id || repayment.loan];\r\n+        if (!loan) return \"-\";\r\n+\r\n+        const allRepaymentsForLoan = repayments.filter(\r\n+            (r) => r.loan?._id === loan._id || r.loan === loan._id\r\n+        );\r\n+\r\n+        const totalPaid = allRepaymentsForLoan.reduce(\r\n+            (sum, r) => sum + Number(r.amountPaid || 0),\r\n+            0\r\n+        );\r\n+\r\n+        return loan.amount - totalPaid;\r\n+    };\r\n+\r\n     return (\r\n         <div>\r\n             <h1 className=\"text-2xl font-bold mb-4\">Repayments</h1>\r\n             <Link\r\n@@ -40,35 +74,44 @@\n                     </tr>\r\n                 </thead>\r\n                 <tbody>\r\n                     {repayments.length > 0 ? (\r\n-                        repayments.map((r) => (\r\n-                            <tr key={r._id}>\r\n-                                <td className=\"py-2 px-4 border\">{r.loan?.borrower?.fullName || \"Unknown\"}</td>\r\n-                                <td className=\"py-2 px-4 border\">{r.paymentDate ? r.paymentDate.slice(0, 10) : \"\"}</td>\r\n-                                <td className=\"py-2 px-4 border\">{r.amountPaid}</td>\r\n-                                <td className=\"py-2 px-4 border\">{r.paymentTerm} months</td>\r\n-                                <td className=\"py-2 px-4 border\">{r.remainingBalance} </td>\r\n-                                <td className=\"py-2 px-4 border\">{r.description || \"-\"}</td>\r\n-                                <td className=\"py-2 px-4 border\">\r\n-                                    <Link\r\n-                                        to={`/repayments/edit/${r._id}`}\r\n-                                        className=\"text-blue-500 mr-2\"\r\n-                                    >\r\n-                                        Edit\r\n-                                    </Link>\r\n-                                    <button\r\n-                                        onClick={() => handleDelete(r._id)}\r\n-                                        className=\"text-red-500\"\r\n-                                    >\r\n-                                        Delete\r\n-                                    </button>\r\n-                                </td>\r\n-                            </tr>\r\n-                        ))\r\n+                        repayments.map((r) => {\r\n+                            const loan = loans[r.loan?._id || r.loan];\r\n+                            return (\r\n+                                <tr key={r._id}>\r\n+                                    <td className=\"py-2 px-4 border\">\r\n+                                        {loan?.borrower?.fullName || \"Unknown\"}\r\n+                                    </td>\r\n+                                    <td className=\"py-2 px-4 border\">\r\n+                                        {r.paymentDate ? r.paymentDate.slice(0, 10) : \"\"}\r\n+                                    </td>\r\n+                                    <td className=\"py-2 px-4 border\">{r.amountPaid}</td>\r\n+                                    <td className=\"py-2 px-4 border\">{r.paymentTerm} months</td>\r\n+                                    <td className=\"py-2 px-4 border\">\r\n+                                        {computeRemainingBalance(r)}\r\n+                                    </td>\r\n+                                    <td className=\"py-2 px-4 border\">{r.description || \"-\"}</td>\r\n+                                    <td className=\"py-2 px-4 border\">\r\n+                                        <Link\r\n+                                            to={`/repayments/edit/${r._id}`}\r\n+                                            className=\"text-blue-500 mr-2\"\r\n+                                        >\r\n+                                            Edit\r\n+                                        </Link>\r\n+                                        <button\r\n+                                            onClick={() => handleDelete(r._id)}\r\n+                                            className=\"text-red-500\"\r\n+                                        >\r\n+                                            Delete\r\n+                                        </button>\r\n+                                    </td>\r\n+                                </tr>\r\n+                            );\r\n+                        })\r\n                     ) : (\r\n                         <tr>\r\n-                            <td colSpan=\"6\" className=\"py-2 px-4 text-center text-gray-500\">\r\n+                            <td colSpan=\"7\" className=\"py-2 px-4 text-center text-gray-500\">\r\n                                 No repayments found.\r\n                             </td>\r\n                         </tr>\r\n                     )}\r\n"
                },
                {
                    "date": 1770566750926,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -79,10 +79,13 @@\n                             const loan = loans[r.loan?._id || r.loan];\r\n                             return (\r\n                                 <tr key={r._id}>\r\n                                     <td className=\"py-2 px-4 border\">\r\n-                                        {loan?.borrower?.fullName || \"Unknown\"}\r\n+                                        {loan?.borrower?.fullName\r\n+                                            ? `${loan.borrower.fullName}-${loan.amount}`\r\n+                                            : \"Unknown\"}\r\n                                     </td>\r\n+\r\n                                     <td className=\"py-2 px-4 border\">\r\n                                         {r.paymentDate ? r.paymentDate.slice(0, 10) : \"\"}\r\n                                     </td>\r\n                                     <td className=\"py-2 px-4 border\">{r.amountPaid}</td>\r\n"
                },
                {
                    "date": 1770576220881,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,9 @@\n import { useEffect, useState } from \"react\";\r\n import { getRepayments, deleteRepayment } from \"../../api/repaymentApi\";\r\n import { getLoans } from \"../../api/loanApi\";\r\n import { Link } from \"react-router-dom\";\r\n+import PageToolbar from \"../../components/PageToolbar\";\r\n \r\n const RepaymentList = () => {\r\n     const [repayments, setRepayments] = useState([]);\r\n     const [loans, setLoans] = useState({}); // map loanId => loan data\r\n@@ -52,16 +53,10 @@\n         return loan.amount - totalPaid;\r\n     };\r\n \r\n     return (\r\n-        <div>\r\n-            <h1 className=\"text-2xl font-bold mb-4\">Repayments</h1>\r\n-            <Link\r\n-                to=\"/repayments/new\"\r\n-                className=\"bg-gray-500 text-white px-4 py-2 rounded mb-4 inline-block\"\r\n-            >\r\n-                Add Repayment\r\n-            </Link>\r\n+        <>\r\n+            <PageToolbar title=\"Repayments\" buttonLabel=\"Add Repayment\" buttonLink=\"/repayments/new\" />\r\n             <table className=\"min-w-full bg-white border\">\r\n                 <thead>\r\n                     <tr>\r\n                         <th className=\"py-2 px-4 border\">Borrower</th>\r\n@@ -119,9 +114,9 @@\n                         </tr>\r\n                     )}\r\n                 </tbody>\r\n             </table>\r\n-        </div>\r\n+        </>\r\n     );\r\n };\r\n \r\n export default RepaymentList;\r\n"
                },
                {
                    "date": 1770576442608,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,33 +1,30 @@\n import { useEffect, useState } from \"react\";\r\n import { getRepayments, deleteRepayment } from \"../../api/repaymentApi\";\r\n import { getLoans } from \"../../api/loanApi\";\r\n+import PageToolbar from \"../../components/PageToolbar\";\r\n+import DataTable from \"../../components/DataTable\";\r\n import { Link } from \"react-router-dom\";\r\n-import PageToolbar from \"../../components/PageToolbar\";\r\n \r\n const RepaymentList = () => {\r\n     const [repayments, setRepayments] = useState([]);\r\n-    const [loans, setLoans] = useState({}); // map loanId => loan data\r\n+    const [loans, setLoans] = useState({});\r\n \r\n-    // Fetch all repayments\r\n     const fetchRepayments = async () => {\r\n         const data = await getRepayments();\r\n         setRepayments(data);\r\n     };\r\n \r\n-    // Fetch all loans (to map loanId → borrower)\r\n     const fetchLoans = async () => {\r\n         const loanList = await getLoans();\r\n         const loanMap = {};\r\n-        loanList.forEach((l) => {\r\n-            loanMap[l._id] = l;\r\n-        });\r\n+        loanList.forEach((l) => (loanMap[l._id] = l));\r\n         setLoans(loanMap);\r\n     };\r\n \r\n-    const handleDelete = async (id) => {\r\n+    const handleDelete = async (repayment) => {\r\n         if (window.confirm(\"Are you sure you want to delete this repayment?\")) {\r\n-            await deleteRepayment(id);\r\n+            await deleteRepayment(repayment._id);\r\n             fetchRepayments();\r\n         }\r\n     };\r\n \r\n@@ -35,9 +32,8 @@\n         fetchRepayments();\r\n         fetchLoans();\r\n     }, []);\r\n \r\n-    // Compute remaining balance dynamically (loan amount minus sum of repayments)\r\n     const computeRemainingBalance = (repayment) => {\r\n         const loan = loans[repayment.loan?._id || repayment.loan];\r\n         if (!loan) return \"-\";\r\n \r\n@@ -52,70 +48,49 @@\n \r\n         return loan.amount - totalPaid;\r\n     };\r\n \r\n+    const columns = [\r\n+        {\r\n+            key: \"borrower\",\r\n+            label: \"Borrower\",\r\n+            render: (r) => {\r\n+                const loan = loans[r.loan?._id || r.loan];\r\n+                return loan?.borrower?.fullName\r\n+                    ? `${loan.borrower.fullName} - ${loan.amount}`\r\n+                    : \"Unknown\";\r\n+            },\r\n+        },\r\n+        {\r\n+            key: \"paymentDate\",\r\n+            label: \"Payment Date\",\r\n+            render: (r) => (r.paymentDate ? r.paymentDate.slice(0, 10) : \"\"),\r\n+        },\r\n+        { key: \"amountPaid\", label: \"Amount Paid\" },\r\n+        { key: \"paymentTerm\", label: \"Payment Term\", render: (r) => `${r.paymentTerm} months` },\r\n+        { key: \"remainingBalance\", label: \"Remaining Balance\", render: computeRemainingBalance },\r\n+        { key: \"description\", label: \"Description\", render: (r) => r.description || \"-\" },\r\n+    ];\r\n+\r\n+    const actions = [\r\n+        {\r\n+            type: \"link\",\r\n+            label: \"Edit\",\r\n+            to: (r) => `/repayments/edit/${r._id}`,\r\n+            className: \"text-blue-500\",\r\n+        },\r\n+        {\r\n+            type: \"button\",\r\n+            label: \"Delete\",\r\n+            onClick: handleDelete,\r\n+            className: \"text-red-500\",\r\n+        },\r\n+    ];\r\n+\r\n     return (\r\n         <>\r\n             <PageToolbar title=\"Repayments\" buttonLabel=\"Add Repayment\" buttonLink=\"/repayments/new\" />\r\n-            <table className=\"min-w-full bg-white border\">\r\n-                <thead>\r\n-                    <tr>\r\n-                        <th className=\"py-2 px-4 border\">Borrower</th>\r\n-                        <th className=\"py-2 px-4 border\">Payment Date</th>\r\n-                        <th className=\"py-2 px-4 border\">Amount Paid</th>\r\n-                        <th className=\"py-2 px-4 border\">Payment Term</th>\r\n-                        <th className=\"py-2 px-4 border\">Remaining Balance</th>\r\n-                        <th className=\"py-2 px-4 border\">Description</th>\r\n-                        <th className=\"py-2 px-4 border\">Actions</th>\r\n-                    </tr>\r\n-                </thead>\r\n-                <tbody>\r\n-                    {repayments.length > 0 ? (\r\n-                        repayments.map((r) => {\r\n-                            const loan = loans[r.loan?._id || r.loan];\r\n-                            return (\r\n-                                <tr key={r._id}>\r\n-                                    <td className=\"py-2 px-4 border\">\r\n-                                        {loan?.borrower?.fullName\r\n-                                            ? `${loan.borrower.fullName}-${loan.amount}`\r\n-                                            : \"Unknown\"}\r\n-                                    </td>\r\n-\r\n-                                    <td className=\"py-2 px-4 border\">\r\n-                                        {r.paymentDate ? r.paymentDate.slice(0, 10) : \"\"}\r\n-                                    </td>\r\n-                                    <td className=\"py-2 px-4 border\">{r.amountPaid}</td>\r\n-                                    <td className=\"py-2 px-4 border\">{r.paymentTerm} months</td>\r\n-                                    <td className=\"py-2 px-4 border\">\r\n-                                        {computeRemainingBalance(r)}\r\n-                                    </td>\r\n-                                    <td className=\"py-2 px-4 border\">{r.description || \"-\"}</td>\r\n-                                    <td className=\"py-2 px-4 border\">\r\n-                                        <Link\r\n-                                            to={`/repayments/edit/${r._id}`}\r\n-                                            className=\"text-blue-500 mr-2\"\r\n-                                        >\r\n-                                            Edit\r\n-                                        </Link>\r\n-                                        <button\r\n-                                            onClick={() => handleDelete(r._id)}\r\n-                                            className=\"text-red-500\"\r\n-                                        >\r\n-                                            Delete\r\n-                                        </button>\r\n-                                    </td>\r\n-                                </tr>\r\n-                            );\r\n-                        })\r\n-                    ) : (\r\n-                        <tr>\r\n-                            <td colSpan=\"7\" className=\"py-2 px-4 text-center text-gray-500\">\r\n-                                No repayments found.\r\n-                            </td>\r\n-                        </tr>\r\n-                    )}\r\n-                </tbody>\r\n-            </table>\r\n+            <DataTable columns={columns} data={repayments} actions={actions} />\r\n         </>\r\n     );\r\n };\r\n \r\n"
                }
            ],
            "date": 1770563271670,
            "name": "Commit-0",
            "content": "import { useEffect, useState } from \"react\";\r\nimport { getRepayments, deleteRepayment } from \"../../api/repaymentApi\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nconst RepaymentList = () => {\r\n    const [repayments, setRepayments] = useState([]);\r\n\r\n    const fetchRepayments = async () => setRepayments(await getRepayments());\r\n    const handleDelete = async (id) => { await deleteRepayment(id); fetchRepayments(); };\r\n\r\n    useEffect(() => { fetchRepayments(); }, []);\r\n\r\n    return (\r\n        <div>\r\n            <h1 className=\"text-2xl font-bold mb-4\">Repayments</h1>\r\n            <Link to=\"/repayments/new\" className=\"bg-gray-500 text-white px-4 py-2 rounded mb-4 inline-block\">Add Repayment</Link>\r\n            <table className=\"min-w-full bg-white border\">\r\n                <thead>\r\n                    <tr>\r\n                        <th className=\"py-2 px-4 border\">Payment ID</th>\r\n                        <th className=\"py-2 px-4 border\">Loan</th>\r\n                        <th className=\"py-2 px-4 border\">Payment Date</th>\r\n                        <th className=\"py-2 px-4 border\">Amount Paid</th>\r\n                        <th className=\"py-2 px-4 border\">Remaining Balance</th>\r\n                        <th className=\"py-2 px-4 border\">Actions</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    {repayments.map(r => (\r\n                        <tr key={r._id}>\r\n                            <td className=\"py-2 px-4 border\">{r._id}</td>\r\n                            <td className=\"py-2 px-4 border\">{r.loan?.amount || r.loan}</td>\r\n                            <td className=\"py-2 px-4 border\">{new Date(r.paymentDate).toLocaleDateString()}</td>\r\n                            <td className=\"py-2 px-4 border\">{r.amountPaid}</td>\r\n                            <td className=\"py-2 px-4 border\">{r.remainingBalance}</td>\r\n                            <td className=\"py-2 px-4 border\">\r\n                                <button onClick={() => handleDelete(r._id)} className=\"text-red-500\">Delete</button>\r\n                            </td>\r\n                        </tr>\r\n                    ))}\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default RepaymentList;\r\n"
        }
    ]
}