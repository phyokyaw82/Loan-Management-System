{
    "sourceFile": "src/pages/Repayments/RepaymentForm.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 23,
            "patches": [
                {
                    "date": 1770563271667,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1770564314612,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,33 +1,75 @@\n import { useState, useEffect } from \"react\";\r\n-import { useNavigate } from \"react-router-dom\";\r\n-import { createRepayment } from \"../../api/repaymentApi\";\r\n+import { useNavigate, useParams } from \"react-router-dom\";\r\n+import { createRepayment, getRepaymentById, updateRepayment } from \"../../api/repaymentApi\";\r\n import { getLoans } from \"../../api/loanApi\";\r\n \r\n const RepaymentForm = () => {\r\n-    const [repayment, setRepayment] = useState({ loan: \"\", paymentDate: \"\", amountPaid: \"\" });\r\n+    const [repayment, setRepayment] = useState({ loan: \"\", paymentDate: \"\", amount: \"\", term: \"\" });\r\n     const [loans, setLoans] = useState([]);\r\n     const navigate = useNavigate();\r\n+    const { id } = useParams();\r\n \r\n-    useEffect(() => { getLoans().then(setLoans); }, []);\r\n+    useEffect(() => {\r\n+        getLoans().then(setLoans); // load loans for dropdown\r\n \r\n+        if (id) {\r\n+            getRepaymentById(id).then((data) => {\r\n+                setRepayment({\r\n+                    loan: data.loan?._id || \"\",\r\n+                    paymentDate: data.paymentDate ? data.paymentDate.slice(0, 10) : \"\",\r\n+                    amount: data.amount || \"\",\r\n+                    term: data.term || \"\",\r\n+                });\r\n+            });\r\n+        }\r\n+    }, [id]);\r\n+\r\n     const handleChange = e => setRepayment({ ...repayment, [e.target.name]: e.target.value });\r\n-    const handleSubmit = async e => { e.preventDefault(); await createRepayment(repayment); navigate(\"/repayments\"); };\r\n \r\n+    const handleSubmit = async e => {\r\n+        e.preventDefault();\r\n+\r\n+        const payload = {\r\n+            ...repayment,\r\n+            amount: Number(repayment.amount),\r\n+            paymentDate: repayment.paymentDate ? new Date(repayment.paymentDate) : null,\r\n+        };\r\n+\r\n+        try {\r\n+            if (id) await updateRepayment(id, payload);\r\n+            else await createRepayment(payload);\r\n+            navigate(\"/repayments\");\r\n+        } catch (err) {\r\n+            console.error(err);\r\n+            alert(\"Error saving repayment\");\r\n+        }\r\n+    };\r\n+\r\n     return (\r\n         <div className=\"max-w-md mx-auto\">\r\n-            <h1 className=\"text-2xl font-bold mb-4\">Add Repayment</h1>\r\n+            <h1 className=\"text-2xl font-bold mb-4\">{id ? \"Edit\" : \"Add\"} Repayment</h1>\r\n             <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n                 <label>Loan</label>\r\n                 <select name=\"loan\" value={repayment.loan} onChange={handleChange} className=\"w-full border p-2\">\r\n                     <option value=\"\">Select Loan</option>\r\n-                    {loans.map(l => <option key={l._id} value={l._id}>{l.borrower?.fullName} - {l.amount}</option>)}\r\n+                    {loans.map(l => (\r\n+                        <option key={l._id} value={l._id}>\r\n+                            {l._id} - {l.borrower?.fullName || \"Unknown\"}\r\n+                        </option>\r\n+                    ))}\r\n                 </select>\r\n+\r\n                 <label>Payment Date</label>\r\n                 <input type=\"date\" name=\"paymentDate\" value={repayment.paymentDate} onChange={handleChange} className=\"w-full border p-2\" />\r\n-                <label>Amount Paid</label>\r\n-                <input type=\"number\" name=\"amountPaid\" value={repayment.amountPaid} onChange={handleChange} className=\"w-full border p-2\" />\r\n-                <button type=\"submit\" className=\"bg-gray-500 text-white px-4 py-2 rounded\">Create</button>\r\n+\r\n+                <label>Amount</label>\r\n+                <input type=\"number\" name=\"amount\" value={repayment.amount} onChange={handleChange} className=\"w-full border p-2\" />\r\n+\r\n+                <label>Payment Term</label>\r\n+                <input type=\"text\" name=\"term\" value={repayment.term} onChange={handleChange} className=\"w-full border p-2\" />\r\n+\r\n+                <button type=\"submit\" className=\"bg-gray-500 text-white px-4 py-2 rounded\">{id ? \"Update\" : \"Create\"}</button>\r\n             </form>\r\n         </div>\r\n     );\r\n };\r\n"
                },
                {
                    "date": 1770564590575,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,37 +3,48 @@\n import { createRepayment, getRepaymentById, updateRepayment } from \"../../api/repaymentApi\";\r\n import { getLoans } from \"../../api/loanApi\";\r\n \r\n const RepaymentForm = () => {\r\n-    const [repayment, setRepayment] = useState({ loan: \"\", paymentDate: \"\", amount: \"\", term: \"\" });\r\n+    const [repayment, setRepayment] = useState({\r\n+        loan: \"\",\r\n+        paymentDate: \"\",\r\n+        amountPaid: \"\",\r\n+        paymentTerm: \"\",\r\n+        description: \"\"\r\n+    });\r\n     const [loans, setLoans] = useState([]);\r\n     const navigate = useNavigate();\r\n     const { id } = useParams();\r\n \r\n+    // Payment term options\r\n+    const termOptions = [1, 3, 6, 12]; // example terms in months\r\n+\r\n     useEffect(() => {\r\n-        getLoans().then(setLoans); // load loans for dropdown\r\n+        getLoans().then(setLoans);\r\n \r\n         if (id) {\r\n             getRepaymentById(id).then((data) => {\r\n                 setRepayment({\r\n                     loan: data.loan?._id || \"\",\r\n                     paymentDate: data.paymentDate ? data.paymentDate.slice(0, 10) : \"\",\r\n-                    amount: data.amount || \"\",\r\n-                    term: data.term || \"\",\r\n+                    amountPaid: data.amountPaid || \"\",\r\n+                    paymentTerm: data.paymentTerm || \"\",\r\n+                    description: data.description || \"\"\r\n                 });\r\n             });\r\n         }\r\n     }, [id]);\r\n \r\n-    const handleChange = e => setRepayment({ ...repayment, [e.target.name]: e.target.value });\r\n+    const handleChange = (e) => setRepayment({ ...repayment, [e.target.name]: e.target.value });\r\n \r\n-    const handleSubmit = async e => {\r\n+    const handleSubmit = async (e) => {\r\n         e.preventDefault();\r\n \r\n         const payload = {\r\n             ...repayment,\r\n-            amount: Number(repayment.amount),\r\n-            paymentDate: repayment.paymentDate ? new Date(repayment.paymentDate) : null,\r\n+            amountPaid: Number(repayment.amountPaid),\r\n+            paymentTerm: Number(repayment.paymentTerm),\r\n+            paymentDate: repayment.paymentDate ? new Date(repayment.paymentDate) : null\r\n         };\r\n \r\n         try {\r\n             if (id) await updateRepayment(id, payload);\r\n@@ -61,15 +72,21 @@\n \r\n                 <label>Payment Date</label>\r\n                 <input type=\"date\" name=\"paymentDate\" value={repayment.paymentDate} onChange={handleChange} className=\"w-full border p-2\" />\r\n \r\n-                <label>Amount</label>\r\n-                <input type=\"number\" name=\"amount\" value={repayment.amount} onChange={handleChange} className=\"w-full border p-2\" />\r\n+                <label>Amount Paid</label>\r\n+                <input type=\"number\" name=\"amountPaid\" value={repayment.amountPaid} onChange={handleChange} className=\"w-full border p-2\" />\r\n \r\n-                <label>Payment Term</label>\r\n-                <input type=\"text\" name=\"term\" value={repayment.term} onChange={handleChange} className=\"w-full border p-2\" />\r\n+                <label>Payment Term (months)</label>\r\n+                <select name=\"paymentTerm\" value={repayment.paymentTerm} onChange={handleChange} className=\"w-full border p-2\">\r\n+                    <option value=\"\">Select Term</option>\r\n+                    {termOptions.map(t => <option key={t} value={t}>{t} months</option>)}\r\n+                </select>\r\n \r\n-                <button type=\"submit\" className=\"bg-gray-500 text-white px-4 py-2 rounded\">{id ? \"Update\" : \"Create\"}</button>\r\n+                <label>Description</label>\r\n+                <input type=\"text\" name=\"description\" value={repayment.description} onChange={handleChange} className=\"w-full border p-2\" />\r\n+\r\n+                <button type=\"submit\" className=\"bg-blue-500 text-white px-4 py-2 rounded\">{id ? \"Update\" : \"Create\"}</button>\r\n             </form>\r\n         </div>\r\n     );\r\n };\r\n"
                },
                {
                    "date": 1770564681935,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -14,10 +14,9 @@\n     const [loans, setLoans] = useState([]);\r\n     const navigate = useNavigate();\r\n     const { id } = useParams();\r\n \r\n-    // Payment term options\r\n-    const termOptions = [1, 3, 6, 12]; // example terms in months\r\n+    const termOptions = [1, 3, 6, 12]; // months\r\n \r\n     useEffect(() => {\r\n         getLoans().then(setLoans);\r\n \r\n@@ -56,37 +55,93 @@\n         }\r\n     };\r\n \r\n     return (\r\n-        <div className=\"max-w-md mx-auto\">\r\n-            <h1 className=\"text-2xl font-bold mb-4\">{id ? \"Edit\" : \"Add\"} Repayment</h1>\r\n-            <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n-                <label>Loan</label>\r\n-                <select name=\"loan\" value={repayment.loan} onChange={handleChange} className=\"w-full border p-2\">\r\n-                    <option value=\"\">Select Loan</option>\r\n-                    {loans.map(l => (\r\n-                        <option key={l._id} value={l._id}>\r\n-                            {l._id} - {l.borrower?.fullName || \"Unknown\"}\r\n-                        </option>\r\n-                    ))}\r\n-                </select>\r\n+        <div className=\"max-w-3xl mx-auto\">\r\n+            <h1 className=\"text-2xl font-bold mb-6\">{id ? \"Edit\" : \"Add\"} Repayment</h1>\r\n+            <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow grid grid-cols-2 gap-4\">\r\n \r\n-                <label>Payment Date</label>\r\n-                <input type=\"date\" name=\"paymentDate\" value={repayment.paymentDate} onChange={handleChange} className=\"w-full border p-2\" />\r\n+                {/* Loan */}\r\n+                <div className=\"flex flex-col\">\r\n+                    <label className=\"mb-1 font-medium\">Loan</label>\r\n+                    <select\r\n+                        name=\"loan\"\r\n+                        value={repayment.loan}\r\n+                        onChange={handleChange}\r\n+                        className=\"border p-2 rounded\"\r\n+                    >\r\n+                        <option value=\"\">Select Loan</option>\r\n+                        {loans.map((l) => (\r\n+                            <option key={l._id} value={l._id}>\r\n+                                {l._id} - {l.borrower?.fullName || \"Unknown\"}\r\n+                            </option>\r\n+                        ))}\r\n+                    </select>\r\n+                </div>\r\n \r\n-                <label>Amount Paid</label>\r\n-                <input type=\"number\" name=\"amountPaid\" value={repayment.amountPaid} onChange={handleChange} className=\"w-full border p-2\" />\r\n+                {/* Payment Date */}\r\n+                <div className=\"flex flex-col\">\r\n+                    <label className=\"mb-1 font-medium\">Payment Date</label>\r\n+                    <input\r\n+                        type=\"date\"\r\n+                        name=\"paymentDate\"\r\n+                        value={repayment.paymentDate}\r\n+                        onChange={handleChange}\r\n+                        className=\"border p-2 rounded\"\r\n+                    />\r\n+                </div>\r\n \r\n-                <label>Payment Term (months)</label>\r\n-                <select name=\"paymentTerm\" value={repayment.paymentTerm} onChange={handleChange} className=\"w-full border p-2\">\r\n-                    <option value=\"\">Select Term</option>\r\n-                    {termOptions.map(t => <option key={t} value={t}>{t} months</option>)}\r\n-                </select>\r\n+                {/* Amount Paid */}\r\n+                <div className=\"flex flex-col\">\r\n+                    <label className=\"mb-1 font-medium\">Amount Paid</label>\r\n+                    <input\r\n+                        type=\"number\"\r\n+                        name=\"amountPaid\"\r\n+                        value={repayment.amountPaid}\r\n+                        onChange={handleChange}\r\n+                        className=\"border p-2 rounded\"\r\n+                    />\r\n+                </div>\r\n \r\n-                <label>Description</label>\r\n-                <input type=\"text\" name=\"description\" value={repayment.description} onChange={handleChange} className=\"w-full border p-2\" />\r\n+                {/* Payment Term */}\r\n+                <div className=\"flex flex-col\">\r\n+                    <label className=\"mb-1 font-medium\">Payment Term (months)</label>\r\n+                    <select\r\n+                        name=\"paymentTerm\"\r\n+                        value={repayment.paymentTerm}\r\n+                        onChange={handleChange}\r\n+                        className=\"border p-2 rounded\"\r\n+                    >\r\n+                        <option value=\"\">Select Term</option>\r\n+                        {termOptions.map((t) => (\r\n+                            <option key={t} value={t}>\r\n+                                {t} months\r\n+                            </option>\r\n+                        ))}\r\n+                    </select>\r\n+                </div>\r\n \r\n-                <button type=\"submit\" className=\"bg-blue-500 text-white px-4 py-2 rounded\">{id ? \"Update\" : \"Create\"}</button>\r\n+                {/* Description (full width) */}\r\n+                <div className=\"flex flex-col col-span-2\">\r\n+                    <label className=\"mb-1 font-medium\">Description</label>\r\n+                    <input\r\n+                        type=\"text\"\r\n+                        name=\"description\"\r\n+                        value={repayment.description}\r\n+                        onChange={handleChange}\r\n+                        className=\"border p-2 rounded\"\r\n+                    />\r\n+                </div>\r\n+\r\n+                {/* Submit button (full width) */}\r\n+                <div className=\"col-span-2 flex justify-end\">\r\n+                    <button\r\n+                        type=\"submit\"\r\n+                        className=\"bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600\"\r\n+                    >\r\n+                        {id ? \"Update\" : \"Create\"}\r\n+                    </button>\r\n+                </div>\r\n             </form>\r\n         </div>\r\n     );\r\n };\r\n"
                },
                {
                    "date": 1770564791982,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -135,9 +135,9 @@\n                 {/* Submit button (full width) */}\r\n                 <div className=\"col-span-2 flex justify-end\">\r\n                     <button\r\n                         type=\"submit\"\r\n-                        className=\"bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600\"\r\n+                        className=\"bg-gray-500 text-white px-6 py-2 rounded hover:bg-blue-600\"\r\n                     >\r\n                         {id ? \"Update\" : \"Create\"}\r\n                     </button>\r\n                 </div>\r\n"
                },
                {
                    "date": 1770564947048,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -131,9 +131,9 @@\n                         className=\"border p-2 rounded\"\r\n                     />\r\n                 </div>\r\n \r\n-                {/* Submit button (full width) */}\r\n+                {/* Submit button (full width) */}pa\r\n                 <div className=\"col-span-2 flex justify-end\">\r\n                     <button\r\n                         type=\"submit\"\r\n                         className=\"bg-gray-500 text-white px-6 py-2 rounded hover:bg-blue-600\"\r\n"
                },
                {
                    "date": 1770565009195,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -131,9 +131,9 @@\n                         className=\"border p-2 rounded\"\r\n                     />\r\n                 </div>\r\n \r\n-                {/* Submit button (full width) */}pa\r\n+                {/* Submit button (full width) */}\r\n                 <div className=\"col-span-2 flex justify-end\">\r\n                     <button\r\n                         type=\"submit\"\r\n                         className=\"bg-gray-500 text-white px-6 py-2 rounded hover:bg-blue-600\"\r\n"
                },
                {
                    "date": 1770565141633,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -135,9 +135,9 @@\n                 {/* Submit button (full width) */}\r\n                 <div className=\"col-span-2 flex justify-end\">\r\n                     <button\r\n                         type=\"submit\"\r\n-                        className=\"bg-gray-500 text-white px-6 py-2 rounded hover:bg-blue-600\"\r\n+                        className=\"bg-gray-500 text-white px-6 py-2 rounded\"\r\n                     >\r\n                         {id ? \"Update\" : \"Create\"}\r\n                     </button>\r\n                 </div>\r\n"
                },
                {
                    "date": 1770565154148,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -135,9 +135,9 @@\n                 {/* Submit button (full width) */}\r\n                 <div className=\"col-span-2 flex justify-end\">\r\n                     <button\r\n                         type=\"submit\"\r\n-                        className=\"bg-gray-500 text-white px-6 py-2 rounded\"\r\n+                        className=\"bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600\"\r\n                     >\r\n                         {id ? \"Update\" : \"Create\"}\r\n                     </button>\r\n                 </div>\r\n"
                },
                {
                    "date": 1770565452112,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -135,9 +135,9 @@\n                 {/* Submit button (full width) */}\r\n                 <div className=\"col-span-2 flex justify-end\">\r\n                     <button\r\n                         type=\"submit\"\r\n-                        className=\"bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600\"\r\n+                        className=\"bg-gray-500 text-white px-6 py-2 rounded\"\r\n                     >\r\n                         {id ? \"Update\" : \"Create\"}\r\n                     </button>\r\n                 </div>\r\n"
                },
                {
                    "date": 1770565614179,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -55,20 +55,20 @@\n         }\r\n     };\r\n \r\n     return (\r\n-        <div className=\"max-w-3xl mx-auto\">\r\n-            <h1 className=\"text-2xl font-bold mb-6\">{id ? \"Edit\" : \"Add\"} Repayment</h1>\r\n-            <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow grid grid-cols-2 gap-4\">\r\n+        <div className=\"max-w-md mx-auto\">\r\n+            <h1 className=\"text-2xl font-bold mb-4\">{id ? \"Edit\" : \"Add\"} Repayment</h1>\r\n+            <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n \r\n                 {/* Loan */}\r\n                 <div className=\"flex flex-col\">\r\n                     <label className=\"mb-1 font-medium\">Loan</label>\r\n                     <select\r\n                         name=\"loan\"\r\n                         value={repayment.loan}\r\n                         onChange={handleChange}\r\n-                        className=\"border p-2 rounded\"\r\n+                        className=\"w-full border p-2 rounded\"\r\n                     >\r\n                         <option value=\"\">Select Loan</option>\r\n                         {loans.map((l) => (\r\n                             <option key={l._id} value={l._id}>\r\n@@ -85,9 +85,9 @@\n                         type=\"date\"\r\n                         name=\"paymentDate\"\r\n                         value={repayment.paymentDate}\r\n                         onChange={handleChange}\r\n-                        className=\"border p-2 rounded\"\r\n+                        className=\"w-full border p-2 rounded\"\r\n                     />\r\n                 </div>\r\n \r\n                 {/* Amount Paid */}\r\n@@ -97,9 +97,9 @@\n                         type=\"number\"\r\n                         name=\"amountPaid\"\r\n                         value={repayment.amountPaid}\r\n                         onChange={handleChange}\r\n-                        className=\"border p-2 rounded\"\r\n+                        className=\"w-full border p-2 rounded\"\r\n                     />\r\n                 </div>\r\n \r\n                 {/* Payment Term */}\r\n@@ -108,9 +108,9 @@\n                     <select\r\n                         name=\"paymentTerm\"\r\n                         value={repayment.paymentTerm}\r\n                         onChange={handleChange}\r\n-                        className=\"border p-2 rounded\"\r\n+                        className=\"w-full border p-2 rounded\"\r\n                     >\r\n                         <option value=\"\">Select Term</option>\r\n                         {termOptions.map((t) => (\r\n                             <option key={t} value={t}>\r\n@@ -119,25 +119,25 @@\n                         ))}\r\n                     </select>\r\n                 </div>\r\n \r\n-                {/* Description (full width) */}\r\n-                <div className=\"flex flex-col col-span-2\">\r\n+                {/* Description */}\r\n+                <div className=\"flex flex-col\">\r\n                     <label className=\"mb-1 font-medium\">Description</label>\r\n                     <input\r\n                         type=\"text\"\r\n                         name=\"description\"\r\n                         value={repayment.description}\r\n                         onChange={handleChange}\r\n-                        className=\"border p-2 rounded\"\r\n+                        className=\"w-full border p-2 rounded\"\r\n                     />\r\n                 </div>\r\n \r\n-                {/* Submit button (full width) */}\r\n-                <div className=\"col-span-2 flex justify-end\">\r\n+                {/* Submit button */}\r\n+                <div className=\"flex justify-end\">\r\n                     <button\r\n                         type=\"submit\"\r\n-                        className=\"bg-gray-500 text-white px-6 py-2 rounded\"\r\n+                        className=\"bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600\"\r\n                     >\r\n                         {id ? \"Update\" : \"Create\"}\r\n                     </button>\r\n                 </div>\r\n"
                },
                {
                    "date": 1770566848187,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -66,9 +66,9 @@\n                     <select\r\n                         name=\"loan\"\r\n                         value={repayment.loan}\r\n                         onChange={handleChange}\r\n-                        className=\"w-full border p-2 rounded\"\r\n+                        className=\"border p-2 rounded\"\r\n                     >\r\n                         <option value=\"\">Select Loan</option>\r\n                         {loans.map((l) => (\r\n                             <option key={l._id} value={l._id}>\r\n"
                },
                {
                    "date": 1770566881253,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -71,9 +71,9 @@\n                     >\r\n                         <option value=\"\">Select Loan</option>\r\n                         {loans.map((l) => (\r\n                             <option key={l._id} value={l._id}>\r\n-                                {l._id} - {l.borrower?.fullName || \"Unknown\"}\r\n+                                {l.borrower?.fullName ? `${l.borrower.fullName}-${l.amount}` : `Unknown-${l.amount}`}\r\n                             </option>\r\n                         ))}\r\n                     </select>\r\n                 </div>\r\n"
                },
                {
                    "date": 1770576051921,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,9 @@\n import { useState, useEffect } from \"react\";\r\n import { useNavigate, useParams } from \"react-router-dom\";\r\n import { createRepayment, getRepaymentById, updateRepayment } from \"../../api/repaymentApi\";\r\n import { getLoans } from \"../../api/loanApi\";\r\n+import PageToolbar from \"../../components/PageToolbar\";\r\n \r\n const RepaymentForm = () => {\r\n     const [repayment, setRepayment] = useState({\r\n         loan: \"\",\r\n@@ -56,9 +57,9 @@\n     };\r\n \r\n     return (\r\n         <div className=\"max-w-md mx-auto\">\r\n-            <h1 className=\"text-2xl font-bold mb-4\">{id ? \"Edit\" : \"Add\"} Repayment</h1>\r\n+            <PageToolbar title={id ? \"Edit Repayment\" : \"Add Repayment\"} />\r\n             <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n \r\n                 {/* Loan */}\r\n                 <div className=\"flex flex-col\">\r\n"
                },
                {
                    "date": 1770577172698,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,8 +2,9 @@\n import { useNavigate, useParams } from \"react-router-dom\";\r\n import { createRepayment, getRepaymentById, updateRepayment } from \"../../api/repaymentApi\";\r\n import { getLoans } from \"../../api/loanApi\";\r\n import PageToolbar from \"../../components/PageToolbar\";\r\n+import FormRow from \"../../components/FormRow\";\r\n \r\n const RepaymentForm = () => {\r\n     const [repayment, setRepayment] = useState({\r\n         loan: \"\",\r\n@@ -58,83 +59,71 @@\n \r\n     return (\r\n         <div className=\"max-w-md mx-auto\">\r\n             <PageToolbar title={id ? \"Edit Repayment\" : \"Add Repayment\"} />\r\n+\r\n             <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n \r\n-                {/* Loan */}\r\n-                <div className=\"flex flex-col\">\r\n-                    <label className=\"mb-1 font-medium\">Loan</label>\r\n+                <FormRow label=\"Loan\">\r\n                     <select\r\n                         name=\"loan\"\r\n                         value={repayment.loan}\r\n                         onChange={handleChange}\r\n-                        className=\"border p-2 rounded\"\r\n+                        className=\"w-full border p-2 rounded\"\r\n                     >\r\n                         <option value=\"\">Select Loan</option>\r\n                         {loans.map((l) => (\r\n                             <option key={l._id} value={l._id}>\r\n                                 {l.borrower?.fullName ? `${l.borrower.fullName}-${l.amount}` : `Unknown-${l.amount}`}\r\n                             </option>\r\n                         ))}\r\n                     </select>\r\n-                </div>\r\n+                </FormRow>\r\n \r\n-                {/* Payment Date */}\r\n-                <div className=\"flex flex-col\">\r\n-                    <label className=\"mb-1 font-medium\">Payment Date</label>\r\n+                <FormRow label=\"Payment Date\">\r\n                     <input\r\n                         type=\"date\"\r\n                         name=\"paymentDate\"\r\n                         value={repayment.paymentDate}\r\n                         onChange={handleChange}\r\n                         className=\"w-full border p-2 rounded\"\r\n                     />\r\n-                </div>\r\n+                </FormRow>\r\n \r\n-                {/* Amount Paid */}\r\n-                <div className=\"flex flex-col\">\r\n-                    <label className=\"mb-1 font-medium\">Amount Paid</label>\r\n+                <FormRow label=\"Amount Paid\">\r\n                     <input\r\n                         type=\"number\"\r\n                         name=\"amountPaid\"\r\n                         value={repayment.amountPaid}\r\n                         onChange={handleChange}\r\n                         className=\"w-full border p-2 rounded\"\r\n                     />\r\n-                </div>\r\n+                </FormRow>\r\n \r\n-                {/* Payment Term */}\r\n-                <div className=\"flex flex-col\">\r\n-                    <label className=\"mb-1 font-medium\">Payment Term (months)</label>\r\n+                <FormRow label=\"Payment Term (months)\">\r\n                     <select\r\n                         name=\"paymentTerm\"\r\n                         value={repayment.paymentTerm}\r\n                         onChange={handleChange}\r\n                         className=\"w-full border p-2 rounded\"\r\n                     >\r\n                         <option value=\"\">Select Term</option>\r\n                         {termOptions.map((t) => (\r\n-                            <option key={t} value={t}>\r\n-                                {t} months\r\n-                            </option>\r\n+                            <option key={t} value={t}>{t} months</option>\r\n                         ))}\r\n                     </select>\r\n-                </div>\r\n+                </FormRow>\r\n \r\n-                {/* Description */}\r\n-                <div className=\"flex flex-col\">\r\n-                    <label className=\"mb-1 font-medium\">Description</label>\r\n+                <FormRow label=\"Description\">\r\n                     <input\r\n                         type=\"text\"\r\n                         name=\"description\"\r\n                         value={repayment.description}\r\n                         onChange={handleChange}\r\n                         className=\"w-full border p-2 rounded\"\r\n                     />\r\n-                </div>\r\n+                </FormRow>\r\n \r\n-                {/* Submit button */}\r\n                 <div className=\"flex justify-end\">\r\n                     <button\r\n                         type=\"submit\"\r\n                         className=\"bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600\"\r\n"
                },
                {
                    "date": 1770577730823,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -57,83 +57,84 @@\n         }\r\n     };\r\n \r\n     return (\r\n-        <div className=\"max-w-md mx-auto\">\r\n+        <>\r\n             <PageToolbar title={id ? \"Edit Repayment\" : \"Add Repayment\"} />\r\n+            <div className=\"max-w-md mx-auto\">\r\n+                <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n \r\n-            <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n+                    <FormRow label=\"Loan\">\r\n+                        <select\r\n+                            name=\"loan\"\r\n+                            value={repayment.loan}\r\n+                            onChange={handleChange}\r\n+                            className=\"w-full border p-2 rounded\"\r\n+                        >\r\n+                            <option value=\"\">Select Loan</option>\r\n+                            {loans.map((l) => (\r\n+                                <option key={l._id} value={l._id}>\r\n+                                    {l.borrower?.fullName ? `${l.borrower.fullName}-${l.amount}` : `Unknown-${l.amount}`}\r\n+                                </option>\r\n+                            ))}\r\n+                        </select>\r\n+                    </FormRow>\r\n \r\n-                <FormRow label=\"Loan\">\r\n-                    <select\r\n-                        name=\"loan\"\r\n-                        value={repayment.loan}\r\n-                        onChange={handleChange}\r\n-                        className=\"w-full border p-2 rounded\"\r\n-                    >\r\n-                        <option value=\"\">Select Loan</option>\r\n-                        {loans.map((l) => (\r\n-                            <option key={l._id} value={l._id}>\r\n-                                {l.borrower?.fullName ? `${l.borrower.fullName}-${l.amount}` : `Unknown-${l.amount}`}\r\n-                            </option>\r\n-                        ))}\r\n-                    </select>\r\n-                </FormRow>\r\n+                    <FormRow label=\"Payment Date\">\r\n+                        <input\r\n+                            type=\"date\"\r\n+                            name=\"paymentDate\"\r\n+                            value={repayment.paymentDate}\r\n+                            onChange={handleChange}\r\n+                            className=\"w-full border p-2 rounded\"\r\n+                        />\r\n+                    </FormRow>\r\n \r\n-                <FormRow label=\"Payment Date\">\r\n-                    <input\r\n-                        type=\"date\"\r\n-                        name=\"paymentDate\"\r\n-                        value={repayment.paymentDate}\r\n-                        onChange={handleChange}\r\n-                        className=\"w-full border p-2 rounded\"\r\n-                    />\r\n-                </FormRow>\r\n+                    <FormRow label=\"Amount Paid\">\r\n+                        <input\r\n+                            type=\"number\"\r\n+                            name=\"amountPaid\"\r\n+                            value={repayment.amountPaid}\r\n+                            onChange={handleChange}\r\n+                            className=\"w-full border p-2 rounded\"\r\n+                        />\r\n+                    </FormRow>\r\n \r\n-                <FormRow label=\"Amount Paid\">\r\n-                    <input\r\n-                        type=\"number\"\r\n-                        name=\"amountPaid\"\r\n-                        value={repayment.amountPaid}\r\n-                        onChange={handleChange}\r\n-                        className=\"w-full border p-2 rounded\"\r\n-                    />\r\n-                </FormRow>\r\n+                    <FormRow label=\"Payment Term (months)\">\r\n+                        <select\r\n+                            name=\"paymentTerm\"\r\n+                            value={repayment.paymentTerm}\r\n+                            onChange={handleChange}\r\n+                            className=\"w-full border p-2 rounded\"\r\n+                        >\r\n+                            <option value=\"\">Select Term</option>\r\n+                            {termOptions.map((t) => (\r\n+                                <option key={t} value={t}>{t} months</option>\r\n+                            ))}\r\n+                        </select>\r\n+                    </FormRow>\r\n \r\n-                <FormRow label=\"Payment Term (months)\">\r\n-                    <select\r\n-                        name=\"paymentTerm\"\r\n-                        value={repayment.paymentTerm}\r\n-                        onChange={handleChange}\r\n-                        className=\"w-full border p-2 rounded\"\r\n-                    >\r\n-                        <option value=\"\">Select Term</option>\r\n-                        {termOptions.map((t) => (\r\n-                            <option key={t} value={t}>{t} months</option>\r\n-                        ))}\r\n-                    </select>\r\n-                </FormRow>\r\n+                    <FormRow label=\"Description\">\r\n+                        <input\r\n+                            type=\"text\"\r\n+                            name=\"description\"\r\n+                            value={repayment.description}\r\n+                            onChange={handleChange}\r\n+                            className=\"w-full border p-2 rounded\"\r\n+                        />\r\n+                    </FormRow>\r\n \r\n-                <FormRow label=\"Description\">\r\n-                    <input\r\n-                        type=\"text\"\r\n-                        name=\"description\"\r\n-                        value={repayment.description}\r\n-                        onChange={handleChange}\r\n-                        className=\"w-full border p-2 rounded\"\r\n-                    />\r\n-                </FormRow>\r\n-\r\n-                <div className=\"flex justify-end\">\r\n-                    <button\r\n-                        type=\"submit\"\r\n-                        className=\"bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600\"\r\n-                    >\r\n-                        {id ? \"Update\" : \"Create\"}\r\n-                    </button>\r\n-                </div>\r\n-            </form>\r\n-        </div>\r\n+                    <div className=\"flex justify-end\">\r\n+                        <button\r\n+                            type=\"submit\"\r\n+                            className=\"bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600\"\r\n+                        >\r\n+                            {id ? \"Update\" : \"Create\"}\r\n+                        </button>\r\n+                    </div>\r\n+                </form>\r\n+            </div>\r\n+        </>\r\n     );\r\n };\r\n \r\n export default RepaymentForm;\r\n"
                },
                {
                    "date": 1770582005563,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -26,9 +26,9 @@\n             getRepaymentById(id).then((data) => {\r\n                 setRepayment({\r\n                     loan: data.loan?._id || \"\",\r\n                     paymentDate: data.paymentDate ? data.paymentDate.slice(0, 10) : \"\",\r\n-                    amountPaid: data.amountPaid || \"\",\r\n+                    amountPaid: data.amountPaid || 0,\r\n                     paymentTerm: data.paymentTerm || \"\",\r\n                     description: data.description || \"\"\r\n                 });\r\n             });\r\n"
                },
                {
                    "date": 1770583877419,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,144 @@\n+import { useState, useEffect } from \"react\";\r\n+import { useNavigate, useParams } from \"react-router-dom\";\r\n+import { createRepayment, getRepaymentById, updateRepayment } from \"../../api/repaymentApi\";\r\n+import { getLoans } from \"../../api/loanApi\";\r\n+import PageToolbar from \"../../components/PageToolbar\";\r\n+import FormRow from \"../../components/FormRow\";\r\n+\r\n+const RepaymentForm = () => {\r\n+    const [repayment, setRepayment] = useState({\r\n+        loan: \"\",\r\n+        paymentDate: \"\",\r\n+        amountPaid: \"\",\r\n+        paymentTerm: \"\",\r\n+        description: \"\"\r\n+    });\r\n+    const [loans, setLoans] = useState([]);\r\n+    const navigate = useNavigate();\r\n+    const { id } = useParams();\r\n+\r\n+    const termOptions = [1, 3, 6, 12]; // months\r\n+\r\n+    useEffect(() => {\r\n+        getLoans().then(setLoans);\r\n+\r\n+        if (id) {\r\n+            getRepaymentById(id).then((data) => {\r\n+                setRepayment({\r\n+                    loan: data.loan?._id || \"\",\r\n+                    paymentDate: data.paymentDate ? data.paymentDate.slice(0, 10) : \"\",\r\n+                    amountPaid: data.amountPaid || 0,\r\n+                    paymentTerm: data.paymentTerm || \"\",\r\n+                    description: data.description || \"\"\r\n+                });\r\n+            });\r\n+        }\r\n+    }, [id]);\r\n+\r\n+    const handleChange = (e) => setRepayment({ ...repayment, [e.target.name]: e.target.value });\r\n+\r\n+    const handleSubmit = async (e) => {\r\n+        e.preventDefault();\r\n+\r\n+        const payload = {\r\n+            ...repayment,\r\n+            amountPaid: Number(repayment.amountPaid),\r\n+            paymentTerm: Number(repayment.paymentTerm),\r\n+            paymentDate: repayment.paymentDate ? new Date(repayment.paymentDate) : null\r\n+        };\r\n+\r\n+        try {\r\n+            if (id) await updateRepayment(id, payload);\r\n+            else await createRepayment(payload);\r\n+            navigate(\"/repayments\");\r\n+        } catch (err) {\r\n+            console.error(err);\r\n+            alert(\"Error saving repayment\");\r\n+        }\r\n+    };\r\n+\r\n+    return (\r\n+        <>\r\n+            <PageToolbar title={id ? \"Edit Repayment\" : \"Add Repayment\"} />\r\n+            <div className=\"max-w-md mx-auto\">\r\n+                <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n+\r\n+                    <FormRow label=\"Loan\">\r\n+                        <select\r\n+                            name=\"loan\"\r\n+                            value={repayment.loan}\r\n+                            onChange={handleChange}\r\n+                            className=\"w-full border p-2 rounded\"\r\n+                            required\r\n+                        >\r\n+                            <option value=\"\">Select Loan</option>\r\n+                            {loans.map((l) => (\r\n+                                <option key={l._id} value={l._id}>\r\n+                                    {l.borrower?.fullName ? `${l.borrower.fullName}-${l.amount}` : `Unknown-${l.amount}`}\r\n+                                </option>\r\n+                            ))}\r\n+                        </select>\r\n+                    </FormRow>\r\n+\r\n+                    <FormRow label=\"Payment Date\">\r\n+                        <input\r\n+                            type=\"date\"\r\n+                            name=\"paymentDate\"\r\n+                            value={repayment.paymentDate}\r\n+                            onChange={handleChange}\r\n+                            className=\"w-full border p-2 rounded\"\r\n+                            required\r\n+                        />\r\n+                    </FormRow>\r\n+\r\n+                    <FormRow label=\"Amount Paid\">\r\n+                        <input\r\n+                            type=\"number\"\r\n+                            name=\"amountPaid\"\r\n+                            value={repayment.amountPaid}\r\n+                            onChange={handleChange}\r\n+                            className=\"w-full border p-2 rounded\"\r\n+                            required\r\n+                        />\r\n+                    </FormRow>\r\n+\r\n+                    <FormRow label=\"Payment Term (months)\">\r\n+                        <select\r\n+                            name=\"paymentTerm\"\r\n+                            value={repayment.paymentTerm}\r\n+                            onChange={handleChange}\r\n+                            className=\"w-full border p-2 rounded\"\r\n+                            required\r\n+                        >\r\n+                            <option value=\"\">Select Term</option>\r\n+                            {termOptions.map((t) => (\r\n+                                <option key={t} value={t}>{t} months</option>\r\n+                            ))}\r\n+                        </select>\r\n+                    </FormRow>\r\n+\r\n+                    <FormRow label=\"Description\">\r\n+                        <input\r\n+                            type=\"text\"\r\n+                            name=\"description\"\r\n+                            value={repayment.description}\r\n+                            onChange={handleChange}\r\n+                            className=\"w-full border p-2 rounded\"\r\n+                        />\r\n+                    </FormRow>\r\n+\r\n+                    <div className=\"flex justify-end\">\r\n+                        <button\r\n+                            type=\"submit\"\r\n+                            className=\"bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600\"\r\n+                        >\r\n+                            {id ? \"Update\" : \"Create\"}\r\n+                        </button>\r\n+                    </div>\r\n+                </form>\r\n+            </div>\r\n+        </>\r\n+    );\r\n+};\r\n+\r\n+export default RepaymentForm;\r\n"
                },
                {
                    "date": 1770584582941,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,273 +1,172 @@\n import { useState, useEffect } from \"react\";\r\n import { useNavigate, useParams } from \"react-router-dom\";\r\n-import { createRepayment, getRepaymentById, updateRepayment } from \"../../api/repaymentApi\";\r\n+import { createTransaction, getTransactionById, updateTransaction } from \"../../api/transactionApi\";\r\n import { getLoans } from \"../../api/loanApi\";\r\n+import LoanHistory from \"./LoanHistory\";\r\n import PageToolbar from \"../../components/PageToolbar\";\r\n import FormRow from \"../../components/FormRow\";\r\n \r\n-const RepaymentForm = () => {\r\n-    const [repayment, setRepayment] = useState({\r\n+const TransactionForm = () => {\r\n+    const [transaction, setTransaction] = useState({\r\n         loan: \"\",\r\n-        paymentDate: \"\",\r\n-        amountPaid: \"\",\r\n-        paymentTerm: \"\",\r\n-        description: \"\"\r\n+        type: \"\",\r\n+        amount: 0,\r\n+        description: \"\",\r\n+        transactionDate: \"\"\r\n     });\r\n+\r\n     const [loans, setLoans] = useState([]);\r\n     const navigate = useNavigate();\r\n     const { id } = useParams();\r\n \r\n-    const termOptions = [1, 3, 6, 12]; // months\r\n+    const typeOptions = [\"Repayment\", \"Late Fee\", \"Penalty\"];\r\n \r\n+    // Fetch loans and transaction data if editing\r\n     useEffect(() => {\r\n-        getLoans().then(setLoans);\r\n+        const fetchData = async () => {\r\n+            const loanData = await getLoans();\r\n+            setLoans(loanData);\r\n \r\n-        if (id) {\r\n-            getRepaymentById(id).then((data) => {\r\n-                setRepayment({\r\n-                    loan: data.loan?._id || \"\",\r\n-                    paymentDate: data.paymentDate ? data.paymentDate.slice(0, 10) : \"\",\r\n-                    amountPaid: data.amountPaid || 0,\r\n-                    paymentTerm: data.paymentTerm || \"\",\r\n-                    description: data.description || \"\"\r\n+            if (id) {\r\n+                const txData = await getTransactionById(id);\r\n+                setTransaction({\r\n+                    loan: txData.loan?._id || \"\",\r\n+                    type: txData.type || \"\",\r\n+                    amount: txData.amount || 0,\r\n+                    description: txData.description || \"\",\r\n+                    transactionDate: txData.transactionDate ? txData.transactionDate.slice(0, 10) : \"\"\r\n                 });\r\n-            });\r\n-        }\r\n+            }\r\n+        };\r\n+\r\n+        fetchData();\r\n     }, [id]);\r\n \r\n-    const handleChange = (e) => setRepayment({ ...repayment, [e.target.name]: e.target.value });\r\n+    // Find selected loan object for balance display\r\n+    const selectedLoan = loans.find((l) => l._id === transaction.loan);\r\n+    const remainingBalance = selectedLoan?.balance || 0;\r\n \r\n+    // Handle input changes\r\n+    const handleChange = (e) => {\r\n+        const { name, value } = e.target;\r\n+        setTransaction({\r\n+            ...transaction,\r\n+            [name]: name === \"amount\" ? Number(value) : value\r\n+        });\r\n+    };\r\n+\r\n+    // Handle form submit\r\n     const handleSubmit = async (e) => {\r\n         e.preventDefault();\r\n \r\n+        const amount = Number(transaction.amount);\r\n+\r\n+        // Prevent repayment exceeding remaining balance\r\n+        if (transaction.type === \"Repayment\" && amount > remainingBalance) {\r\n+            alert(`Cannot pay more than remaining balance: ${remainingBalance}`);\r\n+            return;\r\n+        }\r\n+\r\n         const payload = {\r\n-            ...repayment,\r\n-            amountPaid: Number(repayment.amountPaid),\r\n-            paymentTerm: Number(repayment.paymentTerm),\r\n-            paymentDate: repayment.paymentDate ? new Date(repayment.paymentDate) : null\r\n+            ...transaction,\r\n+            amount,\r\n+            transactionDate: transaction.transactionDate ? new Date(transaction.transactionDate) : new Date()\r\n         };\r\n \r\n         try {\r\n-            if (id) await updateRepayment(id, payload);\r\n-            else await createRepayment(payload);\r\n-            navigate(\"/repayments\");\r\n+            if (id) await updateTransaction(id, payload);\r\n+            else await createTransaction(payload);\r\n+            navigate(\"/transactions\");\r\n         } catch (err) {\r\n             console.error(err);\r\n-            alert(\"Error saving repayment\");\r\n+            alert(\"Error saving transaction\");\r\n         }\r\n     };\r\n \r\n     return (\r\n         <>\r\n-            <PageToolbar title={id ? \"Edit Repayment\" : \"Add Repayment\"} />\r\n+            <PageToolbar title={id ? \"Edit Transaction\" : \"Add Transaction\"} />\r\n+\r\n             <div className=\"max-w-md mx-auto\">\r\n                 <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n \r\n+                    {/* Loan selection */}\r\n                     <FormRow label=\"Loan\">\r\n                         <select\r\n                             name=\"loan\"\r\n-                            value={repayment.loan}\r\n+                            value={transaction.loan}\r\n                             onChange={handleChange}\r\n                             className=\"w-full border p-2 rounded\"\r\n                             required\r\n                         >\r\n                             <option value=\"\">Select Loan</option>\r\n                             {loans.map((l) => (\r\n                                 <option key={l._id} value={l._id}>\r\n-                                    {l.borrower?.fullName ? `${l.borrower.fullName}-${l.amount}` : `Unknown-${l.amount}`}\r\n+                                    {l.borrower?.fullName ? `${l.borrower.fullName} - ${l.amount}` : `Unknown - ${l.amount}`}\r\n                                 </option>\r\n                             ))}\r\n                         </select>\r\n+                        {selectedLoan && (\r\n+                            <p className=\"text-sm text-gray-600 mt-1\">\r\n+                                Remaining Balance: {remainingBalance}\r\n+                            </p>\r\n+                        )}\r\n                     </FormRow>\r\n \r\n-                    <FormRow label=\"Payment Date\">\r\n-                        <input\r\n-                            type=\"date\"\r\n-                            name=\"paymentDate\"\r\n-                            value={repayment.paymentDate}\r\n+                    {/* Transaction Type */}\r\n+                    <FormRow label=\"Type\">\r\n+                        <select\r\n+                            name=\"type\"\r\n+                            value={transaction.type}\r\n                             onChange={handleChange}\r\n                             className=\"w-full border p-2 rounded\"\r\n                             required\r\n-                        />\r\n+                        >\r\n+                            <option value=\"\">Select Type</option>\r\n+                            {typeOptions.map((t) => (\r\n+                                <option key={t} value={t}>{t}</option>\r\n+                            ))}\r\n+                        </select>\r\n                     </FormRow>\r\n \r\n-                    <FormRow label=\"Amount Paid\">\r\n+                    {/* Amount */}\r\n+                    <FormRow label=\"Amount\">\r\n                         <input\r\n                             type=\"number\"\r\n-                            name=\"amountPaid\"\r\n-                            value={repayment.amountPaid}\r\n+                            name=\"amount\"\r\n+                            value={transaction.amount}\r\n                             onChange={handleChange}\r\n                             className=\"w-full border p-2 rounded\"\r\n                             required\r\n+                            min=\"0\"\r\n                         />\r\n                     </FormRow>\r\n \r\n-                    <FormRow label=\"Payment Term (months)\">\r\n-                        <select\r\n-                            name=\"paymentTerm\"\r\n-                            value={repayment.paymentTerm}\r\n-                            onChange={handleChange}\r\n-                            className=\"w-full border p-2 rounded\"\r\n-                            required\r\n-                        >\r\n-                            <option value=\"\">Select Term</option>\r\n-                            {termOptions.map((t) => (\r\n-                                <option key={t} value={t}>{t} months</option>\r\n-                            ))}\r\n-                        </select>\r\n-                    </FormRow>\r\n-\r\n+                    {/* Description */}\r\n                     <FormRow label=\"Description\">\r\n                         <input\r\n                             type=\"text\"\r\n                             name=\"description\"\r\n-                            value={repayment.description}\r\n+                            value={transaction.description}\r\n                             onChange={handleChange}\r\n                             className=\"w-full border p-2 rounded\"\r\n                         />\r\n                     </FormRow>\r\n \r\n-                    <div className=\"flex justify-end\">\r\n-                        <button\r\n-                            type=\"submit\"\r\n-                            className=\"bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600\"\r\n-                        >\r\n-                            {id ? \"Update\" : \"Create\"}\r\n-                        </button>\r\n-                    </div>\r\n-                </form>\r\n-            </div>\r\n-        </>\r\n-    );\r\n-};\r\n-\r\n-export default RepaymentForm;\r\n-import { useState, useEffect } from \"react\";\r\n-import { useNavigate, useParams } from \"react-router-dom\";\r\n-import { createRepayment, getRepaymentById, updateRepayment } from \"../../api/repaymentApi\";\r\n-import { getLoans } from \"../../api/loanApi\";\r\n-import PageToolbar from \"../../components/PageToolbar\";\r\n-import FormRow from \"../../components/FormRow\";\r\n-\r\n-const RepaymentForm = () => {\r\n-    const [repayment, setRepayment] = useState({\r\n-        loan: \"\",\r\n-        paymentDate: \"\",\r\n-        amountPaid: \"\",\r\n-        paymentTerm: \"\",\r\n-        description: \"\"\r\n-    });\r\n-    const [loans, setLoans] = useState([]);\r\n-    const navigate = useNavigate();\r\n-    const { id } = useParams();\r\n-\r\n-    const termOptions = [1, 3, 6, 12]; // months\r\n-\r\n-    useEffect(() => {\r\n-        getLoans().then(setLoans);\r\n-\r\n-        if (id) {\r\n-            getRepaymentById(id).then((data) => {\r\n-                setRepayment({\r\n-                    loan: data.loan?._id || \"\",\r\n-                    paymentDate: data.paymentDate ? data.paymentDate.slice(0, 10) : \"\",\r\n-                    amountPaid: data.amountPaid || 0,\r\n-                    paymentTerm: data.paymentTerm || \"\",\r\n-                    description: data.description || \"\"\r\n-                });\r\n-            });\r\n-        }\r\n-    }, [id]);\r\n-\r\n-    const handleChange = (e) => setRepayment({ ...repayment, [e.target.name]: e.target.value });\r\n-\r\n-    const handleSubmit = async (e) => {\r\n-        e.preventDefault();\r\n-\r\n-        const payload = {\r\n-            ...repayment,\r\n-            amountPaid: Number(repayment.amountPaid),\r\n-            paymentTerm: Number(repayment.paymentTerm),\r\n-            paymentDate: repayment.paymentDate ? new Date(repayment.paymentDate) : null\r\n-        };\r\n-\r\n-        try {\r\n-            if (id) await updateRepayment(id, payload);\r\n-            else await createRepayment(payload);\r\n-            navigate(\"/repayments\");\r\n-        } catch (err) {\r\n-            console.error(err);\r\n-            alert(\"Error saving repayment\");\r\n-        }\r\n-    };\r\n-\r\n-    return (\r\n-        <>\r\n-            <PageToolbar title={id ? \"Edit Repayment\" : \"Add Repayment\"} />\r\n-            <div className=\"max-w-md mx-auto\">\r\n-                <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n-\r\n-                    <FormRow label=\"Loan\">\r\n-                        <select\r\n-                            name=\"loan\"\r\n-                            value={repayment.loan}\r\n-                            onChange={handleChange}\r\n-                            className=\"w-full border p-2 rounded\"\r\n-                        >\r\n-                            <option value=\"\">Select Loan</option>\r\n-                            {loans.map((l) => (\r\n-                                <option key={l._id} value={l._id}>\r\n-                                    {l.borrower?.fullName ? `${l.borrower.fullName}-${l.amount}` : `Unknown-${l.amount}`}\r\n-                                </option>\r\n-                            ))}\r\n-                        </select>\r\n-                    </FormRow>\r\n-\r\n-                    <FormRow label=\"Payment Date\">\r\n+                    {/* Transaction Date */}\r\n+                    <FormRow label=\"Transaction Date\">\r\n                         <input\r\n                             type=\"date\"\r\n-                            name=\"paymentDate\"\r\n-                            value={repayment.paymentDate}\r\n+                            name=\"transactionDate\"\r\n+                            value={transaction.transactionDate}\r\n                             onChange={handleChange}\r\n                             className=\"w-full border p-2 rounded\"\r\n+                            required\r\n                         />\r\n                     </FormRow>\r\n \r\n-                    <FormRow label=\"Amount Paid\">\r\n-                        <input\r\n-                            type=\"number\"\r\n-                            name=\"amountPaid\"\r\n-                            value={repayment.amountPaid}\r\n-                            onChange={handleChange}\r\n-                            className=\"w-full border p-2 rounded\"\r\n-                        />\r\n-                    </FormRow>\r\n-\r\n-                    <FormRow label=\"Payment Term (months)\">\r\n-                        <select\r\n-                            name=\"paymentTerm\"\r\n-                            value={repayment.paymentTerm}\r\n-                            onChange={handleChange}\r\n-                            className=\"w-full border p-2 rounded\"\r\n-                        >\r\n-                            <option value=\"\">Select Term</option>\r\n-                            {termOptions.map((t) => (\r\n-                                <option key={t} value={t}>{t} months</option>\r\n-                            ))}\r\n-                        </select>\r\n-                    </FormRow>\r\n-\r\n-                    <FormRow label=\"Description\">\r\n-                        <input\r\n-                            type=\"text\"\r\n-                            name=\"description\"\r\n-                            value={repayment.description}\r\n-                            onChange={handleChange}\r\n-                            className=\"w-full border p-2 rounded\"\r\n-                        />\r\n-                    </FormRow>\r\n-\r\n+                    {/* Submit button */}\r\n                     <div className=\"flex justify-end\">\r\n                         <button\r\n                             type=\"submit\"\r\n                             className=\"bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600\"\r\n@@ -276,9 +175,14 @@\n                         </button>\r\n                     </div>\r\n                 </form>\r\n             </div>\r\n+\r\n+            {/* Loan history */}\r\n+            <div className=\"p-4\">\r\n+                <LoanHistory loanId={transaction.loan} />\r\n+            </div>\r\n         </>\r\n     );\r\n };\r\n \r\n-export default RepaymentForm;\r\n+export default TransactionForm;\r\n"
                },
                {
                    "date": 1770584596459,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,172 +1,133 @@\n import { useState, useEffect } from \"react\";\r\n import { useNavigate, useParams } from \"react-router-dom\";\r\n-import { createTransaction, getTransactionById, updateTransaction } from \"../../api/transactionApi\";\r\n+import { createRepayment, getRepaymentById, updateRepayment } from \"../../api/repaymentApi\";\r\n import { getLoans } from \"../../api/loanApi\";\r\n-import LoanHistory from \"./LoanHistory\";\r\n import PageToolbar from \"../../components/PageToolbar\";\r\n import FormRow from \"../../components/FormRow\";\r\n \r\n-const TransactionForm = () => {\r\n-    const [transaction, setTransaction] = useState({\r\n+const RepaymentForm = () => {\r\n+    const [repayment, setRepayment] = useState({\r\n         loan: \"\",\r\n-        type: \"\",\r\n-        amount: 0,\r\n-        description: \"\",\r\n-        transactionDate: \"\"\r\n+        paymentDate: \"\",\r\n+        amountPaid: \"\",\r\n+        paymentTerm: \"\",\r\n+        description: \"\"\r\n     });\r\n-\r\n     const [loans, setLoans] = useState([]);\r\n     const navigate = useNavigate();\r\n     const { id } = useParams();\r\n \r\n-    const typeOptions = [\"Repayment\", \"Late Fee\", \"Penalty\"];\r\n+    const termOptions = [1, 3, 6, 12]; // months\r\n \r\n-    // Fetch loans and transaction data if editing\r\n     useEffect(() => {\r\n-        const fetchData = async () => {\r\n-            const loanData = await getLoans();\r\n-            setLoans(loanData);\r\n+        getLoans().then(setLoans);\r\n \r\n-            if (id) {\r\n-                const txData = await getTransactionById(id);\r\n-                setTransaction({\r\n-                    loan: txData.loan?._id || \"\",\r\n-                    type: txData.type || \"\",\r\n-                    amount: txData.amount || 0,\r\n-                    description: txData.description || \"\",\r\n-                    transactionDate: txData.transactionDate ? txData.transactionDate.slice(0, 10) : \"\"\r\n+        if (id) {\r\n+            getRepaymentById(id).then((data) => {\r\n+                setRepayment({\r\n+                    loan: data.loan?._id || \"\",\r\n+                    paymentDate: data.paymentDate ? data.paymentDate.slice(0, 10) : \"\",\r\n+                    amountPaid: data.amountPaid || 0,\r\n+                    paymentTerm: data.paymentTerm || \"\",\r\n+                    description: data.description || \"\"\r\n                 });\r\n-            }\r\n-        };\r\n-\r\n-        fetchData();\r\n+            });\r\n+        }\r\n     }, [id]);\r\n \r\n-    // Find selected loan object for balance display\r\n-    const selectedLoan = loans.find((l) => l._id === transaction.loan);\r\n-    const remainingBalance = selectedLoan?.balance || 0;\r\n+    const handleChange = (e) => setRepayment({ ...repayment, [e.target.name]: e.target.value });\r\n \r\n-    // Handle input changes\r\n-    const handleChange = (e) => {\r\n-        const { name, value } = e.target;\r\n-        setTransaction({\r\n-            ...transaction,\r\n-            [name]: name === \"amount\" ? Number(value) : value\r\n-        });\r\n-    };\r\n-\r\n-    // Handle form submit\r\n     const handleSubmit = async (e) => {\r\n         e.preventDefault();\r\n \r\n-        const amount = Number(transaction.amount);\r\n-\r\n-        // Prevent repayment exceeding remaining balance\r\n-        if (transaction.type === \"Repayment\" && amount > remainingBalance) {\r\n-            alert(`Cannot pay more than remaining balance: ${remainingBalance}`);\r\n-            return;\r\n-        }\r\n-\r\n         const payload = {\r\n-            ...transaction,\r\n-            amount,\r\n-            transactionDate: transaction.transactionDate ? new Date(transaction.transactionDate) : new Date()\r\n+            ...repayment,\r\n+            amountPaid: Number(repayment.amountPaid),\r\n+            paymentTerm: Number(repayment.paymentTerm),\r\n+            paymentDate: repayment.paymentDate ? new Date(repayment.paymentDate) : null\r\n         };\r\n \r\n         try {\r\n-            if (id) await updateTransaction(id, payload);\r\n-            else await createTransaction(payload);\r\n-            navigate(\"/transactions\");\r\n+            if (id) await updateRepayment(id, payload);\r\n+            else await createRepayment(payload);\r\n+            navigate(\"/repayments\");\r\n         } catch (err) {\r\n             console.error(err);\r\n-            alert(\"Error saving transaction\");\r\n+            alert(\"Error saving repayment\");\r\n         }\r\n     };\r\n \r\n     return (\r\n         <>\r\n-            <PageToolbar title={id ? \"Edit Transaction\" : \"Add Transaction\"} />\r\n-\r\n+            <PageToolbar title={id ? \"Edit Repayment\" : \"Add Repayment\"} />\r\n             <div className=\"max-w-md mx-auto\">\r\n                 <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n \r\n-                    {/* Loan selection */}\r\n                     <FormRow label=\"Loan\">\r\n                         <select\r\n                             name=\"loan\"\r\n-                            value={transaction.loan}\r\n+                            value={repayment.loan}\r\n                             onChange={handleChange}\r\n                             className=\"w-full border p-2 rounded\"\r\n                             required\r\n                         >\r\n                             <option value=\"\">Select Loan</option>\r\n                             {loans.map((l) => (\r\n                                 <option key={l._id} value={l._id}>\r\n-                                    {l.borrower?.fullName ? `${l.borrower.fullName} - ${l.amount}` : `Unknown - ${l.amount}`}\r\n+                                    {l.borrower?.fullName ? `${l.borrower.fullName}-${l.amount}` : `Unknown-${l.amount}`}\r\n                                 </option>\r\n                             ))}\r\n                         </select>\r\n-                        {selectedLoan && (\r\n-                            <p className=\"text-sm text-gray-600 mt-1\">\r\n-                                Remaining Balance: {remainingBalance}\r\n-                            </p>\r\n-                        )}\r\n                     </FormRow>\r\n \r\n-                    {/* Transaction Type */}\r\n-                    <FormRow label=\"Type\">\r\n-                        <select\r\n-                            name=\"type\"\r\n-                            value={transaction.type}\r\n+                    <FormRow label=\"Payment Date\">\r\n+                        <input\r\n+                            type=\"date\"\r\n+                            name=\"paymentDate\"\r\n+                            value={repayment.paymentDate}\r\n                             onChange={handleChange}\r\n                             className=\"w-full border p-2 rounded\"\r\n                             required\r\n-                        >\r\n-                            <option value=\"\">Select Type</option>\r\n-                            {typeOptions.map((t) => (\r\n-                                <option key={t} value={t}>{t}</option>\r\n-                            ))}\r\n-                        </select>\r\n+                        />\r\n                     </FormRow>\r\n \r\n-                    {/* Amount */}\r\n-                    <FormRow label=\"Amount\">\r\n+                    <FormRow label=\"Amount Paid\">\r\n                         <input\r\n                             type=\"number\"\r\n-                            name=\"amount\"\r\n-                            value={transaction.amount}\r\n+                            name=\"amountPaid\"\r\n+                            value={repayment.amountPaid}\r\n                             onChange={handleChange}\r\n                             className=\"w-full border p-2 rounded\"\r\n                             required\r\n-                            min=\"0\"\r\n                         />\r\n                     </FormRow>\r\n \r\n-                    {/* Description */}\r\n-                    <FormRow label=\"Description\">\r\n-                        <input\r\n-                            type=\"text\"\r\n-                            name=\"description\"\r\n-                            value={transaction.description}\r\n+                    <FormRow label=\"Payment Term (months)\">\r\n+                        <select\r\n+                            name=\"paymentTerm\"\r\n+                            value={repayment.paymentTerm}\r\n                             onChange={handleChange}\r\n                             className=\"w-full border p-2 rounded\"\r\n-                        />\r\n+                            \r\n+                        >\r\n+                            <option value=\"\">Select Term</option>\r\n+                            {termOptions.map((t) => (\r\n+                                <option key={t} value={t}>{t} months</option>\r\n+                            ))}\r\n+                        </select>\r\n                     </FormRow>\r\n \r\n-                    {/* Transaction Date */}\r\n-                    <FormRow label=\"Transaction Date\">\r\n+                    <FormRow label=\"Description\">\r\n                         <input\r\n-                            type=\"date\"\r\n-                            name=\"transactionDate\"\r\n-                            value={transaction.transactionDate}\r\n+                            type=\"text\"\r\n+                            name=\"description\"\r\n+                            value={repayment.description}\r\n                             onChange={handleChange}\r\n                             className=\"w-full border p-2 rounded\"\r\n-                            required\r\n                         />\r\n                     </FormRow>\r\n \r\n-                    {/* Submit button */}\r\n                     <div className=\"flex justify-end\">\r\n                         <button\r\n                             type=\"submit\"\r\n                             className=\"bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600\"\r\n@@ -175,14 +136,9 @@\n                         </button>\r\n                     </div>\r\n                 </form>\r\n             </div>\r\n-\r\n-            {/* Loan history */}\r\n-            <div className=\"p-4\">\r\n-                <LoanHistory loanId={transaction.loan} />\r\n-            </div>\r\n         </>\r\n     );\r\n };\r\n \r\n-export default TransactionForm;\r\n+export default RepaymentForm;\r\n"
                },
                {
                    "date": 1770584704205,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -19,33 +19,57 @@\n \r\n     const termOptions = [1, 3, 6, 12]; // months\r\n \r\n     useEffect(() => {\r\n-        getLoans().then(setLoans);\r\n+        const fetchData = async () => {\r\n+            const loanData = await getLoans();\r\n+            setLoans(loanData);\r\n \r\n-        if (id) {\r\n-            getRepaymentById(id).then((data) => {\r\n+            if (id) {\r\n+                const repaymentData = await getRepaymentById(id);\r\n                 setRepayment({\r\n-                    loan: data.loan?._id || \"\",\r\n-                    paymentDate: data.paymentDate ? data.paymentDate.slice(0, 10) : \"\",\r\n-                    amountPaid: data.amountPaid || 0,\r\n-                    paymentTerm: data.paymentTerm || \"\",\r\n-                    description: data.description || \"\"\r\n+                    loan: repaymentData.loan?._id || \"\",\r\n+                    paymentDate: repaymentData.paymentDate ? repaymentData.paymentDate.slice(0, 10) : \"\",\r\n+                    amountPaid: repaymentData.amountPaid || 0,\r\n+                    paymentTerm: repaymentData.paymentTerm || \"\",\r\n+                    description: repaymentData.description || \"\"\r\n                 });\r\n-            });\r\n-        }\r\n+            }\r\n+        };\r\n+\r\n+        fetchData();\r\n     }, [id]);\r\n \r\n-    const handleChange = (e) => setRepayment({ ...repayment, [e.target.name]: e.target.value });\r\n+    // Find selected loan and its remaining balance\r\n+    const selectedLoan = loans.find((l) => l._id === repayment.loan);\r\n+    const remainingBalance = selectedLoan?.balance || 0;\r\n \r\n+    // Handle input changes\r\n+    const handleChange = (e) => {\r\n+        const { name, value } = e.target;\r\n+        setRepayment({\r\n+            ...repayment,\r\n+            [name]: name === \"amountPaid\" || name === \"paymentTerm\" ? Number(value) : value\r\n+        });\r\n+    };\r\n+\r\n+    // Handle form submission\r\n     const handleSubmit = async (e) => {\r\n         e.preventDefault();\r\n \r\n+        const amountPaid = Number(repayment.amountPaid);\r\n+\r\n+        // Validate amountPaid does not exceed remaining balance\r\n+        if (amountPaid > remainingBalance) {\r\n+            alert(`Amount paid cannot exceed remaining balance: ${remainingBalance}`);\r\n+            return;\r\n+        }\r\n+\r\n         const payload = {\r\n             ...repayment,\r\n-            amountPaid: Number(repayment.amountPaid),\r\n+            amountPaid,\r\n             paymentTerm: Number(repayment.paymentTerm),\r\n-            paymentDate: repayment.paymentDate ? new Date(repayment.paymentDate) : null\r\n+            paymentDate: repayment.paymentDate ? new Date(repayment.paymentDate) : new Date()\r\n         };\r\n \r\n         try {\r\n             if (id) await updateRepayment(id, payload);\r\n@@ -62,8 +86,9 @@\n             <PageToolbar title={id ? \"Edit Repayment\" : \"Add Repayment\"} />\r\n             <div className=\"max-w-md mx-auto\">\r\n                 <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n \r\n+                    {/* Loan Selection */}\r\n                     <FormRow label=\"Loan\">\r\n                         <select\r\n                             name=\"loan\"\r\n                             value={repayment.loan}\r\n@@ -77,10 +102,16 @@\n                                     {l.borrower?.fullName ? `${l.borrower.fullName}-${l.amount}` : `Unknown-${l.amount}`}\r\n                                 </option>\r\n                             ))}\r\n                         </select>\r\n+                        {selectedLoan && (\r\n+                            <p className=\"text-sm text-gray-600 mt-1\">\r\n+                                Remaining Balance: {remainingBalance}\r\n+                            </p>\r\n+                        )}\r\n                     </FormRow>\r\n \r\n+                    {/* Payment Date */}\r\n                     <FormRow label=\"Payment Date\">\r\n                         <input\r\n                             type=\"date\"\r\n                             name=\"paymentDate\"\r\n@@ -90,34 +121,38 @@\n                             required\r\n                         />\r\n                     </FormRow>\r\n \r\n+                    {/* Amount Paid */}\r\n                     <FormRow label=\"Amount Paid\">\r\n                         <input\r\n                             type=\"number\"\r\n                             name=\"amountPaid\"\r\n                             value={repayment.amountPaid}\r\n                             onChange={handleChange}\r\n                             className=\"w-full border p-2 rounded\"\r\n                             required\r\n+                            min=\"0\"\r\n+                            max={remainingBalance} // optional HTML max\r\n                         />\r\n                     </FormRow>\r\n \r\n+                    {/* Payment Term */}\r\n                     <FormRow label=\"Payment Term (months)\">\r\n                         <select\r\n                             name=\"paymentTerm\"\r\n                             value={repayment.paymentTerm}\r\n                             onChange={handleChange}\r\n                             className=\"w-full border p-2 rounded\"\r\n-                            \r\n                         >\r\n                             <option value=\"\">Select Term</option>\r\n                             {termOptions.map((t) => (\r\n                                 <option key={t} value={t}>{t} months</option>\r\n                             ))}\r\n                         </select>\r\n                     </FormRow>\r\n \r\n+                    {/* Description */}\r\n                     <FormRow label=\"Description\">\r\n                         <input\r\n                             type=\"text\"\r\n                             name=\"description\"\r\n@@ -126,16 +161,18 @@\n                             className=\"w-full border p-2 rounded\"\r\n                         />\r\n                     </FormRow>\r\n \r\n+                    {/* Submit Button */}\r\n                     <div className=\"flex justify-end\">\r\n                         <button\r\n                             type=\"submit\"\r\n                             className=\"bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600\"\r\n                         >\r\n                             {id ? \"Update\" : \"Create\"}\r\n                         </button>\r\n                     </div>\r\n+\r\n                 </form>\r\n             </div>\r\n         </>\r\n     );\r\n"
                },
                {
                    "date": 1770585302227,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -38,22 +38,20 @@\n \r\n         fetchData();\r\n     }, [id]);\r\n \r\n-    // Find selected loan and its remaining balance\r\n+    // Selected loan object\r\n     const selectedLoan = loans.find((l) => l._id === repayment.loan);\r\n     const remainingBalance = selectedLoan?.balance || 0;\r\n \r\n-    // Handle input changes\r\n     const handleChange = (e) => {\r\n         const { name, value } = e.target;\r\n         setRepayment({\r\n             ...repayment,\r\n             [name]: name === \"amountPaid\" || name === \"paymentTerm\" ? Number(value) : value\r\n         });\r\n     };\r\n \r\n-    // Handle form submission\r\n     const handleSubmit = async (e) => {\r\n         e.preventDefault();\r\n \r\n         const amountPaid = Number(repayment.amountPaid);\r\n@@ -102,8 +100,9 @@\n                                     {l.borrower?.fullName ? `${l.borrower.fullName}-${l.amount}` : `Unknown-${l.amount}`}\r\n                                 </option>\r\n                             ))}\r\n                         </select>\r\n+                        {/* Display remaining balance like TransactionForm */}\r\n                         {selectedLoan && (\r\n                             <p className=\"text-sm text-gray-600 mt-1\">\r\n                                 Remaining Balance: {remainingBalance}\r\n                             </p>\r\n"
                },
                {
                    "date": 1770589330127,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,10 +8,10 @@\n const RepaymentForm = () => {\r\n     const [repayment, setRepayment] = useState({\r\n         loan: \"\",\r\n         paymentDate: \"\",\r\n-        amountPaid: \"\",\r\n-        paymentTerm: \"\",\r\n+        amountPaid: 0,\r\n+        paymentTerm: 0,\r\n         description: \"\"\r\n     });\r\n     const [loans, setLoans] = useState([]);\r\n     const navigate = useNavigate();\r\n"
                },
                {
                    "date": 1770589612086,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -63,9 +63,9 @@\n         }\r\n \r\n         const payload = {\r\n             ...repayment,\r\n-            amountPaid,\r\n+            amountPaid: amountPaid || 0,\r\n             paymentTerm: Number(repayment.paymentTerm),\r\n             paymentDate: repayment.paymentDate ? new Date(repayment.paymentDate) : new Date()\r\n         };\r\n \r\n"
                }
            ],
            "date": 1770563271667,
            "name": "Commit-0",
            "content": "import { useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { createRepayment } from \"../../api/repaymentApi\";\r\nimport { getLoans } from \"../../api/loanApi\";\r\n\r\nconst RepaymentForm = () => {\r\n    const [repayment, setRepayment] = useState({ loan: \"\", paymentDate: \"\", amountPaid: \"\" });\r\n    const [loans, setLoans] = useState([]);\r\n    const navigate = useNavigate();\r\n\r\n    useEffect(() => { getLoans().then(setLoans); }, []);\r\n\r\n    const handleChange = e => setRepayment({ ...repayment, [e.target.name]: e.target.value });\r\n    const handleSubmit = async e => { e.preventDefault(); await createRepayment(repayment); navigate(\"/repayments\"); };\r\n\r\n    return (\r\n        <div className=\"max-w-md mx-auto\">\r\n            <h1 className=\"text-2xl font-bold mb-4\">Add Repayment</h1>\r\n            <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded shadow space-y-4\">\r\n                <label>Loan</label>\r\n                <select name=\"loan\" value={repayment.loan} onChange={handleChange} className=\"w-full border p-2\">\r\n                    <option value=\"\">Select Loan</option>\r\n                    {loans.map(l => <option key={l._id} value={l._id}>{l.borrower?.fullName} - {l.amount}</option>)}\r\n                </select>\r\n                <label>Payment Date</label>\r\n                <input type=\"date\" name=\"paymentDate\" value={repayment.paymentDate} onChange={handleChange} className=\"w-full border p-2\" />\r\n                <label>Amount Paid</label>\r\n                <input type=\"number\" name=\"amountPaid\" value={repayment.amountPaid} onChange={handleChange} className=\"w-full border p-2\" />\r\n                <button type=\"submit\" className=\"bg-gray-500 text-white px-4 py-2 rounded\">Create</button>\r\n            </form>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default RepaymentForm;\r\n"
        }
    ]
}